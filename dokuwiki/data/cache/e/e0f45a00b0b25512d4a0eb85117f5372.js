var DOKU_BASE='/dokuwiki/';var DOKU_TPL='/dokuwiki/lib/tpl/bootstrap3/';var DOKU_COOKIE_PARAM={"path":"\/dokuwiki\/","secure":false};Object.defineProperty(window,'DOKU_UHN',{get:function(){console.warn('Using DOKU_UHN is deprecated. Please use JSINFO.useHeadingNavigation instead');return JSINFO.useHeadingNavigation;}});Object.defineProperty(window,'DOKU_UHC',{get:function(){console.warn('Using DOKU_UHC is deprecated. Please use JSINFO.useHeadingContent instead');return JSINFO.useHeadingContent;}});LANG={"search_toggle_tools":"Toggle Search Tools","willexpire":"O seu bloqueio de edi\u00e7\u00e3o deste p\u00e1gina ir\u00e1 expirar em um minuto.\\nPara evitar conflitos de edi\u00e7\u00e3o, clique no bot\u00e3o de visualiza\u00e7\u00e3o para reiniciar o temporizador de bloqueio.","notsavedyet":"As altera\u00e7\u00f5es n\u00e3o salvas ser\u00e3o perdidas.\nDeseja realmente continuar?","searchmedia":"Buscar por arquivos","keepopen":"Manter a janela aberta na sele\u00e7\u00e3o","hidedetails":"Esconder detalhes","mediatitle":"Configura\u00e7\u00f5es do Link","mediadisplay":"Tipo de Link","mediaalign":"Alinhamento","mediasize":"Tamanho da Imagem","mediatarget":"Alvo do Link","mediaclose":"Fechar","mediainsert":"Inserir","mediadisplayimg":"Mostrar Imagem.","mediadisplaylnk":"Mostrar apenas Link.","mediasmall":"Vers\u00e3o Pequena","mediamedium":"Vers\u00e3o M\u00e9dia","medialarge":"Vers\u00e3o Grande","mediaoriginal":"Vers\u00e3o Original","medialnk":"Link para p\u00e1gina de detalhes","mediadirect":"Link direto para original","medianolnk":"Sem Link","medianolink":"Sem link na imagem","medialeft":"Alinhamento de imagem a esquerda","mediaright":"Alinhamento de imagem a direita","mediacenter":"Alinhamento de imagem ao centro","medianoalign":"Sem alinhamento","nosmblinks":"Atalhos para pastas compartilhadas do Windows funcionam apenas no Microsoft Internet Explorer.\nEntretanto, voc\u00ea ainda pode copiar e colar o atalho.","linkwiz":"Link Wizard","linkto":"Link para:","del_confirm":"Deseja realmente excluir o(s) item(ns) selecionado(s)?","restore_confirm":"Deseja realmente restaurar essa vers\u00e3o?","media_diff":"Ver as diferen\u00e7as:","media_diff_both":"Lado a lado","media_diff_opacity":"Sobreposi\u00e7\u00e3o","media_diff_portions":"Deslizamento","media_select":"Selecione os arquivos...","media_upload_btn":"Enviar","media_done_btn":"Conclu\u00eddo","media_drop":"Arraste os arquivos at\u00e9 aqui para enviar","media_cancel":"remover","media_overwrt":"Sobrescrever arquivos existentes","plugins":{"extension":{"reallydel":"Quer mesmo desinstalar esta extens\u00e3o?","display_viewoptions":"Op\u00e7\u00f5es de visualiza\u00e7\u00e3o:","display_enabled":"habilitado","display_disabled":"desabilitado","display_updatable":"atualiz\u00e1vel"},"indexmenu":{"indexmenuwizard":"Assistente do Indexmenu","index":"\u00cdndice","options":"Op\u00e7\u00f5es","navigation":"Navega\u00e7\u00e3o","sort":"Ordenar","filter":"Filtro","performance":"Performance","namespace":"Namespace","nsdepth":"Profundidade","js":"\u00c1rvore renderizada por Javascript, voc\u00ea pode definir seu pr\u00f3prio tema","theme":"Tema","navbar":"A \u00e1rvore \u00e9 aberta no namespace atual","context":"Exibe a \u00e1rvore do contexto de namespace do wiki atual","nocookie":"N\u00e3o se lembre de n\u00f3s abertos \/ fechados durante a navega\u00e7\u00e3o do usu\u00e1rio","noscroll":"Evitar a rolagem da \u00e1rvore quando ela n\u00e3o se encaixa na largura do cont\u00eainer","notoc":"Desativar o recurso de visualiza\u00e7\u00e3o do toc","tsort":"Por t\u00edtulo","dsort":"Por data","msort":"Por meta tag","nsort":"Ordenar tamb\u00e9m namespaces","hsort":"Ordenar headpage up","rsort":"Inverta a classifica\u00e7\u00e3o de p\u00e1ginas","nons":"Mostrar apenas p\u00e1ginas","nopg":"Mostrar apenas namespaces","max":"Quantos n\u00edveis renderizar com ajax quando um n\u00f3 \u00e9 aberto. Al\u00e9m disso, quantos subn\u00edveis abaixo desse n\u00edvel s\u00e3o recuperados com AJAX, e n\u00e3o de uma s\u00f3 vez.","maxjs":"Quantos n\u00edveis para renderizar no navegador do cliente quando um n\u00f3 \u00e9 aberto","id":"ID de cookie definido automaticamente para este indexmenu","insert":"Inserir indexmenu","metanum":"N\u00famero Meta para classifica\u00e7\u00e3o","insertmetanum":"Inserir metanumber","page":"P\u00e1gina","revs":"Revis\u00f5es","tocpreview":"Pr\u00e9-visualiza\u00e7\u00e3o Toc","editmode":"Modo de edi\u00e7\u00e3o","insertdwlink":"Inserir como DWlink","insertdwlinktooltip":"Insira o link desta p\u00e1gina na caixa de edi\u00e7\u00e3o na posi\u00e7\u00e3o do cursor","ns":"Namespace","search":"Procurar...","searchtooltip":"Procurar por p\u00e1ginas dentro deste namespace","create":"Criar","more":"Mais","headpage":"Cabe\u00e7alho","headpagetooltip":"Crie um novo cabe\u00e7alho nesta p\u00e1gina","startpage":"P\u00e1gina de in\u00edcio","startpagetooltip":"Crie uma nova p\u00e1gina inicial nesta p\u00e1gina","custompage":"P\u00e1gina personalizada ...","custompagetooltip":"Crie uma nova p\u00e1gina (insira o nome via popup) nesta p\u00e1gina","acls":"Acls","purgecache":"Limpar cache","exporthtml":"Exportar como HTML","exporttext":"Exportar como texto","headpagehere":"Cabe\u00e7alho aqui","headpageheretooltip":"Crie um novo cabe\u00e7alho dentro deste namespace","newpage":"Nova p\u00e1gina...","newpagetooltip":"Crie uma nova p\u00e1gina (insira o nome via popup) dentro deste namespace","newpagehere":"Nova p\u00e1gina aqui","insertkeywords":"Inserir palavras-chave para procurar dentro deste namespace","insertpagename":"Insira o nome da p\u00e1gina para criar","edit":"Editar","loading":"Carregando..."},"styling":{"loader":"A visualiza\u00e7\u00e3o est\u00e1 carregando...<br \/>Caso essa mensagem n\u00e3o desapare\u00e7a, pode ter algum problema com os seus valores.","popup":"Abrir como um popup"},"tagging":{"notags":"No tags, yet","nopages":"No pages with this tag, yet","admin_change_tag":"Change the tag"},"vshare":{"button":"Insira o v\u00eddeo um um site de compartilhamento de v\u00eddeos","prompt":"Por favor, cole aqui a URL completa da p\u00e1gina do v\u00eddeo:","notfound":"Desculpe, a URL n\u00e3o foi reconhecida.\nVisite a documenta\u00e7\u00e3o para saber com adicionar o v\u00eddeo com a sintaxe correta."}}};var toolbar=[{"type":"format","title":"Texto em negrito","icon":"bold.png","key":"b","open":"**","close":"**","block":false},{"type":"format","title":"Texto em it\u00e1lico","icon":"italic.png","key":"i","open":"\/\/","close":"\/\/","block":false},{"type":"format","title":"Texto sublinhado","icon":"underline.png","key":"u","open":"__","close":"__","block":false},{"type":"format","title":"Texto de c\u00f3digo","icon":"mono.png","key":"m","open":"''","close":"''","block":false},{"type":"format","title":"Texto tachado","icon":"strike.png","key":"d","open":"<del>","close":"<\/del>","block":false},{"type":"autohead","title":"Cabe\u00e7alho de mesmo n\u00edvel","icon":"hequal.png","key":"8","text":"Cabe\u00e7alho","mod":0,"block":true},{"type":"autohead","title":"Cabe\u00e7alho de n\u00edvel mais baixo","icon":"hminus.png","key":"9","text":"Cabe\u00e7alho","mod":1,"block":true},{"type":"autohead","title":"Cabe\u00e7alho de n\u00edvel mais alto","icon":"hplus.png","key":"0","text":"Cabe\u00e7alho","mod":-1,"block":true},{"type":"picker","title":"Escolha o cabe\u00e7alho","icon":"h.png","class":"pk_hl","list":[{"type":"format","title":"Cabe\u00e7alho de n\u00edvel 1","icon":"h1.png","key":"1","open":"====== ","close":" ======\\n"},{"type":"format","title":"Cabe\u00e7alho de n\u00edvel 2","icon":"h2.png","key":"2","open":"===== ","close":" =====\\n"},{"type":"format","title":"Cabe\u00e7alho de n\u00edvel 3","icon":"h3.png","key":"3","open":"==== ","close":" ====\\n"},{"type":"format","title":"Cabe\u00e7alho de n\u00edvel 4","icon":"h4.png","key":"4","open":"=== ","close":" ===\\n"},{"type":"format","title":"Cabe\u00e7alho de n\u00edvel 5","icon":"h5.png","key":"5","open":"== ","close":" ==\\n"}],"block":true},{"type":"linkwiz","title":"Link interno","icon":"link.png","key":"l","open":"[[","close":"]]","block":false},{"type":"format","title":"Link externo","icon":"linkextern.png","open":"[[","close":"]]","sample":"http:\/\/example.com|Link externo","block":false},{"type":"formatln","title":"Item de lista ordenada","icon":"ol.png","open":"  - ","close":"","key":"-","block":true},{"type":"formatln","title":"Item de lista n\u00e3o ordenada","icon":"ul.png","open":"  * ","close":"","key":".","block":true},{"type":"insert","title":"Linha horizontal","icon":"hr.png","insert":"\\n----\\n","block":true},{"type":"mediapopup","title":"Adicionar imagens e\/ou outros arquivos","icon":"image.png","url":"lib\/exe\/mediamanager.php?ns=","name":"mediaselect","options":"width=750,height=500,left=20,top=20,scrollbars=yes,resizable=yes","block":false},{"type":"picker","title":"Carinhas","icon":"smiley.png","list":{"8-)":"icon_cool.gif","8-O":"icon_eek.gif","8-o":"icon_eek.gif",":-(":"icon_sad.gif",":-)":"icon_smile.gif","=)":"icon_smile2.gif",":-\/":"icon_doubt.gif",":-\\":"icon_doubt2.gif",":-?":"icon_confused.gif",":-D":"icon_biggrin.gif",":-P":"icon_razz.gif",":-o":"icon_surprised.gif",":-O":"icon_surprised.gif",":-x":"icon_silenced.gif",":-X":"icon_silenced.gif",":-|":"icon_neutral.gif",";-)":"icon_wink.gif","m(":"facepalm.gif","^_^":"icon_fun.gif",":?:":"icon_question.gif",":!:":"icon_exclaim.gif","LOL":"icon_lol.gif","FIXME":"fixme.gif","DELETEME":"delete.gif"},"icobase":"smileys","block":false},{"type":"picker","title":"Caracteres especiais","icon":"chars.png","list":["\u00c0","\u00e0","\u00c1","\u00e1","\u00c2","\u00e2","\u00c3","\u00e3","\u00c4","\u00e4","\u01cd","\u01ce","\u0102","\u0103","\u00c5","\u00e5","\u0100","\u0101","\u0104","\u0105","\u00c6","\u00e6","\u0106","\u0107","\u00c7","\u00e7","\u010c","\u010d","\u0108","\u0109","\u010a","\u010b","\u00d0","\u0111","\u00f0","\u010e","\u010f","\u00c8","\u00e8","\u00c9","\u00e9","\u00ca","\u00ea","\u00cb","\u00eb","\u011a","\u011b","\u0112","\u0113","\u0116","\u0117","\u0118","\u0119","\u0122","\u0123","\u011c","\u011d","\u011e","\u011f","\u0120","\u0121","\u0124","\u0125","\u00cc","\u00ec","\u00cd","\u00ed","\u00ce","\u00ee","\u00cf","\u00ef","\u01cf","\u01d0","\u012a","\u012b","\u0130","\u0131","\u012e","\u012f","\u0134","\u0135","\u0136","\u0137","\u0139","\u013a","\u013b","\u013c","\u013d","\u013e","\u0141","\u0142","\u013f","\u0140","\u0143","\u0144","\u00d1","\u00f1","\u0145","\u0146","\u0147","\u0148","\u00d2","\u00f2","\u00d3","\u00f3","\u00d4","\u00f4","\u00d5","\u00f5","\u00d6","\u00f6","\u01d1","\u01d2","\u014c","\u014d","\u0150","\u0151","\u0152","\u0153","\u00d8","\u00f8","\u0154","\u0155","\u0156","\u0157","\u0158","\u0159","\u015a","\u015b","\u015e","\u015f","\u0160","\u0161","\u015c","\u015d","\u0162","\u0163","\u0164","\u0165","\u00d9","\u00f9","\u00da","\u00fa","\u00db","\u00fb","\u00dc","\u00fc","\u01d3","\u01d4","\u016c","\u016d","\u016a","\u016b","\u016e","\u016f","\u01d6","\u01d8","\u01da","\u01dc","\u0172","\u0173","\u0170","\u0171","\u0174","\u0175","\u00dd","\u00fd","\u0178","\u00ff","\u0176","\u0177","\u0179","\u017a","\u017d","\u017e","\u017b","\u017c","\u00de","\u00fe","\u00df","\u0126","\u0127","\u00bf","\u00a1","\u00a2","\u00a3","\u00a4","\u00a5","\u20ac","\u00a6","\u00a7","\u00aa","\u00ac","\u00af","\u00b0","\u00b1","\u00f7","\u2030","\u00bc","\u00bd","\u00be","\u00b9","\u00b2","\u00b3","\u00b5","\u00b6","\u2020","\u2021","\u00b7","\u2022","\u00ba","\u2200","\u2202","\u2203","\u018f","\u0259","\u2205","\u2207","\u2208","\u2209","\u220b","\u220f","\u2211","\u203e","\u2212","\u2217","\u00d7","\u2044","\u221a","\u221d","\u221e","\u2220","\u2227","\u2228","\u2229","\u222a","\u222b","\u2234","\u223c","\u2245","\u2248","\u2260","\u2261","\u2264","\u2265","\u2282","\u2283","\u2284","\u2286","\u2287","\u2295","\u2297","\u22a5","\u22c5","\u25ca","\u2118","\u2111","\u211c","\u2135","\u2660","\u2663","\u2665","\u2666","\u03b1","\u03b2","\u0393","\u03b3","\u0394","\u03b4","\u03b5","\u03b6","\u03b7","\u0398","\u03b8","\u03b9","\u03ba","\u039b","\u03bb","\u03bc","\u039e","\u03be","\u03a0","\u03c0","\u03c1","\u03a3","\u03c3","\u03a4","\u03c4","\u03c5","\u03a6","\u03c6","\u03c7","\u03a8","\u03c8","\u03a9","\u03c9","\u2605","\u2606","\u260e","\u261a","\u261b","\u261c","\u261d","\u261e","\u261f","\u2639","\u263a","\u2714","\u2718","\u201e","\u201c","\u201d","\u201a","\u2018","\u2019","\u00ab","\u00bb","\u2039","\u203a","\u2014","\u2013","\u2026","\u2190","\u2191","\u2192","\u2193","\u2194","\u21d0","\u21d1","\u21d2","\u21d3","\u21d4","\u00a9","\u2122","\u00ae","\u2032","\u2033","[","]","{","}","~","(",")","%","\u00a7","$","#","|","@"],"block":false},{"type":"signature","title":"Inserir assinatura","icon":"sig.png","key":"y","block":false},{"type":"mediapopup","title":"Bootstrap Wrapper","icon":"..\/..\/plugins\/bootswrapper\/images\/bootstrap.png","url":"lib\/plugins\/bootswrapper\/exe\/popup.php?ns=","name":"bootstrap-wrapper","options":"width=800,height=600,left=20,top=20,toolbar=no,menubar=no,scrollbars=yes,resizable=yes","block":false},{"type":"picker","title":"Plugin Wrap","icon":"..\/..\/plugins\/wrap\/images\/toolbar\/picker.png","list":[{"type":"format","title":"colunas","icon":"..\/..\/plugins\/wrap\/images\/toolbar\/column.png","open":"<WRAP group>\\n<WRAP half column>\\n","close":"\\n<\/WRAP>\\n\\n<WRAP half column>\\n\\n<\/WRAP>\\n<\/WRAP>\\n"},{"type":"format","title":"caixa centralizada simples","icon":"..\/..\/plugins\/wrap\/images\/toolbar\/box.png","open":"<WRAP center round box 60%>\\n","close":"\\n<\/WRAP>\\n"},{"type":"format","title":"caixa de informa\u00e7\u00e3o","icon":"..\/..\/plugins\/wrap\/images\/note\/16\/info.png","open":"<WRAP center round info 60%>\\n","close":"\\n<\/WRAP>\\n"},{"type":"format","title":"caixa de sugest\u00e3o","icon":"..\/..\/plugins\/wrap\/images\/note\/16\/tip.png","open":"<WRAP center round tip 60%>\\n","close":"\\n<\/WRAP>\\n"},{"type":"format","title":"caixa importante","icon":"..\/..\/plugins\/wrap\/images\/note\/16\/important.png","open":"<WRAP center round important 60%>\\n","close":"\\n<\/WRAP>\\n"},{"type":"format","title":"caixa de alerta","icon":"..\/..\/plugins\/wrap\/images\/note\/16\/alert.png","open":"<WRAP center round alert 60%>\\n","close":"\\n<\/WRAP>\\n"},{"type":"format","title":"caixa de ajuda","icon":"..\/..\/plugins\/wrap\/images\/note\/16\/help.png","open":"<WRAP center round help 60%>\\n","close":"\\n<\/WRAP>\\n"},{"type":"format","title":"caixa de download","icon":"..\/..\/plugins\/wrap\/images\/note\/16\/download.png","open":"<WRAP center round download 60%>\\n","close":"\\n<\/WRAP>\\n"},{"type":"format","title":"caixa de tarefas a fazer","icon":"..\/..\/plugins\/wrap\/images\/note\/16\/todo.png","open":"<WRAP center round todo 60%>\\n","close":"\\n<\/WRAP>\\n"},{"type":"insert","title":"limpar","icon":"..\/..\/plugins\/wrap\/images\/toolbar\/clear.png","insert":"<WRAP clear\/>\\n"},{"type":"format","title":"especialmente enfatizado","icon":"..\/..\/plugins\/wrap\/images\/toolbar\/em.png","open":"<wrap em>","close":"<\/wrap>"},{"type":"format","title":"enfatizado","icon":"..\/..\/plugins\/wrap\/images\/toolbar\/hi.png","open":"<wrap hi>","close":"<\/wrap>"},{"type":"format","title":"menos significativo","icon":"..\/..\/plugins\/wrap\/images\/toolbar\/lo.png","open":"<wrap lo>","close":"<\/wrap>"}]}];(function(factory){if(typeof define==='function'&&define.amd){define(['jquery'],factory);}else{factory(jQuery);}}(function($){var pluses=/\+/g;function raw(s){return s;}function decoded(s){return decodeURIComponent(s.replace(pluses,' '));}function converted(s){if(s.indexOf('"')===0){s=s.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,'\\');}try{return config.json?JSON.parse(s):s;}catch(er){}}var config=$.cookie=function(key,value,options){if(value!==undefined){options=$.extend({},config.defaults,options);if(typeof options.expires==='number'){var days=options.expires,t=options.expires=new Date();t.setDate(t.getDate()+days);}value=config.json?JSON.stringify(value):String(value);return(document.cookie=[config.raw?key:encodeURIComponent(key),'=',config.raw?value:encodeURIComponent(value),options.expires?'; expires='+options.expires.toUTCString():'',options.path?'; path='+options.path:'',options.domain?'; domain='+options.domain:'',options.secure?'; secure':''].join(''));}var decode=config.raw?raw:decoded;var cookies=document.cookie.split('; ');var result=key?undefined:{};for(var i=0,l=cookies.length;i<l;i++){var parts=cookies[i].split('=');var name=decode(parts.shift());var cookie=decode(parts.join('='));if(key&&key===name){result=converted(cookie);break;}if(!key){result[name]=converted(cookie);}}return result;};config.defaults={};$.removeCookie=function(key,options){if($.cookie(key)!==undefined){$.cookie(key,'',$.extend({},options,{expires:-1}));return true;}return false;};}));(function(factory){if(typeof define==="function"&&define.amd){define(["../widgets/datepicker"],factory);}else{factory(jQuery.datepicker);}}(function(datepicker){datepicker.regional["pt-BR"]={closeText:"Fechar",prevText:"&#x3C;Anterior",nextText:"Próximo&#x3E;",currentText:"Hoje",monthNames:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthNamesShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],dayNames:["Domingo","Segunda-feira","Terça-feira","Quarta-feira","Quinta-feira","Sexta-feira","Sábado"],dayNamesShort:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"],dayNamesMin:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"],weekHeader:"Sm",dateFormat:"dd/mm/yy",firstDay:0,isRTL:false,showMonthAfterYear:false,yearSuffix:""};datepicker.setDefaults(datepicker.regional["pt-BR"]);return datepicker.regional["pt-BR"];}));var qq=qq||{};qq.extend=function(first,second){for(var prop in second){first[prop]=second[prop];}};qq.indexOf=function(arr,elt,from){if(arr.indexOf)return arr.indexOf(elt,from);from=from||0;var len=arr.length;if(from<0)from+=len;for(;from<len;from++){if(from in arr&&arr[from]===elt){return from;}}return-1;};qq.getUniqueId=(function(){var id=0;return function(){return id++;};})();qq.attach=function(element,type,fn){if(element.addEventListener){element.addEventListener(type,fn,false);}else if(element.attachEvent){element.attachEvent('on'+type,fn);}};qq.detach=function(element,type,fn){if(element.removeEventListener){element.removeEventListener(type,fn,false);}else if(element.attachEvent){element.detachEvent('on'+type,fn);}};qq.preventDefault=function(e){if(e.preventDefault){e.preventDefault();}else{e.returnValue=false;}};qq.insertBefore=function(a,b){b.parentNode.insertBefore(a,b);};qq.remove=function(element){element.parentNode.removeChild(element);};qq.contains=function(parent,descendant){if(parent==descendant)return true;if(parent.contains){return parent.contains(descendant);}else{return!!(descendant.compareDocumentPosition(parent)&8);}};qq.toElement=(function(){var div=document.createElement('div');return function(html){div.innerHTML=html;var element=div.firstChild;div.removeChild(element);return element;};})();qq.css=function(element,styles){if(styles.opacity!=null){if(typeof element.style.opacity!='string'&&typeof(element.filters)!='undefined'){styles.filter='alpha(opacity='+Math.round(100*styles.opacity)+')';}}qq.extend(element.style,styles);};qq.hasClass=function(element,name){var re=new RegExp('(^| )'+name+'( |$)');return re.test(element.className);};qq.addClass=function(element,name){if(!qq.hasClass(element,name)){element.className+=' '+name;}};qq.removeClass=function(element,name){var re=new RegExp('(^| )'+name+'( |$)');element.className=element.className.replace(re,' ').replace(/^\s+|\s+$/g,"");};qq.setText=function(element,text){element.innerText=text;element.textContent=text;};qq.children=function(element){var children=[],child=element.firstChild;while(child){if(child.nodeType==1){children.push(child);}child=child.nextSibling;}return children;};qq.getByClass=function(element,className){if(element.querySelectorAll){return element.querySelectorAll('.'+className);}var result=[];var candidates=element.getElementsByTagName("*");var len=candidates.length;for(var i=0;i<len;i++){if(qq.hasClass(candidates[i],className)){result.push(candidates[i]);}}return result;};qq.obj2url=function(obj,temp,prefixDone){var uristrings=[],prefix='&',add=function(nextObj,i){var nextTemp=temp?(/\[\]$/.test(temp))?temp:temp+'['+i+']':i;if((nextTemp!='undefined')&&(i!='undefined')){uristrings.push((typeof nextObj==='object')?qq.obj2url(nextObj,nextTemp,true):(Object.prototype.toString.call(nextObj)==='[object Function]')?encodeURIComponent(nextTemp)+'='+encodeURIComponent(nextObj()):encodeURIComponent(nextTemp)+'='+encodeURIComponent(nextObj));}};if(!prefixDone&&temp){prefix=(/\?/.test(temp))?(/\?$/.test(temp))?'':'&':'?';uristrings.push(temp);uristrings.push(qq.obj2url(obj));}else if((Object.prototype.toString.call(obj)==='[object Array]')&&(typeof obj!='undefined')){for(var i=0,len=obj.length;i<len;++i){add(obj[i],i);}}else if((typeof obj!='undefined')&&(obj!==null)&&(typeof obj==="object")){for(var i in obj){if(obj.hasOwnProperty(i)&&typeof obj[i]!='function'){add(obj[i],i);}}}else{uristrings.push(encodeURIComponent(temp)+'='+encodeURIComponent(obj));}return uristrings.join(prefix).replace(/^&/,'').replace(/%20/g,'+');};var qq=qq||{};qq.FileUploaderBasic=function(o){this._options={debug:false,action:'/server/upload',params:{},button:null,multiple:true,maxConnections:3,allowedExtensions:[],sizeLimit:0,minSizeLimit:0,onSubmit:function(id,fileName){},onProgress:function(id,fileName,loaded,total){},onComplete:function(id,fileName,responseJSON){},onCancel:function(id,fileName){},messages:{typeError:"{file} has invalid extension. Only {extensions} are allowed.",sizeError:"{file} is too large, maximum file size is {sizeLimit}.",minSizeError:"{file} is too small, minimum file size is {minSizeLimit}.",emptyError:"{file} is empty, please select files again without it.",onLeave:"The files are being uploaded, if you leave now the upload will be cancelled."},showMessage:function(message){alert(message);}};qq.extend(this._options,o);this._filesInProgress=0;this._handler=this._createUploadHandler();if(this._options.button){this._button=this._createUploadButton(this._options.button);}this._preventLeaveInProgress();};qq.FileUploaderBasic.prototype={setParams:function(params){this._options.params=params;},getInProgress:function(){return this._filesInProgress;},_createUploadButton:function(element){var self=this;return new qq.UploadButton({element:element,multiple:this._options.multiple&&qq.UploadHandlerXhr.isSupported(),onChange:function(input){self._onInputChange(input);}});},_createUploadHandler:function(){var self=this,handlerClass;if(qq.UploadHandlerXhr.isSupported()){handlerClass='UploadHandlerXhr';}else{handlerClass='UploadHandlerForm';}var handler=new qq[handlerClass]({debug:this._options.debug,action:this._options.action,maxConnections:this._options.maxConnections,onProgress:function(id,fileName,loaded,total){self._onProgress(id,fileName,loaded,total);self._options.onProgress(id,fileName,loaded,total);},onComplete:function(id,fileName,result){self._onComplete(id,fileName,result);self._options.onComplete(id,fileName,result);},onCancel:function(id,fileName){self._onCancel(id,fileName);self._options.onCancel(id,fileName);}});return handler;},_preventLeaveInProgress:function(){var self=this;qq.attach(window,'beforeunload',function(e){if(!self._filesInProgress){return;}var e=e||window.event;e.returnValue=self._options.messages.onLeave;return self._options.messages.onLeave;});},_onSubmit:function(id,fileName){this._filesInProgress++;},_onProgress:function(id,fileName,loaded,total){},_onComplete:function(id,fileName,result){this._filesInProgress--;if(result.error){this._options.showMessage(result.error);}},_onCancel:function(id,fileName){this._filesInProgress--;},_onInputChange:function(input){if(this._handler instanceof qq.UploadHandlerXhr){this._uploadFileList(input.files);}else{if(this._validateFile(input)){this._uploadFile(input);}}this._button.reset();},_uploadFileList:function(files){for(var i=0;i<files.length;i++){if(!this._validateFile(files[i])){return;}}for(var i=0;i<files.length;i++){this._uploadFile(files[i]);}},_uploadFile:function(fileContainer){var id=this._handler.add(fileContainer);var fileName=this._handler.getName(id);if(this._options.onSubmit(id,fileName)!==false){this._onSubmit(id,fileName);this._handler.upload(id,this._options.params);}},_validateFile:function(file){var name,size;if(file.value){name=file.value.replace(/.*(\/|\\)/,"");}else{name=file.fileName!=null?file.fileName:file.name;size=file.fileSize!=null?file.fileSize:file.size;}if(!this._isAllowedExtension(name)){this._error('typeError',name);return false;}else if(size===0){this._error('emptyError',name);return false;}else if(size&&this._options.sizeLimit&&size>this._options.sizeLimit){this._error('sizeError',name);return false;}else if(size&&size<this._options.minSizeLimit){this._error('minSizeError',name);return false;}return true;},_error:function(code,fileName){var message=this._options.messages[code];function r(name,replacement){message=message.replace(name,replacement);}r('{file}',this._formatFileName(fileName));r('{extensions}',this._options.allowedExtensions.join(', '));r('{sizeLimit}',this._formatSize(this._options.sizeLimit));r('{minSizeLimit}',this._formatSize(this._options.minSizeLimit));this._options.showMessage(message);},_formatFileName:function(name){if(name.length>33){name=name.slice(0,19)+'...'+name.slice(-13);}return name;},_isAllowedExtension:function(fileName){var ext=(-1!==fileName.indexOf('.'))?fileName.replace(/.*[.]/,'').toLowerCase():'';var allowed=this._options.allowedExtensions;if(!allowed.length){return true;}for(var i=0;i<allowed.length;i++){if(allowed[i].toLowerCase()==ext){return true;}}return false;},_formatSize:function(bytes){var i=-1;do{bytes=bytes/1024;i++;}while(bytes>99);return Math.max(bytes,0.1).toFixed(1)+['kB','MB','GB','TB','PB','EB'][i];}};qq.FileUploader=function(o){qq.FileUploaderBasic.apply(this,arguments);qq.extend(this._options,{element:null,listElement:null,template:'<div class="qq-uploader">'+'<div class="qq-upload-drop-area"><span>Drop files here to upload</span></div>'+'<div class="qq-upload-button">Upload a file</div>'+'<ul class="qq-upload-list"></ul>'+'</div>',fileTemplate:'<li>'+'<span class="qq-upload-file"></span>'+'<span class="qq-upload-spinner"></span>'+'<span class="qq-upload-size"></span>'+'<a class="qq-upload-cancel" href="#">Cancel</a>'+'<span class="qq-upload-failed-text">Failed</span>'+'</li>',classes:{button:'qq-upload-button',drop:'qq-upload-drop-area',dropActive:'qq-upload-drop-area-active',list:'qq-upload-list',file:'qq-upload-file',spinner:'qq-upload-spinner',size:'qq-upload-size',cancel:'qq-upload-cancel',success:'qq-upload-success',fail:'qq-upload-fail'}});qq.extend(this._options,o);this._element=this._options.element;this._element.innerHTML=this._options.template;this._listElement=this._options.listElement||this._find(this._element,'list');this._classes=this._options.classes;this._button=this._createUploadButton(this._find(this._element,'button'));this._bindCancelEvent();this._setupDragDrop();};qq.extend(qq.FileUploader.prototype,qq.FileUploaderBasic.prototype);qq.extend(qq.FileUploader.prototype,{_find:function(parent,type){var element=qq.getByClass(parent,this._options.classes[type])[0];if(!element){throw new Error('element not found '+type);}return element;},_setupDragDrop:function(){var self=this,dropArea=this._find(this._element,'drop');var dz=new qq.UploadDropZone({element:dropArea,onEnter:function(e){qq.addClass(dropArea,self._classes.dropActive);e.stopPropagation();},onLeave:function(e){e.stopPropagation();},onLeaveNotDescendants:function(e){qq.removeClass(dropArea,self._classes.dropActive);},onDrop:function(e){dropArea.style.display='none';qq.removeClass(dropArea,self._classes.dropActive);self._uploadFileList(e.dataTransfer.files);}});dropArea.style.display='none';qq.attach(document,'dragenter',function(e){if(!dz._isValidFileDrag(e))return;dropArea.style.display='block';});qq.attach(document,'dragleave',function(e){if(!dz._isValidFileDrag(e))return;var relatedTarget=document.elementFromPoint(e.clientX,e.clientY);if(!relatedTarget||relatedTarget.nodeName=="HTML"){dropArea.style.display='none';}});},_onSubmit:function(id,fileName){qq.FileUploaderBasic.prototype._onSubmit.apply(this,arguments);this._addToList(id,fileName);},_onProgress:function(id,fileName,loaded,total){qq.FileUploaderBasic.prototype._onProgress.apply(this,arguments);var item=this._getItemByFileId(id);var size=this._find(item,'size');size.style.display='inline';var text;if(loaded!=total){text=Math.round(loaded/total*100)+'% from '+this._formatSize(total);}else{text=this._formatSize(total);}qq.setText(size,text);},_onComplete:function(id,fileName,result){qq.FileUploaderBasic.prototype._onComplete.apply(this,arguments);var item=this._getItemByFileId(id);qq.remove(this._find(item,'cancel'));qq.remove(this._find(item,'spinner'));if(result.success){qq.addClass(item,this._classes.success);}else{qq.addClass(item,this._classes.fail);}},_addToList:function(id,fileName){var item=qq.toElement(this._options.fileTemplate);item.qqFileId=id;var fileElement=this._find(item,'file');qq.setText(fileElement,this._formatFileName(fileName));this._find(item,'size').style.display='none';this._listElement.appendChild(item);},_getItemByFileId:function(id){var item=this._listElement.firstChild;while(item){if(item.qqFileId==id)return item;item=item.nextSibling;}},_bindCancelEvent:function(){var self=this,list=this._listElement;qq.attach(list,'click',function(e){e=e||window.event;var target=e.target||e.srcElement;if(qq.hasClass(target,self._classes.cancel)){qq.preventDefault(e);var item=target.parentNode;self._handler.cancel(item.qqFileId);qq.remove(item);}});}});qq.UploadDropZone=function(o){this._options={element:null,onEnter:function(e){},onLeave:function(e){},onLeaveNotDescendants:function(e){},onDrop:function(e){}};qq.extend(this._options,o);this._element=this._options.element;this._disableDropOutside();this._attachEvents();};qq.UploadDropZone.prototype={_disableDropOutside:function(e){if(!qq.UploadDropZone.dropOutsideDisabled){qq.attach(document,'dragover',function(e){if(e.dataTransfer){e.dataTransfer.dropEffect='none';e.preventDefault();}});qq.UploadDropZone.dropOutsideDisabled=true;}},_attachEvents:function(){var self=this;qq.attach(self._element,'dragover',function(e){if(!self._isValidFileDrag(e))return;var effect=e.dataTransfer.effectAllowed;if(effect=='move'||effect=='linkMove'){e.dataTransfer.dropEffect='move';}else{e.dataTransfer.dropEffect='copy';}e.stopPropagation();e.preventDefault();});qq.attach(self._element,'dragenter',function(e){if(!self._isValidFileDrag(e))return;self._options.onEnter(e);});qq.attach(self._element,'dragleave',function(e){if(!self._isValidFileDrag(e))return;self._options.onLeave(e);var relatedTarget=document.elementFromPoint(e.clientX,e.clientY);if(qq.contains(this,relatedTarget))return;self._options.onLeaveNotDescendants(e);});qq.attach(self._element,'drop',function(e){if(!self._isValidFileDrag(e))return;e.preventDefault();self._options.onDrop(e);});},_isValidFileDrag:function(e){var dt=e.dataTransfer,isWebkit=navigator.userAgent.indexOf("AppleWebKit")>-1;return dt&&dt.effectAllowed!='none'&&(dt.files||(!isWebkit&&dt.types.contains&&dt.types.contains('Files')));}};qq.UploadButton=function(o){this._options={element:null,multiple:false,name:'file',onChange:function(input){},hoverClass:'qq-upload-button-hover',focusClass:'qq-upload-button-focus'};qq.extend(this._options,o);this._element=this._options.element;qq.css(this._element,{position:'relative',overflow:'hidden',direction:'ltr'});this._input=this._createInput();};qq.UploadButton.prototype={getInput:function(){return this._input;},reset:function(){if(this._input.parentNode){qq.remove(this._input);}qq.removeClass(this._element,this._options.focusClass);this._input=this._createInput();},_createInput:function(){var input=document.createElement("input");if(this._options.multiple){input.setAttribute("multiple","multiple");}input.setAttribute("type","file");input.setAttribute("name",this._options.name);qq.css(input,{position:'absolute',right:0,top:0,fontFamily:'Arial',fontSize:'118px',margin:0,padding:0,cursor:'pointer',opacity:0});this._element.appendChild(input);var self=this;qq.attach(input,'change',function(){self._options.onChange(input);});qq.attach(input,'mouseover',function(){qq.addClass(self._element,self._options.hoverClass);});qq.attach(input,'mouseout',function(){qq.removeClass(self._element,self._options.hoverClass);});qq.attach(input,'focus',function(){qq.addClass(self._element,self._options.focusClass);});qq.attach(input,'blur',function(){qq.removeClass(self._element,self._options.focusClass);});if(window.attachEvent){input.setAttribute('tabIndex',"-1");}return input;}};qq.UploadHandlerAbstract=function(o){this._options={debug:false,action:'/upload.php',maxConnections:999,onProgress:function(id,fileName,loaded,total){},onComplete:function(id,fileName,response){},onCancel:function(id,fileName){}};qq.extend(this._options,o);this._queue=[];this._params=[];};qq.UploadHandlerAbstract.prototype={log:function(str){if(this._options.debug&&window.console)console.log('[uploader] '+str);},add:function(file){},upload:function(id,params){var len=this._queue.push(id);var copy={};qq.extend(copy,params);this._params[id]=copy;if(len<=this._options.maxConnections){this._upload(id,this._params[id]);}},cancel:function(id){this._cancel(id);this._dequeue(id);},cancelAll:function(){for(var i=0;i<this._queue.length;i++){this._cancel(this._queue[i]);}this._queue=[];},getName:function(id){},getSize:function(id){},getQueue:function(){return this._queue;},_upload:function(id){},_cancel:function(id){},_dequeue:function(id){var i=qq.indexOf(this._queue,id);this._queue.splice(i,1);var max=this._options.maxConnections;if(this._queue.length>=max&&i<max){var nextId=this._queue[max-1];this._upload(nextId,this._params[nextId]);}}};qq.UploadHandlerForm=function(o){qq.UploadHandlerAbstract.apply(this,arguments);this._inputs={};};qq.extend(qq.UploadHandlerForm.prototype,qq.UploadHandlerAbstract.prototype);qq.extend(qq.UploadHandlerForm.prototype,{add:function(fileInput){fileInput.setAttribute('name','qqfile');var id='qq-upload-handler-iframe'+qq.getUniqueId();this._inputs[id]=fileInput;if(fileInput.parentNode){qq.remove(fileInput);}return id;},getName:function(id){return this._inputs[id].value.replace(/.*(\/|\\)/,"");},_cancel:function(id){this._options.onCancel(id,this.getName(id));delete this._inputs[id];var iframe=document.getElementById(id);if(iframe){iframe.setAttribute('src','javascript:false;');qq.remove(iframe);}},_upload:function(id,params){var input=this._inputs[id];if(!input){throw new Error('file with passed id was not added, or already uploaded or cancelled');}var fileName=this.getName(id);var iframe=this._createIframe(id);var form=this._createForm(iframe,params);form.appendChild(input);var self=this;this._attachLoadEvent(iframe,function(){self.log('iframe loaded');var response=self._getIframeContentJSON(iframe);self._options.onComplete(id,fileName,response);self._dequeue(id);delete self._inputs[id];setTimeout(function(){qq.remove(iframe);},1);});form.submit();qq.remove(form);return id;},_attachLoadEvent:function(iframe,callback){qq.attach(iframe,'load',function(){if(!iframe.parentNode){return;}if(iframe.contentDocument&&iframe.contentDocument.body&&iframe.contentDocument.body.innerHTML=="false"){return;}callback();});},_getIframeContentJSON:function(iframe){var doc=iframe.contentDocument?iframe.contentDocument:iframe.contentWindow.document,response;this.log("converting iframe's innerHTML to JSON");this.log("innerHTML = "+doc.body.innerHTML);try{response=eval("("+doc.body.innerHTML+")");}catch(err){response={};}return response;},_createIframe:function(id){var iframe=qq.toElement('<iframe src="javascript:false;" name="'+id+'" />');iframe.setAttribute('id',id);iframe.style.display='none';document.body.appendChild(iframe);return iframe;},_createForm:function(iframe,params){var form=qq.toElement('<form method="post" enctype="multipart/form-data"></form>');var queryString=qq.obj2url(params,this._options.action);form.setAttribute('action',queryString);form.setAttribute('target',iframe.name);form.style.display='none';document.body.appendChild(form);return form;}});qq.UploadHandlerXhr=function(o){qq.UploadHandlerAbstract.apply(this,arguments);this._files=[];this._xhrs=[];this._loaded=[];};qq.UploadHandlerXhr.isSupported=function(){var input=document.createElement('input');input.type='file';return('multiple'in input&&typeof File!="undefined"&&typeof(new XMLHttpRequest()).upload!="undefined");};qq.extend(qq.UploadHandlerXhr.prototype,qq.UploadHandlerAbstract.prototype);qq.extend(qq.UploadHandlerXhr.prototype,{add:function(file){if(!(file instanceof File)){throw new Error('Passed obj in not a File (in qq.UploadHandlerXhr)');}return this._files.push(file)-1;},getName:function(id){var file=this._files[id];return file.fileName!=null?file.fileName:file.name;},getSize:function(id){var file=this._files[id];return file.fileSize!=null?file.fileSize:file.size;},getLoaded:function(id){return this._loaded[id]||0;},_upload:function(id,params){var file=this._files[id],name=this.getName(id),size=this.getSize(id);this._loaded[id]=0;var xhr=this._xhrs[id]=new XMLHttpRequest();var self=this;xhr.upload.onprogress=function(e){if(e.lengthComputable){self._loaded[id]=e.loaded;self._options.onProgress(id,name,e.loaded,e.total);}};xhr.onreadystatechange=function(){if(xhr.readyState==4){self._onComplete(id,xhr);}};params=params||{};params['qqfile']=name;var queryString=qq.obj2url(params,this._options.action);xhr.open("POST",queryString,true);xhr.setRequestHeader("X-Requested-With","XMLHttpRequest");xhr.setRequestHeader("X-File-Name",encodeURIComponent(name));xhr.setRequestHeader("Content-Type","application/octet-stream");xhr.send(file);},_onComplete:function(id,xhr){if(!this._files[id])return;var name=this.getName(id);var size=this.getSize(id);this._options.onProgress(id,name,size,size);if(xhr.status==200){this.log("xhr - server response received");this.log("responseText = "+xhr.responseText);var response;try{response=eval("("+xhr.responseText+")");}catch(err){response={};}this._options.onComplete(id,name,response);}else{this._options.onComplete(id,name,{});}this._files[id]=null;this._xhrs[id]=null;this._dequeue(id);},_cancel:function(id){this._options.onCancel(id,this.getName(id));this._files[id]=null;if(this._xhrs[id]){this._xhrs[id].abort();this._xhrs[id]=null;}}});qq.extend(qq.FileUploader.prototype,{_createUploadHandler:function(){var self=this,handlerClass;if(qq.UploadHandlerXhr.isSupported()){handlerClass='UploadHandlerXhr';}else{handlerClass='UploadHandlerForm';}var handler=new qq[handlerClass]({debug:this._options.debug,action:this._options.action,maxConnections:this._options.maxConnections,onProgress:function(id,fileName,loaded,total){self._onProgress(id,fileName,loaded,total);self._options.onProgress(id,fileName,loaded,total);},onComplete:function(id,fileName,result){self._onComplete(id,fileName,result);self._options.onComplete(id,fileName,result);},onCancel:function(id,fileName){self._onCancel(id,fileName);self._options.onCancel(id,fileName);},onUpload:function(){self._onUpload();}});return handler;},_onUpload:function(){this._handler.uploadAll(this._options.params);},_uploadFile:function(fileContainer){var id=this._handler.add(fileContainer);var fileName=this._handler.getName(id);if(this._options.onSubmit(id,fileName)!==false){this._onSubmit(id,fileName);}},_addToList:function(id,fileName){var item=qq.toElement(this._options.fileTemplate);item.qqFileId=id;var fileElement=this._find(item,'file');qq.setText(fileElement,fileName);this._find(item,'size').style.display='none';var nameElement=this._find(item,'nameInput');fileName=fileName.toLowerCase();fileName=fileName.replace(/([ !"#$%&\'()+,\/;<=>?@[\]^`{|}~:]+)/g,'_');fileName=fileName.replace(/^_+/,'');nameElement.value=fileName;nameElement.id='mediamanager__upload_item'+id;this._listElement.appendChild(item);}});qq.FileUploaderExtended=function(o){qq.FileUploaderBasic.apply(this,arguments);qq.extend(this._options,{element:null,listElement:null,template:'<div class="qq-uploader">'+'<div class="qq-upload-drop-area"><span>'+LANG.media_drop+'</span></div>'+'<div class="qq-upload-button">'+LANG.media_select+'</div>'+'<ul class="qq-upload-list"></ul>'+'<div class="qq-action-container">'+'  <button class="qq-upload-action" type="submit" id="mediamanager__upload_button">'+LANG.media_upload_btn+'</button>'+'  <label class="qq-overwrite-check"><input type="checkbox" value="1" name="ow" class="dw__ow"> <span>'+LANG.media_overwrt+'</span></label>'+'</div>'+'</div>',fileTemplate:'<li>'+'<span class="qq-upload-file hidden"></span>'+'  <input class="qq-upload-name-input edit" type="text" value="" />'+'  <span class="qq-upload-spinner hidden"></span>'+'  <span class="qq-upload-size"></span>'+'  <a class="qq-upload-cancel" href="#">'+LANG.media_cancel+'</a>'+'  <span class="qq-upload-failed-text error">Failed</span>'+'</li>',classes:{button:'qq-upload-button',drop:'qq-upload-drop-area',dropActive:'qq-upload-drop-area-active',list:'qq-upload-list',nameInput:'qq-upload-name-input',overwriteInput:'qq-overwrite-check',uploadButton:'qq-upload-action',file:'qq-upload-file',spinner:'qq-upload-spinner',size:'qq-upload-size',cancel:'qq-upload-cancel',success:'qq-upload-success',fail:'qq-upload-fail',failedText:'qq-upload-failed-text'}});qq.extend(this._options,o);this._element=this._options.element;this._element.innerHTML=this._options.template;this._listElement=this._options.listElement||this._find(this._element,'list');this._classes=this._options.classes;this._button=this._createUploadButton(this._find(this._element,'button'));this._bindCancelEvent();this._bindUploadEvent();this._setupDragDrop();};qq.extend(qq.FileUploaderExtended.prototype,qq.FileUploader.prototype);qq.extend(qq.FileUploaderExtended.prototype,{_bindUploadEvent:function(){var self=this,list=this._listElement;qq.attach(document.getElementById('mediamanager__upload_button'),'click',function(e){e=e||window.event;var target=e.target||e.srcElement;qq.preventDefault(e);self._handler._options.onUpload();jQuery(".qq-upload-name-input").each(function(i){jQuery(this).attr('disabled','disabled');});});},_onComplete:function(id,fileName,result){this._filesInProgress--;var item=this._getItemByFileId(id);qq.remove(this._find(item,'cancel'));qq.remove(this._find(item,'spinner'));var nameInput=this._find(item,'nameInput');var fileElement=this._find(item,'file');qq.setText(fileElement,nameInput.value);qq.removeClass(fileElement,'hidden');qq.remove(nameInput);jQuery('.qq-upload-button, #mediamanager__upload_button').remove();jQuery('.dw__ow').parent().hide();jQuery('.qq-upload-drop-area').remove();if(result.success){qq.addClass(item,this._classes.success);$link='<a href="'+result.link+'" id="h_:'+result.id+'" class="select">'+nameInput.value+'</a>';jQuery(fileElement).html($link);}else{qq.addClass(item,this._classes.fail);var fail=this._find(item,'failedText');if(result.error)qq.setText(fail,result.error);}if(document.getElementById('media__content')&&!document.getElementById('mediamanager__done_form')){var action=document.location.href;var i=action.indexOf('?');if(i)action=action.substr(0,i);var button='<form method="post" action="'+action+'" id="mediamanager__done_form"><div>';button+='<input type="hidden" value="'+result.ns+'" name="ns">';button+='<input type="hidden" value="1" name="recent">';button+='<button type="submit">'+LANG.media_done_btn+'</button></div></form>';jQuery('#mediamanager__uploader').append(button);}}});qq.extend(qq.UploadHandlerForm.prototype,{uploadAll:function(params){this._uploadAll(params);},getName:function(id){var file=this._inputs[id];var name=document.getElementById('mediamanager__upload_item'+id);if(name!=null){return name.value;}else{if(file!=null){return file.value.replace(/.*(\/|\\)/,"");}else{return null;}}},_uploadAll:function(params){jQuery(".qq-upload-spinner").each(function(i){jQuery(this).removeClass('hidden');});for(key in this._inputs){this.upload(key,params);}},_upload:function(id,params){var input=this._inputs[id];if(!input){throw new Error('file with passed id was not added, or already uploaded or cancelled');}var fileName=this.getName(id);var iframe=this._createIframe(id);var form=this._createForm(iframe,params);form.appendChild(input);var nameInput=qq.toElement('<input name="mediaid" value="'+fileName+'" type="text">');form.appendChild(nameInput);var checked=jQuery('.dw__ow').is(':checked');var owCheckbox=jQuery('.dw__ow').clone();owCheckbox.attr('checked',checked);jQuery(form).append(owCheckbox);var self=this;this._attachLoadEvent(iframe,function(){self.log('iframe loaded');var response=self._getIframeContentJSON(iframe);self._options.onComplete(id,fileName,response);self._dequeue(id);delete self._inputs[id];setTimeout(function(){qq.remove(iframe);},1);});form.submit();qq.remove(form);return id;}});qq.extend(qq.UploadHandlerXhr.prototype,{uploadAll:function(params){this._uploadAll(params);},getName:function(id){var file=this._files[id];var name=document.getElementById('mediamanager__upload_item'+id);if(name!=null){return name.value;}else{if(file!=null){return file.fileName!=null?file.fileName:file.name;}else{return null;}}},getSize:function(id){var file=this._files[id];if(file==null)return null;return file.fileSize!=null?file.fileSize:file.size;},_upload:function(id,params){var file=this._files[id],name=this.getName(id),size=this.getSize(id);if(name==null||size==null)return;this._loaded[id]=0;var xhr=this._xhrs[id]=new XMLHttpRequest();var self=this;xhr.upload.onprogress=function(e){if(e.lengthComputable){self._loaded[id]=e.loaded;self._options.onProgress(id,name,e.loaded,e.total);}};xhr.onreadystatechange=function(){if(xhr.readyState==4){self._onComplete(id,xhr);}};params=params||{};params['qqfile']=name;params['ow']=jQuery('.dw__ow').is(':checked');var queryString=qq.obj2url(params,this._options.action);xhr.open("POST",queryString,true);xhr.setRequestHeader("X-Requested-With","XMLHttpRequest");xhr.setRequestHeader("X-File-Name",encodeURIComponent(name));xhr.setRequestHeader("Content-Type","application/octet-stream");xhr.send(file);},_uploadAll:function(params){jQuery(".qq-upload-spinner").each(function(i){jQuery(this).removeClass('hidden');});for(key in this._files){this.upload(key,params);}}});function substr_replace(str,replace,start,length){var a2,b1;a2=(start<0?str.length:0)+start;if(typeof length==='undefined'){length=str.length-a2;}else if(length<0&&start<0&&length<=start){length=0;}b1=(length<0?str.length:a2)+length;return str.substring(0,a2)+replace+str.substring(b1);}function bind(fnc){var Aps=Array.prototype.slice,static_args=Aps.call(arguments,1);return function(){return fnc.apply(this,static_args.concat(Aps.call(arguments,0)));};}function logError(e,file){if(window.console&&console.error){console.error('The error "%s: %s" occurred in file "%s". '+'If this is in a plugin try updating or disabling the plugin, '+'if this is in a template try updating the template or switching to the "dokuwiki" template.',e.name,e.message,file);if(e.stack){console.error(e.stack);}}}var timer={_cur_id:0,_handlers:{},execDispatch:function(id){timer._handlers[id]();},add:function(func,timeout){var id=++timer._cur_id;timer._handlers[id]=func;return window.setTimeout('timer.execDispatch('+id+')',timeout);}};function Delay(func,timeout){this.func=func;if(timeout){this.timeout=timeout;}}Delay.prototype={func:null,timeout:500,delTimer:function(){if(this.timer!==null){window.clearTimeout(this.timer);this.timer=null;}},start:function(){DEPRECATED('don\'t use the Delay object, use window.timeout with a callback instead');this.delTimer();var _this=this;this.timer=timer.add(function(){_this.exec.call(_this);},this.timeout);this._data={_this:arguments[0],_params:Array.prototype.slice.call(arguments,2)};},exec:function(){this.delTimer();this.func.call(this._data._this,this._data._params);}};var DokuCookie={data:{},name:'DOKU_PREFS',setValue:function(key,val){var text=[],_this=this;this.init();this.data[key]=val;jQuery.each(_this.data,function(key,val){if(_this.data.hasOwnProperty(key)){text.push(encodeURIComponent(key)+'#'+encodeURIComponent(val));}});jQuery.cookie(this.name,text.join('#'),{expires:365,path:DOKU_COOKIE_PARAM.path,secure:DOKU_COOKIE_PARAM.secure});},getValue:function(key){this.init();return this.data[key];},init:function(){var text,parts,i;if(!jQuery.isEmptyObject(this.data)){return;}text=jQuery.cookie(this.name);if(text){parts=text.split('#');for(i=0;i<parts.length;i+=2){this.data[decodeURIComponent(parts[i])]=decodeURIComponent(parts[i+1]);}}}};if('function'===typeof jQuery&&'function'===typeof jQuery.noConflict){jQuery.noConflict();}var clientPC=navigator.userAgent.toLowerCase();var is_macos=navigator.appVersion.indexOf('Mac')!=-1;var is_gecko=((clientPC.indexOf('gecko')!=-1)&&(clientPC.indexOf('spoofer')==-1)&&(clientPC.indexOf('khtml')==-1)&&(clientPC.indexOf('netscape/7.0')==-1));var is_safari=((clientPC.indexOf('applewebkit')!=-1)&&(clientPC.indexOf('spoofer')==-1));var is_khtml=(navigator.vendor=='KDE'||(document.childNodes&&!document.all&&!navigator.taintEnabled));if(clientPC.indexOf('opera')!=-1){var is_opera=true;var is_opera_preseven=(window.opera&&!document.childNodes);var is_opera_seven=(window.opera&&document.childNodes);}function closePopups(){jQuery('div.JSpopup').hide();}jQuery(function(){jQuery(document).click(closePopups);});var Tawk_API=Tawk_API||{},Tawk_LoadStart=new Date();(function(){var s1=document.createElement("script"),s0=document.getElementsByTagName("script")[0];s1.async=true;s1.src='https://embed.tawk.to/5bd1e463476c2f239ff5fa46/default';s1.charset='UTF-8';s1.setAttribute('crossorigin','*');s0.parentNode.insertBefore(s1,s0);})();Tawk_API.onLoad=function(){Tawk_API.setAttributes({'branch':JSINFO.user.branch,'name':JSINFO.user.name,'email':JSINFO.user.mail,'hash':JSINFO.user.tawkHash},function(error){});};jQuery.fn.dw_qsearch=function(overrides){var dw_qsearch={output:'#qsearch__out',$inObj:this,$outObj:null,timer:null,curRequest:null,init:function(){var do_qsearch;dw_qsearch.$outObj=jQuery(dw_qsearch.output);if(dw_qsearch.$inObj.length===0||dw_qsearch.$outObj.length===0){return;}do_qsearch=function(){if(dw_qsearch.curRequest!=null){dw_qsearch.curRequest.abort();}var value=dw_qsearch.getSearchterm();if(value===''){dw_qsearch.clear_results();return;}dw_qsearch.$inObj.parents('form').addClass('searching');dw_qsearch.curRequest=jQuery.post(DOKU_BASE+'lib/exe/ajax.php',{call:'qsearch',q:encodeURI(value)},dw_qsearch.onCompletion,'html');};dw_qsearch.$inObj.keyup(function(){if(dw_qsearch.timer){window.clearTimeout(dw_qsearch.timer);dw_qsearch.timer=null;}dw_qsearch.timer=window.setTimeout(do_qsearch,500);});dw_qsearch.$outObj.click(dw_qsearch.clear_results);},getSearchterm:function(){return dw_qsearch.$inObj.val();},clear_results:function(){dw_qsearch.$inObj.parents('form').removeClass('searching');dw_qsearch.$outObj.hide();dw_qsearch.$outObj.text('');},onCompletion:function(data){var max,$links,too_big;dw_qsearch.$inObj.parents('form').removeClass('searching');dw_qsearch.curRequest=null;if(data===''){dw_qsearch.clear_results();return;}dw_qsearch.$outObj .html(data).show().css('white-space','nowrap');dw_qsearch.$outObj.find('li').css('overflow','visible');$links=dw_qsearch.$outObj.find('a');max=dw_qsearch.$outObj[0].clientWidth;if(document.documentElement.dir==='rtl'){max-=parseInt(dw_qsearch.$outObj.css('padding-left'));too_big=function(l){return l.offsetLeft<0;};}else{max-=parseInt(dw_qsearch.$outObj.css('padding-right'));too_big=function(l){return l.offsetWidth+l.offsetLeft>max;};}$links.each(function(){var start,length,replace,nsL,nsR,eli,runaway;if(!too_big(this)){return;}nsL=this.textContent.indexOf('(');nsR=this.textContent.indexOf(')');eli=0;runaway=0;while((nsR-nsL>3)&&too_big(this)&&runaway++<500){if(eli!==0){if((eli-nsL)>(nsR-eli)){start=eli-2;length=2;}else{start=eli+1;length=1;}replace='';}else{start=Math.floor(nsL+((nsR-nsL)/2));length=1;replace='…';}this.textContent=substr_replace(this.textContent,replace,start,length);eli=this.textContent.indexOf('…');nsL=this.textContent.indexOf('(');nsR=this.textContent.indexOf(')');}});dw_qsearch.$outObj.find('li').css('overflow','hidden').css('text-overflow','ellipsis');}};jQuery.extend(dw_qsearch,overrides);if(!overrides.deferInit){dw_qsearch.init();}return dw_qsearch;};jQuery(function(){jQuery('#qsearch__in').dw_qsearch({output:'#qsearch__out'});});jQuery(function(){'use strict';const $searchForm=jQuery('.search-results-form');if(!$searchForm.length){return;}const $toggleAssistanceButton=jQuery('<button>').addClass('toggleAssistant').attr('type','button').attr('aria-expanded','false').text(LANG.search_toggle_tools).prependTo($searchForm.find('fieldset'));$toggleAssistanceButton.on('click',function(){jQuery('.advancedOptions').toggle(0,function(){var $me=jQuery(this);if($me.attr('aria-hidden')){$me.removeAttr('aria-hidden');$toggleAssistanceButton.attr('aria-expanded','true');DokuCookie.setValue('sa','on');}else{$me.attr('aria-hidden','true');$toggleAssistanceButton.attr('aria-expanded','false');DokuCookie.setValue('sa','off');}});});if(DokuCookie.getValue('sa')==='on'){$toggleAssistanceButton.click();}$searchForm.find('.advancedOptions .toggle div.current').on('click',function(){var $me=jQuery(this);$me.parent().siblings().removeClass('open');$me.parent().siblings().find('ul:first').attr('aria-expanded','false');$me.parent().toggleClass('open');if($me.parent().hasClass('open')){$me.parent().find('ul:first').attr('aria-expanded','true');}else{$me.parent().find('ul:first').attr('aria-expanded','false');}});});jQuery.fn.dw_tree=function(overrides){var dw_tree={throbber_delay:500,$obj:this,toggle_selector:'a.idx_dir',init:function(){this.$obj.on('click',this.toggle_selector,this,this.toggle);jQuery('ul:first',this.$obj).attr('role','tree');jQuery('ul',this.$obj).not(':first').attr('role','group');jQuery('li',this.$obj).attr('role','treeitem');jQuery('li.open > ul',this.$obj).attr('aria-expanded','true');jQuery('li.closed > ul',this.$obj).attr('aria-expanded','false');jQuery('li.closed',this.$obj).attr('aria-live','assertive');},toggle:function(e){var $listitem,$sublist,timeout,$clicky,show_sublist,dw_tree,opening;e.preventDefault();dw_tree=e.data;$clicky=jQuery(this);$listitem=$clicky.closest('li');$sublist=$listitem.find('ul').first();opening=$listitem.hasClass('closed');dw_tree.toggle_display($clicky,opening);if($sublist.is(':visible')){$listitem.removeClass('open').addClass('closed');$sublist.attr('aria-expanded','false');}else{$listitem.removeClass('closed').addClass('open');$sublist.attr('aria-expanded','true');}if(!opening){$sublist.dw_hide();return;}show_sublist=function(data){$sublist.hide();if(typeof data!=='undefined'){$sublist.html(data);$sublist.parent().attr('aria-busy','false').removeAttr('aria-live');jQuery('li.closed',$sublist).attr('aria-live','assertive');}if($listitem.hasClass('open')){$sublist.dw_show();}};if($sublist.length>0){show_sublist();return;}$sublist=jQuery('<ul class="idx" role="group"/>');$listitem.append($sublist);timeout=window.setTimeout(bind(show_sublist,'<li aria-busy="true"><img src="'+DOKU_BASE+'lib/images/throbber.gif" alt="loading..." title="loading..." /></li>'),dw_tree.throbber_delay);dw_tree.load_data(function(data){window.clearTimeout(timeout);show_sublist(data);},$clicky);},toggle_display:function($clicky,opening){},load_data:function(show_data,$clicky){show_data();}};jQuery.extend(dw_tree,overrides);if(!overrides.deferInit){dw_tree.init();}return dw_tree;};var dw_index=jQuery('#index__tree').dw_tree({deferInit:true,load_data:function(show_sublist,$clicky){jQuery.post(DOKU_BASE+'lib/exe/ajax.php',$clicky[0].search.substr(1)+'&call=index',show_sublist,'html');}});jQuery(function(){var $tree=jQuery('#index__tree');dw_index.$obj=$tree;dw_index.init();});function selection_class(){this.start=0;this.end=0;this.obj=null;this.scroll=0;this.fix=0;this.getLength=function(){return this.end-this.start;};this.getText=function(){return(!this.obj)?'':this.obj.value.substring(this.start,this.end);};}function DWgetSelection(textArea){var sel=new selection_class();textArea.focus();sel.obj=textArea;sel.start=textArea.selectionStart;sel.end=textArea.selectionEnd;sel.scroll=textArea.scrollTop;return sel;}function DWsetSelection(selection){selection.obj.setSelectionRange(selection.start,selection.end);if(selection.scroll)selection.obj.scrollTop=selection.scroll;}function pasteText(selection,text,opts){if(!opts)opts={};selection.obj.value=selection.obj.value.substring(0,selection.start)+text+selection.obj.value.substring(selection.end,selection.obj.value.length);if(is_opera){selection.end=selection.start+text.replace(/\r?\n/g,'\r\n').length;}else{selection.end=selection.start+text.length;}if(opts.startofs)selection.start+=opts.startofs;if(opts.endofs)selection.end-=opts.endofs;if(opts.nosel)selection.start=selection.end;DWsetSelection(selection);}function insertTags(textAreaID,tagOpen,tagClose,sampleText){var txtarea=jQuery('#'+textAreaID)[0];var selection=DWgetSelection(txtarea);var text=selection.getText();var opts;if(text.charAt(text.length-1)==' '){selection.end--;text=selection.getText();}if(!text){text=sampleText;opts={startofs:tagOpen.length,endofs:tagClose.length};}else{opts={nosel:true};}text=tagOpen+text+tagClose;pasteText(selection,text,opts);}function insertAtCarret(textAreaID,text){var txtarea=jQuery('#'+textAreaID)[0];var selection=DWgetSelection(txtarea);pasteText(selection,text,{nosel:true});}var pickercounter=0;function initToolbar(tbid,edid,tb,allowblock){var $toolbar,$edit;if(typeof tbid=='string'){$toolbar=jQuery('#'+tbid);}else{$toolbar=jQuery(tbid);}$edit=jQuery('#'+edid);if($toolbar.length==0||$edit.length==0||$edit.attr('readOnly')){return;}if(typeof allowblock==='undefined'){allowblock=true;}$toolbar.html('');jQuery.each(tb,function(k,val){if(!tb.hasOwnProperty(k)||(!allowblock&&val.block===true)){return;}var actionFunc,$btn;$btn=jQuery(createToolButton(val.icon,val.title,val.key,val.id,val['class']));actionFunc='tb_'+val.type;if(jQuery.isFunction(window[actionFunc])){$btn.on('click',bind(window[actionFunc],$btn,val,edid));$toolbar.append($btn);return;}actionFunc='addBtnAction'+val.type.charAt(0).toUpperCase()+val.type.substring(1);if(jQuery.isFunction(window[actionFunc])){var pickerid=window[actionFunc]($btn,val,edid);if(pickerid!==''){$toolbar.append($btn);$btn.attr('aria-controls',pickerid);if(actionFunc==='addBtnActionPicker'){$btn.attr('aria-haspopup','true');}}return;}alert('unknown toolbar type: '+val.type+'  '+actionFunc);});}function tb_format(btn,props,edid){var sample=props.sample||props.title;insertTags(edid,fixtxt(props.open),fixtxt(props.close),fixtxt(sample));pickerClose();return false;}function tb_formatln(btn,props,edid){var sample=props.sample||props.title,opts,selection=DWgetSelection(jQuery('#'+edid)[0]);sample=fixtxt(sample);props.open=fixtxt(props.open);props.close=fixtxt(props.close);if(selection.getLength()){sample=selection.getText();opts={nosel:true};}else{opts={startofs:props.open.length,endofs:props.close.length};}sample=sample.split("\n").join(props.close+"\n"+props.open);sample=props.open+sample+props.close;pasteText(selection,sample,opts);pickerClose();return false;}function tb_insert(btn,props,edid){insertAtCarret(edid,fixtxt(props.insert));pickerClose();return false;}function tb_mediapopup(btn,props,edid){window.open(DOKU_BASE+props.url+encodeURIComponent(NS)+'&edid='+encodeURIComponent(edid),props.name,props.options);return false;}function tb_autohead(btn,props,edid){var lvl=currentHeadlineLevel(edid),tags;lvl+=props.mod;if(lvl<1)lvl=1;if(lvl>5)lvl=5;tags=(new Array(8-lvl)).join('=');insertTags(edid,tags+' ',' '+tags+"\n",props.text);pickerClose();return false;}function addBtnActionPicker($btn,props,edid){var pickerid='picker'+(pickercounter++);var picker=createPicker(pickerid,props,edid);jQuery(picker).attr('aria-hidden','true');$btn.click(function(e){pickerToggle(pickerid,$btn);e.preventDefault();return'';});return pickerid;}function addBtnActionLinkwiz($btn,props,edid){dw_linkwiz.init(jQuery('#'+edid));jQuery($btn).click(function(e){dw_linkwiz.val=props;dw_linkwiz.toggle();e.preventDefault();return'';});return'link__wiz';}function pickerToggle(pickerid,$btn){var $picker=jQuery('#'+pickerid),pos=$btn.offset();if($picker.hasClass('a11y')){$picker.removeClass('a11y').attr('aria-hidden','false');}else{$picker.addClass('a11y').attr('aria-hidden','true');}var picker_left=pos.left+3,picker_width=$picker.width(),window_width=jQuery(window).width();if(picker_width>300){$picker.css("max-width","300");picker_width=300;}if((picker_left+picker_width+40)>window_width){picker_left=window_width-picker_width-40;}if(picker_left<0){picker_left=0;}$picker.offset({left:picker_left,top:pos.top+$btn[0].offsetHeight+3});}function pickerClose(){jQuery('.picker').addClass('a11y');}function fixtxt(str){return str.replace(/\\n/g,"\n");}jQuery(function(){initToolbar('tool__bar','wiki__text',toolbar);jQuery('#tool__bar').attr('role','toolbar');});function createToolButton(icon,label,key,id,classname){var $btn=jQuery(document.createElement('button')),$ico=jQuery(document.createElement('img'));$btn.addClass('toolbutton');if(classname){$btn.addClass(classname);}$btn.attr('title',label).attr('aria-controls','wiki__text');if(key){$btn.attr('title',label+' ['+key.toUpperCase()+']').attr('accessKey',key);}if(id){$btn.attr('id',id);$ico.attr('id',id+'_ico');}if(icon.substr(0,1)!=='/'){icon=DOKU_BASE+'lib/images/toolbar/'+icon;}$ico.attr('src',icon);$ico.attr('alt','');$ico.attr('width',16);$ico.attr('height',16);$btn.append($ico);return $btn[0];}function createPicker(id,props,edid){var $picker=jQuery(document.createElement('div'));$picker.addClass('picker a11y');if(props['class']){$picker.addClass(props['class']);}$picker.attr('id',id).css('position','absolute');function $makebutton(title){var $btn=jQuery(document.createElement('button')).addClass('pickerbutton').attr('title',title).attr('aria-controls',edid).on('click',bind(pickerInsert,title,edid)).appendTo($picker);return $btn;}jQuery.each(props.list,function(key,item){if(!props.list.hasOwnProperty(key)){return;}if(isNaN(key)){if(item.substr(0,1)!=='/'){item=DOKU_BASE+'lib/images/'+props.icobase+'/'+item;}jQuery(document.createElement('img')).attr('src',item).attr('alt','').appendTo($makebutton(key));}else if(typeof item=='string'){$makebutton(item).text(item);}else{initToolbar($picker,edid,props.list);return false;}});jQuery('body').append($picker);return $picker[0];}function pickerInsert(text,edid){insertAtCarret(edid,text);pickerClose();}function addBtnActionSignature($btn,props,edid){if(typeof SIG!='undefined'&&SIG!=''){$btn.on('click',function(e){insertAtCarret(edid,SIG);e.preventDefault();});return edid;}return'';}function currentHeadlineLevel(textboxId){var field=jQuery('#'+textboxId)[0],s=false,opts=[field.value.substr(0,DWgetSelection(field).start)];if(field.form.prefix){opts.push(field.form.prefix.value);}jQuery.each(opts,function(_,opt){var str="\n"+opt,lasthl=str.lastIndexOf("\n==");if(lasthl!==-1){s=str.substr(lasthl+1,6);return false;}});if(s===false){return 0;}return 7-s.match(/^={2,6}/)[0].length;}window.textChanged=false;window.doku_edit_text_content='';function deleteDraft(){if(is_opera||window.keepDraft){return;}var $dwform=jQuery('#dw__editform');if($dwform.length===0){return;}jQuery.post(DOKU_BASE+'lib/exe/ajax.php',{call:'draftdel',id:$dwform.find('input[name=id]').val()});}jQuery(function(){var $editform=jQuery('#dw__editform');if($editform.length==0){return;}var $edit_text=jQuery('#wiki__text');if($edit_text.length>0){if($edit_text.attr('readOnly')){return;}var sel=DWgetSelection($edit_text[0]);sel.start=0;sel.end=0;DWsetSelection(sel);$edit_text.focus();doku_edit_text_content=$edit_text.val();}var changeHandler=function(){doku_hasTextBeenModified();doku_summaryCheck();};$editform.change(changeHandler);$editform.keydown(changeHandler);window.onbeforeunload=function(){if(window.textChanged){return LANG.notsavedyet;}};window.onunload=deleteDraft;jQuery('#edbtn__save').click(function(){window.onbeforeunload='';textChanged=false;});jQuery('#edbtn__preview').click(function(){window.onbeforeunload='';textChanged=false;window.keepDraft=true;});var $summary=jQuery('#edit__summary');$summary.change(doku_summaryCheck);$summary.keyup(doku_summaryCheck);if(textChanged)doku_summaryCheck();});function doku_hasTextBeenModified(){if(!textChanged){var $edit_text=jQuery('#wiki__text');if($edit_text.length>0){textChanged=doku_edit_text_content!=$edit_text.val();}else{textChanged=true;}}}function doku_summaryCheck(){var $sum=jQuery('#edit__summary'),missing=$sum.val()==='';$sum.toggleClass('missing',missing).toggleClass('edit',!missing);}var dw_editor={init:function(){var $editor=jQuery('#wiki__text');if($editor.length===0){return;}dw_editor.initSizeCtl('#size__ctl',$editor);if($editor.attr('readOnly')){return;}$editor.keydown(dw_editor.keyHandler);},initSizeCtl:function(ctlarea,editor){var $ctl=jQuery(ctlarea),$textarea=jQuery(editor);if($ctl.length===0||$textarea.length===0){return;}$textarea.css('height',DokuCookie.getValue('sizeCtl')||'300px');var wrp=DokuCookie.getValue('wrapCtl');if(wrp){dw_editor.setWrap($textarea[0],wrp);}jQuery.each([['larger',function(){dw_editor.sizeCtl(editor,100);}],['smaller',function(){dw_editor.sizeCtl(editor,-100);}],['wrap',function(){dw_editor.toggleWrap(editor);}]],function(_,img){jQuery(document.createElement('img')).attr('src',DOKU_BASE+'lib/images/'+img[0]+'.gif').attr('alt','').click(img[1]).appendTo($ctl);});},sizeCtl:function(editor,val){var $textarea=jQuery(editor),height=parseInt($textarea.css('height'))+val;$textarea.css('height',height+'px');DokuCookie.setValue('sizeCtl',$textarea.css('height'));},toggleWrap:function(editor){var $textarea=jQuery(editor),wrap=$textarea.attr('wrap');dw_editor.setWrap($textarea[0],(wrap&&wrap.toLowerCase()=='off')?'soft':'off');DokuCookie.setValue('wrapCtl',$textarea.attr('wrap'));},setWrap:function(textarea,wrapAttrValue){textarea.setAttribute('wrap',wrapAttrValue);var parNod=textarea.parentNode;var nxtSib=textarea.nextSibling;parNod.removeChild(textarea);parNod.insertBefore(textarea,nxtSib);},keyHandler:function(e){if(jQuery.inArray(e.keyCode,[8,10,13,32])===-1){return;}var selection=DWgetSelection(this);if(selection.getLength()>0){return;}var search="\n"+this.value.substr(0,selection.start);var linestart=Math.max(search.lastIndexOf("\n"),search.lastIndexOf("\r"));search=search.substr(linestart);if((e.keyCode==13||e.keyCode==10)&&e.ctrlKey){jQuery('#edbtn__save').click();e.preventDefault();return false;}else if(e.keyCode==13){var match=search.match(/(\n  +([\*-] ?)?)/);if(match){var scroll=this.scrollHeight;var match2=search.match(/^\n  +[\*-]\s*$/);if(match2&&this.value.substr(selection.start).match(/^($|\r?\n)/)){this.value=this.value.substr(0,linestart)+"\n"+this.value.substr(selection.start);selection.start=linestart+1;selection.end=linestart+1;DWsetSelection(selection);}else{insertAtCarret(this.id,match[1]);}this.scrollTop+=(this.scrollHeight-scroll);e.preventDefault();return false;}}else if(e.keyCode==8){var match=search.match(/(\n  +)([*-] ?)$/);if(match){var spaces=match[1].length-1;if(spaces>3){this.value=this.value.substr(0,linestart)+this.value.substr(linestart+2);selection.start=selection.start-2;selection.end=selection.start;}else{this.value=this.value.substr(0,linestart)+this.value.substr(selection.start);selection.start=linestart;selection.end=linestart;}DWsetSelection(selection);e.preventDefault();return false;}}else if(e.keyCode==32){var match=search.match(/(\n  +)([*-] )$/);if(match){this.value=this.value.substr(0,linestart)+'  '+this.value.substr(linestart);selection.start=selection.start+2;selection.end=selection.start;DWsetSelection(selection);e.preventDefault();return false;}}}};jQuery(dw_editor.init);var dw_locktimer={timeout:0,draft:false,timerID:null,lasttime:null,msg:LANG.willexpire,pageid:'',init:function(timeout,draft,edid){var $edit;edid=edid||'wiki__text';$edit=jQuery('#'+edid);if($edit.length===0||$edit.attr('readonly')){return;}dw_locktimer.timeout=timeout*1000;dw_locktimer.draft=draft;dw_locktimer.lasttime=new Date();dw_locktimer.pageid=jQuery('#dw__editform').find('input[name=id]').val();if(!dw_locktimer.pageid){return;}$edit.keypress(dw_locktimer.refresh);dw_locktimer.reset();},reset:function(){dw_locktimer.clear();dw_locktimer.timerID=window.setTimeout(dw_locktimer.warning,dw_locktimer.timeout);},warning:function(){dw_locktimer.clear();alert(fixtxt(dw_locktimer.msg));},clear:function(){if(dw_locktimer.timerID!==null){window.clearTimeout(dw_locktimer.timerID);dw_locktimer.timerID=null;}},refresh:function(){var now=new Date(),params='call=lock&id='+dw_locktimer.pageid+'&';if(now.getTime()-dw_locktimer.lasttime.getTime()<=30*1000){return;}if(dw_locktimer.draft&&jQuery('#dw__editform').find('textarea[name=wikitext]').length>0){params+=jQuery('#dw__editform').find('input[name=prefix], '+'textarea[name=wikitext], '+'input[name=suffix], '+'input[name=date]').serialize();}jQuery.post(DOKU_BASE+'lib/exe/ajax.php',params,dw_locktimer.refreshed,'html');dw_locktimer.lasttime=now;},refreshed:function(data){var error=data.charAt(0);data=data.substring(1);jQuery('#draft__status').html(data);if(error!='1'){return;}dw_locktimer.reset();}};var dw_linkwiz={$wiz:null,$entry:null,result:null,timer:null,textArea:null,selected:null,selection:null,init:function($editor){var pos=$editor.position();if(dw_linkwiz.$wiz)return;dw_linkwiz.$wiz=jQuery(document.createElement('div')).dialog({autoOpen:false,draggable:true,title:LANG.linkwiz,resizable:false}).html('<div>'+LANG.linkto+' <input type="text" class="edit" id="link__wiz_entry" autocomplete="off" /></div>'+'<div id="link__wiz_result"></div>').parent().attr('id','link__wiz').css({'position':'absolute','top':(pos.top+20)+'px','left':(pos.left+80)+'px'}).hide().appendTo('.dokuwiki:first');dw_linkwiz.textArea=$editor[0];dw_linkwiz.result=jQuery('#link__wiz_result')[0];jQuery(dw_linkwiz.result).css('position','relative');dw_linkwiz.$entry=jQuery('#link__wiz_entry');if(JSINFO.namespace){dw_linkwiz.$entry.val(JSINFO.namespace+':');}jQuery('#link__wiz .ui-dialog-titlebar-close').click(dw_linkwiz.hide);dw_linkwiz.$entry.keyup(dw_linkwiz.onEntry);jQuery(dw_linkwiz.result).on('click','a',dw_linkwiz.onResultClick);},onEntry:function(e){if(e.keyCode==37||e.keyCode==39){return true;}if(e.keyCode==27){dw_linkwiz.hide();e.preventDefault();e.stopPropagation();return false;}if(e.keyCode==38){dw_linkwiz.select(dw_linkwiz.selected-1);e.preventDefault();e.stopPropagation();return false;}if(e.keyCode==40){dw_linkwiz.select(dw_linkwiz.selected+1);e.preventDefault();e.stopPropagation();return false;}if(e.keyCode==13){if(dw_linkwiz.selected>-1){var $obj=dw_linkwiz.$getResult(dw_linkwiz.selected);if($obj.length>0){dw_linkwiz.resultClick($obj.find('a')[0]);}}else if(dw_linkwiz.$entry.val()){dw_linkwiz.insertLink(dw_linkwiz.$entry.val());}e.preventDefault();e.stopPropagation();return false;}dw_linkwiz.autocomplete();},getResult:function(num){DEPRECATED('use dw_linkwiz.$getResult()[0] instead');return dw_linkwiz.$getResult()[0]||null;},$getResult:function(num){return jQuery(dw_linkwiz.result).find('div').eq(num);},select:function(num){if(num<0){dw_linkwiz.deselect();return;}var $obj=dw_linkwiz.$getResult(num);if($obj.length===0){return;}dw_linkwiz.deselect();$obj.addClass('selected');var childPos=$obj.position().top;var yDiff=childPos+$obj.outerHeight()-jQuery(dw_linkwiz.result).innerHeight();if(childPos<0){jQuery(dw_linkwiz.result)[0].scrollTop+=childPos;}else if(yDiff>0){jQuery(dw_linkwiz.result)[0].scrollTop+=yDiff;}dw_linkwiz.selected=num;},deselect:function(){if(dw_linkwiz.selected>-1){dw_linkwiz.$getResult(dw_linkwiz.selected).removeClass('selected');}dw_linkwiz.selected=-1;},onResultClick:function(e){if(!jQuery(this).is('a')){return;}e.stopPropagation();e.preventDefault();dw_linkwiz.resultClick(this);return false;},resultClick:function(a){dw_linkwiz.$entry.val(a.title);if(a.title==''||a.title.substr(a.title.length-1)==':'){dw_linkwiz.autocomplete_exec();}else{if(jQuery(a.nextSibling).is('span')){dw_linkwiz.insertLink(a.nextSibling.innerHTML);}else{dw_linkwiz.insertLink('');}}},insertLink:function(title){var link=dw_linkwiz.$entry.val(),sel,stxt;if(!link){return;}sel=DWgetSelection(dw_linkwiz.textArea);if(sel.start==0&&sel.end==0){sel=dw_linkwiz.selection;}stxt=sel.getText();if(stxt.charAt(stxt.length-1)==' '){sel.end--;stxt=sel.getText();}if(!stxt&&!DOKU_UHC){stxt=title;}if(dw_linkwiz.textArea.form.id.value.indexOf(':')!=-1&&link.indexOf(':')==-1){link=':'+link;}var so=link.length;var eo=0;if(dw_linkwiz.val){if(dw_linkwiz.val.open){so+=dw_linkwiz.val.open.length;link=dw_linkwiz.val.open+link;}link+='|';so+=1;if(stxt){link+=stxt;}if(dw_linkwiz.val.close){link+=dw_linkwiz.val.close;eo=dw_linkwiz.val.close.length;}}pasteText(sel,link,{startofs:so,endofs:eo});dw_linkwiz.hide();var externallinkpattern=new RegExp('^((f|ht)tps?:)?//','i'),entry_value;if(externallinkpattern.test(dw_linkwiz.$entry.val())){if(JSINFO.namespace){entry_value=JSINFO.namespace+':';}else{entry_value='';}}else{entry_value=dw_linkwiz.$entry.val().replace(/[^:]*$/,'')}dw_linkwiz.$entry.val(entry_value);},autocomplete:function(){if(dw_linkwiz.timer!==null){window.clearTimeout(dw_linkwiz.timer);dw_linkwiz.timer=null;}dw_linkwiz.timer=window.setTimeout(dw_linkwiz.autocomplete_exec,350);},autocomplete_exec:function(){var $res=jQuery(dw_linkwiz.result);dw_linkwiz.deselect();$res.html('<img src="'+DOKU_BASE+'lib/images/throbber.gif" alt="" width="16" height="16" />').load(DOKU_BASE+'lib/exe/ajax.php',{call:'linkwiz',q:dw_linkwiz.$entry.val()});},show:function(){dw_linkwiz.selection=DWgetSelection(dw_linkwiz.textArea);dw_linkwiz.$wiz.show();dw_linkwiz.$entry.focus();dw_linkwiz.autocomplete();var temp=dw_linkwiz.$entry.val();dw_linkwiz.$entry.val('');dw_linkwiz.$entry.val(temp);},hide:function(){dw_linkwiz.$wiz.hide();dw_linkwiz.textArea.focus();},toggle:function(){if(dw_linkwiz.$wiz.css('display')=='none'){dw_linkwiz.show();}else{dw_linkwiz.hide();}}};var dw_mediamanager={keepopen:false,hide:false,popup:false,display:false,ext:false,$popup:null,align:false,link:false,size:false,forbidden_opts:{},view_opts:{list:false,sort:false},layout_width:0,minHeights:{thumbs:200,rows:100},init:function(){var $content,$tree;$content=jQuery('#media__content');$tree=jQuery('#media__tree');if(!$tree.length)return;dw_mediamanager.prepare_content($content);dw_mediamanager.attachoptions();dw_mediamanager.initpopup();$content .on('change','#upload__file',dw_mediamanager.suggest).on('click','a.select',dw_mediamanager.select).on('click','#media__content a.btn_media_delete',dw_mediamanager.confirmattach).on('submit','#mediamanager__done_form',dw_mediamanager.list);$tree.dw_tree({toggle_selector:'img',load_data:function(show_sublist,$clicky){var $link=$clicky.parent().find('div.li a.idx_dir');jQuery.post(DOKU_BASE+'lib/exe/ajax.php',$link[0].search.substr(1)+'&call=medians',show_sublist,'html');},toggle_display:function($clicky,opening){$clicky.attr('src',DOKU_BASE+'lib/images/'+(opening?'minus':'plus')+'.gif');}});$tree.on('click','a',dw_mediamanager.list);dw_mediamanager.set_fileview_list();dw_mediamanager.init_options();dw_mediamanager.image_diff();dw_mediamanager.init_ajax_uploader();var $page=jQuery('#mediamanager__page');$page.find('div.filelist').on('click','ul.tabs a',dw_mediamanager.list).on('click','div.panelContent a',dw_mediamanager.details).on('submit','#dw__mediasearch',dw_mediamanager.list).on('change','#upload__file',dw_mediamanager.suggest).on('click','.qq-upload-file a',dw_mediamanager.details);$page.find('div.file').on('click','ul.tabs a',dw_mediamanager.details).on('submit','#mediamanager__btn_update',dw_mediamanager.list).on('submit','#page__revisions',dw_mediamanager.details).on('click','#page__revisions a',dw_mediamanager.details).on('submit','#mediamanager__save_meta',dw_mediamanager.details).on('submit','#mediamanager__btn_delete',dw_mediamanager.details).on('submit','#mediamanager__btn_restore',dw_mediamanager.details).on('submit','.btn_newer, .btn_older',dw_mediamanager.details);dw_mediamanager.update_resizable();dw_mediamanager.layout_width=$page.width();jQuery(window).resize(dw_mediamanager.window_resize);},init_options:function(){var $options=jQuery('div.filelist div.panelHeader form.options'),$listType,$sortBy,$both;if($options.length===0){return;}$listType=$options.find('li.listType');$sortBy=$options.find('li.sortBy');$both=$listType.add($sortBy);$options.find('button[type=submit]').parent().hide();$both.find('label').each(function(){var $this=jQuery(this);$this.children('input').appendTo($this.parent());});$both.find("input[type='radio']").checkboxradio({icon:false});$both.controlgroup();$listType.children('input').change(function(){dw_mediamanager.set_fileview_list();});$sortBy.children('input').change(function(event){dw_mediamanager.set_fileview_sort();dw_mediamanager.list.call(jQuery('#dw__mediasearch')[0]||this,event);});},initpopup:function(){var opts,$insp,$insbtn;dw_mediamanager.$popup=jQuery(document.createElement('div')).attr('id','media__popup_content').dialog({autoOpen:false,width:280,modal:true,draggable:true,title:LANG.mediatitle,resizable:false});opts=[{id:'link',label:LANG.mediatarget,btns:['lnk','direct','nolnk','displaylnk']},{id:'align',label:LANG.mediaalign,btns:['noalign','left','center','right']},{id:'size',label:LANG.mediasize,btns:['small','medium','large','original']}];jQuery.each(opts,function(_,opt){var $p,$l;$p=jQuery(document.createElement('p')).attr('id','media__'+opt.id);if(dw_mediamanager.display==="2"){$p.hide();}$l=jQuery(document.createElement('label')).text(opt.label);$p.append($l);jQuery.each(opt.btns,function(i,text){var $btn,$img;$btn=jQuery(document.createElement('button')).addClass('button').attr('id',"media__"+opt.id+"btn"+(i+1)).attr('title',LANG['media'+text]).click(bind(dw_mediamanager.setOpt,opt.id));$img=jQuery(document.createElement('img')).attr('src',DOKU_BASE+'lib/images/media_'+opt.id+'_'+text+'.png');$btn.append($img);$p.append($btn);});dw_mediamanager.$popup.append($p);});$insp=jQuery(document.createElement('p'));dw_mediamanager.$popup.append($insp);$insbtn=jQuery(document.createElement('input')).attr('id','media__sendbtn').attr('type','button').addClass('button').val(LANG.mediainsert);$insp.append($insbtn);},insert:function(id){var opts,cb,edid,s;dw_mediamanager.$popup.dialog('close');opts='';if({img:1,swf:1}[dw_mediamanager.ext]===1){if(dw_mediamanager.link==='4'){opts='?linkonly';}else{if(dw_mediamanager.link==="3"&&dw_mediamanager.ext==='img'){opts='?nolink';}else if(dw_mediamanager.link==="2"&&dw_mediamanager.ext==='img'){opts='?direct';}s=parseInt(dw_mediamanager.size,10);var size=s*200;if(s&&s>=1&&s<4){opts+=(opts.length)?'&':'?';opts+=size;if(dw_mediamanager.ext==='swf'){switch(s){case 1:opts+='x62';break;case 2:opts+='x123';break;case 3:opts+='x185';break;}}}}}edid=String.prototype.match.call(document.location,/&edid=([^&]+)/);edid=edid?edid[1]:'wiki__text';cb=String.prototype.match.call(document.location,/&onselect=([^&]+)/);cb=cb?cb[1].replace(/[^\w]+/,''):'dw_mediamanager_item_select';opener[cb](edid,id,opts,dw_mediamanager.align,dw_mediamanager.keepopen);if(!dw_mediamanager.keepopen){window.close();}opener.focus();return false;},suggest:function(){var $file,$name,text;$file=jQuery(this);$name=jQuery('#upload__name');if($name.val()!='')return;if(!$file.length||!$name.length){return;}text=$file.val();text=text.substr(text.lastIndexOf('/')+1);text=text.substr(text.lastIndexOf('\\')+1);$name.val(text);},list:function(event){var $link,$content,params;if(event){event.preventDefault();}jQuery('div.success, div.info, div.error, div.notify').remove();$link=jQuery(this);$content=jQuery('#media__content');if($content.length===0){$content=jQuery('div.filelist');if($link.hasClass('idx_dir')){jQuery('div.file').empty();jQuery('div.namespaces .selected').removeClass('selected');$link.addClass('selected');}}params='call=medialist&';if($link[0].search){params+=$link[0].search.substr(1);}else if($link.is('form')){params+=dw_mediamanager.form_params($link);}else if($link.closest('form').length>0){params+=dw_mediamanager.form_params($link.closest('form'));}dw_mediamanager.update_content($content,params);},form_params:function($form){if(!$form.length)return;var action='';var i=$form[0].action.indexOf('?');if(i>=0){action=$form[0].action.substr(i+1);}return action+'&'+$form.serialize();},set_fileview_list:function(new_type){dw_mediamanager.set_fileview_opt(['list','listType',function(new_type){jQuery('div.filelist div.panelContent ul').toggleClass('rows',new_type==='rows').toggleClass('thumbs',new_type==='thumbs');}],new_type);dw_mediamanager.resize();},set_fileview_sort:function(new_sort){dw_mediamanager.set_fileview_opt(['sort','sortBy',function(new_sort){}],new_sort);},set_fileview_opt:function(opt,new_val){if(typeof new_val==='undefined'){new_val=jQuery('form.options li.'+opt[1]+' input').filter(':checked').val();if(typeof new_val==='undefined'){new_val='thumbs';}}if(new_val!==dw_mediamanager.view_opts[opt[0]]){opt[2](new_val);DokuCookie.setValue(opt[0],new_val);dw_mediamanager.view_opts[opt[0]]=new_val;}},details:function(event){var $link,$content,params,update_list;$link=jQuery(this);event.preventDefault();jQuery('div.success, div.info, div.error, div.notify').remove();if($link[0].id=='mediamanager__btn_delete'&&!confirm(LANG.del_confirm)){return false;}if($link[0].id=='mediamanager__btn_restore'&&!confirm(LANG.restore_confirm)){return false;}$content=jQuery('div.file');params='call=mediadetails&';if($link[0].search){params+=$link[0].search.substr(1);}else if($link.is('form')){params+=dw_mediamanager.form_params($link);}else if($link.closest('form').length>0){params+=dw_mediamanager.form_params($link.closest('form'));}update_list=($link[0].id=='mediamanager__btn_delete'||$link[0].id=='mediamanager__btn_restore');dw_mediamanager.update_content($content,params,update_list);},update_content:function($content,params,update_list){var $container;jQuery.post(DOKU_BASE+'lib/exe/ajax.php',params,function(data){dw_mediamanager.$resizables().resizable('destroy');if(update_list){dw_mediamanager.list.call(jQuery('#mediamanager__page').find('form.options button[type="submit"]')[0]);}$content.html(data);dw_mediamanager.prepare_content($content);dw_mediamanager.updatehide();dw_mediamanager.update_resizable();dw_behaviour.revisionBoxHandler();dw_mediamanager.set_fileview_list(dw_mediamanager.view_opts.list);dw_mediamanager.image_diff();dw_mediamanager.init_ajax_uploader();dw_mediamanager.init_options();},'html');$container=$content.find('div.panelContent');if($container.length===0){$container=$content;}$container.html('<img src="'+DOKU_BASE+'lib/images/loading.gif" alt="..." class="load" />');},window_resize:function(){dw_mediamanager.resize();dw_mediamanager.opacity_slider();dw_mediamanager.portions_slider();},$resizables:function(){return jQuery('#mediamanager__page').find('div.namespaces, div.filelist');},update_resizable:function(){var $resizables=dw_mediamanager.$resizables();$resizables.resizable({handles:(jQuery('html[dir=rtl]').length?'w':'e'),resize:function(event,ui){var $page=jQuery('#mediamanager__page');var widthFull=$page.width();var widthResizables=0;$resizables.each(function(){widthResizables+=jQuery(this).width();});var $filePanel=$page.find('div.panel.file');var widthOtherResizable=widthResizables-jQuery(this).width();var minWidthNonResizable=parseFloat($filePanel.css("min-width"));var maxWidth=widthFull-(widthOtherResizable+minWidthNonResizable)-1;$resizables.resizable("option","maxWidth",maxWidth);var relWidthNonResizable=99.9-(100*widthResizables/widthFull);$filePanel.width(relWidthNonResizable+'%');dw_mediamanager.resize();dw_mediamanager.opacity_slider();dw_mediamanager.portions_slider();}});dw_mediamanager.resize();},resize:function(){var $contents=jQuery('#mediamanager__page').find('div.panelContent'),height=jQuery(window).height()-jQuery(document.body).height()+Math.max.apply(null,jQuery.map($contents,function(v){return jQuery(v).height();}));if(height<dw_mediamanager.minHeights[dw_mediamanager.view_opts.list]){$contents.add(dw_mediamanager.$resizables()).height('auto');}else{$contents.height(height);dw_mediamanager.$resizables().each(function(){var $this=jQuery(this);$this.height(height+$this.find('div.panelContent').offset().top-$this.offset().top);});}},image_diff:function(){if(jQuery('#mediamanager__difftype').length)return;var $form=jQuery('#mediamanager__form_diffview');if(!$form.length)return;var $label=jQuery(document.createElement('label'));$label.append('<span>'+LANG.media_diff+'</span> ');var $select=jQuery(document.createElement('select')).attr('id','mediamanager__difftype').attr('name','difftype').change(dw_mediamanager.change_diff_type);$select.append(new Option(LANG.media_diff_both,"both"));$select.append(new Option(LANG.media_diff_opacity,"opacity"));$select.append(new Option(LANG.media_diff_portions,"portions"));$label.append($select);$form.append($label);var select=document.getElementById('mediamanager__difftype');select.options[0].text=LANG.media_diff_both;select.options[1].text=LANG.media_diff_opacity;select.options[2].text=LANG.media_diff_portions;},change_diff_type:function(){var $select=jQuery('#mediamanager__difftype');var $content=jQuery('#mediamanager__diff');var params=dw_mediamanager.form_params($select.closest('form'))+'&call=mediadiff';jQuery.post(DOKU_BASE+'lib/exe/ajax.php',params,function(data){$content.html(data);dw_mediamanager.portions_slider();dw_mediamanager.opacity_slider();},'html');},opacity_slider:function(){var $diff=jQuery("#mediamanager__diff");var $slider=$diff.find("div.slider");if(!$slider.length)return;var $image=$diff.find('div.imageDiff.opacity div.image1 img');if(!$image.length)return;$slider.width($image.width()-20);$slider.slider();$slider.slider("option","min",0);$slider.slider("option","max",0.999);$slider.slider("option","step",0.001);$slider.slider("option","value",0.5);$slider.on("slide",function(event,ui){jQuery('#mediamanager__diff').find('div.imageDiff.opacity div.image2 img').css({opacity:$slider.slider("option","value")});});},portions_slider:function(){var $diff=jQuery("#mediamanager__diff");if(!$diff.length)return;var $image1=$diff.find('div.imageDiff.portions div.image1 img');var $image2=$diff.find('div.imageDiff.portions div.image2 img');if(!$image1.length||!$image2.length)return;$diff.width('100%');$image2.parent().width('97%');$image1.width('100%');$image2.width('100%');if($image1.width()<$diff.width()){$diff.width($image1.width());}$image2.parent().width('50%');$image2.width($image1.width());$image1.width($image1.width());var $slider=$diff.find("div.slider");if(!$slider.length)return;$slider.width($image1.width()-20);$slider.slider();$slider.slider("option","min",0);$slider.slider("option","max",97);$slider.slider("option","step",1);$slider.slider("option","value",50);$slider.on("slide",function(event,ui){jQuery('#mediamanager__diff').find('div.imageDiff.portions div.image2').css({width:$slider.slider("option","value")+'%'});});},params_toarray:function(str){var vars=[],hash;var hashes=str.split('&');for(var i=0;i<hashes.length;i++){hash=hashes[i].split('=');vars[decodeURIComponent(hash[0])]=decodeURIComponent(hash[1]);}return vars;},init_ajax_uploader:function(){if(!jQuery('#mediamanager__uploader').length)return;if(jQuery('.qq-upload-list').length)return;var params=dw_mediamanager.form_params(jQuery('#dw__upload'))+'&call=mediaupload';params=dw_mediamanager.params_toarray(params);var uploader=new qq.FileUploaderExtended({element:document.getElementById('mediamanager__uploader'),action:DOKU_BASE+'lib/exe/ajax.php',params:params});},prepare_content:function($content){$content.find('div.example:visible').hide();},select:function(event){var $link,id,dot,ext;event.preventDefault();$link=jQuery(this);id=$link.attr('id').substr(2);if(!opener){jQuery(document.getElementById('ex_'+id.replace(/:/g,'_').replace(/^_/,''))).dw_toggle();return;}dw_mediamanager.ext=false;dot=id.lastIndexOf(".");if(-1===dot){dw_mediamanager.insert(id);return;}ext=id.substr(dot);if({'.jpg':1,'.jpeg':1,'.png':1,'.gif':1,'.swf':1}[ext]!==1){dw_mediamanager.insert(id);return;}var $sendbtn=jQuery('#media__sendbtn');$sendbtn.off().click(bind(dw_mediamanager.insert,id));dw_mediamanager.unforbid('ext');if(ext==='.swf'){dw_mediamanager.ext='swf';dw_mediamanager.forbid('ext',{link:['1','2'],size:['4']});}else{dw_mediamanager.ext='img';}dw_mediamanager.setOpt('link');dw_mediamanager.setOpt('align');dw_mediamanager.setOpt('size');jQuery('#media__linkbtn1, #media__linkbtn2, #media__sizebtn4').toggle(dw_mediamanager.ext==='img');dw_mediamanager.$popup.dialog('open');$sendbtn.focus();},confirmattach:function(e){if(!confirm(LANG.del_confirm+"\n"+jQuery(this).attr('title'))){e.preventDefault();}},attachoptions:function(){var $obj,opts;$obj=jQuery('#media__opts');if($obj.length===0){return;}opts=[];if(opener){opts.push(['keepopen','keepopen']);}opts.push(['hide','hidedetails']);jQuery.each(opts,function(_,opt){var $box,$lbl;$box=jQuery(document.createElement('input')).attr('type','checkbox').attr('id','media__'+opt[0]).click(bind(dw_mediamanager.toggleOption,opt[0]));if(DokuCookie.getValue(opt[0])){$box.prop('checked',true);dw_mediamanager[opt[0]]=true;}$lbl=jQuery(document.createElement('label')).attr('for','media__'+opt[0]).text(LANG[opt[1]]);$obj.append($box,$lbl,document.createElement('br'));});dw_mediamanager.updatehide();},toggleOption:function(variable){if(jQuery(this).prop('checked')){DokuCookie.setValue(variable,1);dw_mediamanager[variable]=true;}else{DokuCookie.setValue(variable,'');dw_mediamanager[variable]=false;}if(variable==='hide'){dw_mediamanager.updatehide();}},updatehide:function(){jQuery('#media__content').find('div.detail').dw_toggle(!dw_mediamanager.hide);},setOpt:function(opt,e){var val,i;if(typeof e!=='undefined'){val=this.id.substring(this.id.length-1);}else{val=dw_mediamanager.getOpt(opt);}if(val===false){DokuCookie.setValue(opt,'');dw_mediamanager[opt]=false;return;}if(opt==='link'){if(val!=='4'&&dw_mediamanager.link==='4'){dw_mediamanager.unforbid('linkonly');dw_mediamanager.setOpt('align');dw_mediamanager.setOpt('size');}else if(val==='4'){dw_mediamanager.forbid('linkonly',{align:false,size:false});}jQuery("#media__size, #media__align").dw_toggle(val!=='4');}DokuCookie.setValue(opt,val);dw_mediamanager[opt]=val;for(i=1;i<=4;i++){jQuery("#media__"+opt+"btn"+i).removeClass('selected');}jQuery('#media__'+opt+'btn'+val).addClass('selected');},unforbid:function(group){delete dw_mediamanager.forbidden_opts[group];},forbid:function(group,forbids){dw_mediamanager.forbidden_opts[group]=forbids;},allowedOpt:function(opt,val){var ret=true;jQuery.each(dw_mediamanager.forbidden_opts,function(_,forbids){ret=forbids[opt]!==false&&jQuery.inArray(val,forbids[opt])===-1;return ret;});return ret;},getOpt:function(opt){var allowed=bind(dw_mediamanager.allowedOpt,opt);if(dw_mediamanager[opt]!==false&&allowed(dw_mediamanager[opt])){return dw_mediamanager[opt];}if(DokuCookie.getValue(opt)&&allowed(DokuCookie.getValue(opt))){return DokuCookie.getValue(opt);}if(opt==='size'&&allowed('2')){return'2';}return jQuery.grep(['1','2','3','4'],allowed)[0]||false;}};function dw_mediamanager_item_select(edid,mediaid,opts,align,keepopen){var alignleft='';var alignright='';var cursorInImageTag=false;var textArea=jQuery('#'+edid)[0];var selection=DWgetSelection(textArea);selection.end=selection.end+2;var charsAfterCursor=selection.getText();if(charsAfterCursor==='}}'){cursorInImageTag=true;}if(align!=='1'){alignleft=align==='2'?'':' ';alignright=align==='4'?'':' ';}if(keepopen&&cursorInImageTag){selection.start=selection.start+2;DWsetSelection(selection);}insertTags(edid,'{{'+alignleft+mediaid+opts+alignright+'|','}}','');}jQuery(dw_mediamanager.init);function DEPRECATED(msg){if(!window.console)return;if(!msg)msg='';var func;if(arguments.callee)func=arguments.callee.caller.name;if(func)func=' '+func+'()';var line='DEPRECATED function call'+func+'. '+msg;if(console.warn){console.warn(line);}else{console.log(line);}if(console.trace)console.trace();}function DEPRECATED_WRAP(func,context){return function(){DEPRECATED();return func.apply(context||this,arguments);};}jQuery.fn.dw_hide=function(fn,noaria){if(!noaria)this.attr('aria-expanded','false');return this.slideUp('fast',fn);};jQuery.fn.dw_show=function(fn,noaria){if(!noaria)this.attr('aria-expanded','true');return this.slideDown('fast',fn);};jQuery.fn.dw_toggle=function(state,fn,noaria){return this.each(function(){var $this=jQuery(this);if(typeof state==='undefined'){state=$this.is(':hidden');}$this[state?"dw_show":"dw_hide"](fn,noaria);});};var dw_behaviour={init:function(){dw_behaviour.focusMarker();dw_behaviour.scrollToMarker();dw_behaviour.removeHighlightOnClick();dw_behaviour.quickSelect();dw_behaviour.checkWindowsShares();dw_behaviour.subscription();dw_behaviour.revisionBoxHandler();jQuery(document).on('click','#page__revisions input[type=checkbox]',dw_behaviour.revisionBoxHandler);jQuery('.bounce').effect('bounce',{times:10},2000);},scrollToMarker:function(){var $obj=jQuery('#scroll__here');if($obj.length){if($obj.offset().top!=0){jQuery('html, body').animate({scrollTop:$obj.offset().top-100},500);}else{$obj[0].scrollIntoView();}}},focusMarker:function(){jQuery('#focus__this').focus();},removeHighlightOnClick:function(){jQuery('span.search_hit').click(function(e){jQuery(e.target).removeClass('search_hit',1000);});},quickSelect:function(){jQuery('select.quickselect').change(function(e){e.target.form.submit();}).closest('form').find(':button').not('.show').hide();},checkWindowsShares:function(){if(!LANG.nosmblinks||navigator.userAgent.match(/(Trident|MSIE)/)){return;}jQuery('a.windows').on('click',function(){alert(LANG.nosmblinks.replace(/\\n/,"\n"));});},subscription:function(){var $form,$list,$digest;$form=jQuery('#subscribe__form');if(0===$form.length)return;$list=$form.find("input[name='sub_style'][value='list']");$digest=$form.find("input[name='sub_style'][value='digest']");$form.find("input[name='sub_target']").click(function(){var $this=jQuery(this),show_list;if(!$this.prop('checked')){return;}show_list=$this.val().match(/:$/);$list.parent().dw_toggle(show_list);if(!show_list&&$list.prop('checked')){$digest.prop('checked','checked');}}).filter(':checked').click();},revisionBoxHandler:function(){var $revisions=jQuery('#page__revisions');var $all=jQuery('input[type=checkbox]',$revisions);var $checked=$all.filter(':checked');var $button=jQuery('button',$revisions);if($checked.length<2){$all.removeAttr('disabled');$button.attr('disabled',true);}else{$all.attr('disabled',true);$button.removeAttr('disabled');$checked.each(function(i){jQuery(this).removeAttr('disabled');if(i>1){jQuery(this).attr('checked',false);}});}}};jQuery(dw_behaviour.init);dw_page={init:function(){dw_page.sectionHighlight();jQuery('a.fn_top').mouseover(dw_page.footnoteDisplay);dw_page.makeToggle('#dw__toc h3','#dw__toc > div');},sectionHighlight:function(){jQuery('form.btn_secedit').mouseover(function(){var $tgt=jQuery(this).parent(),nr=$tgt.attr('class').match(/(\s+|^)editbutton_(\d+)(\s+|$)/)[2],$highlight=jQuery(),$highlightWrap=jQuery('<div class="section_highlight"></div>');while($tgt.length>0&&!($tgt.hasClass('sectionedit'+nr)||$tgt.find('.sectionedit'+nr).length)){$tgt=$tgt.prev();$highlight=$highlight.add($tgt);}$highlight.filter(':last').before($highlightWrap);$highlight.detach().appendTo($highlightWrap);}).mouseout(function(){var $highlightWrap=jQuery('.section_highlight');$highlightWrap.before($highlightWrap.children().detach());$highlightWrap.detach();});},insituPopup:function(target,popup_id){var $fndiv=jQuery('#'+popup_id);if($fndiv.length===0){$fndiv=jQuery(document.createElement('div')).attr('id',popup_id).addClass('insitu-footnote JSpopup').attr('aria-hidden','true').mouseleave(function(){jQuery(this).hide().attr('aria-hidden','true');}).attr('role','tooltip');jQuery('.dokuwiki:first').append($fndiv);}$fndiv.show().position({my:'left top',at:'left center',of:target}).hide();return $fndiv;},footnoteDisplay:function(){var $content=jQuery(jQuery(this).attr('href')).parent().siblings('.content').clone();if(!$content){return;}jQuery('[id]',$content).each(function(){var id=jQuery(this).attr('id');jQuery(this).attr('id','insitu__'+id);});var content=$content.html().trim();dw_page.insituPopup(this,'insitu__fn').html(content).show().attr('aria-hidden','false');},makeToggle:function(handle,content,state){var $handle,$content,$clicky,$child,setClicky;$handle=jQuery(handle);if(!$handle.length)return;$content=jQuery(content);if(!$content.length)return;$child=$content.children();setClicky=function(hiding){if(hiding){$clicky.html('<span>+</span>');$handle.addClass('closed');$handle.removeClass('open');}else{$clicky.html('<span>−</span>');$handle.addClass('open');$handle.removeClass('closed');}};$handle[0].setState=function(state){var hidden;if(!state)state=1;$content.css('min-height',$content.height()).show();$child.stop(true,true);if(state===-1){hidden=false;}else if(state===1){hidden=true;}else{hidden=$child.is(':hidden');}setClicky(!hidden);$child.dw_toggle(hidden,function(){$content.toggle(hidden);$content.attr('aria-expanded',hidden);$content.css('min-height','');},true);};$clicky=jQuery(document.createElement('strong'));$handle.css('cursor','pointer').click($handle[0].setState).prepend($clicky);$handle[0].setState(state);}};jQuery(dw_page.init);jQuery(document).ready(function(){if(typeof JSINFO.bootstrap3==='undefined'){JSINFO.bootstrap3={};}function dw_mode(id){return((JSINFO.bootstrap3.mode===id)?true:false);}function dw_admin(page){return((JSINFO.bootstrap3.admin===page)?true:false);}function mediaSize(media){return jQuery(['#screen__mode .visible-',media,'-block'].join('')).is(':visible');}jQuery(window).resize(function(){jQuery(document).trigger('bootstrap3:mobile-layout');jQuery(document).trigger('bootstrap3:collapse-sections');jQuery(document).trigger('bootstrap3:toc-resize');});jQuery("#qsearch").typeahead({source:function(query,process){return jQuery.post(DOKU_BASE+'lib/exe/ajax.php',{call:'qsearch',q:encodeURI(query)},function(data){var results=[];jQuery(data).find('a').each(function(){var page=jQuery(this);results.push({name:page.text(),href:page.attr('href'),title:page.attr('title'),category:page.attr('title').replace(/:/g,' » '),});});return process(results);});},itemLink:function(item){return item.href;},itemTitle:function(item){return item.title;},followLinkOnSelect:true,autoSelect:false,items:50,fitToElement:true,delay:500,});jQuery.fn.extend({input2button:function(){return this.each(function(){var attrs={'type':'button'},label='',node=jQuery(this);if(typeof node.data('events')==='undefined'&&node.prop('tagName')=='INPUT'){jQuery(node[0].attributes).each(function(index,attribute){if(attribute.name=='value'){label=attribute.value;}else{attrs[attribute.name]=attribute.value;}});var newNode=jQuery('<button/>',attrs).html(label);node.replaceWith(newNode);}});}});jQuery(document).on('bootstrap3:init',function(event){setTimeout(function(){var $dw_content=jQuery('#dokuwiki__content, #media__manager');jQuery('abbr').tooltip();if(jQuery('#dw__pagetools').length){jQuery('ul.dropdown-menu li a[accesskey]').closest('.top, .revs, .show, .edit').removeAttr('accesskey');}$dw_content.find(':submit, :button, :reset').addClass('btn btn-default');jQuery('input, select, textarea').not('[type=submit], [type=reset], [type=button], [type=hidden], [type=image], [type=checkbox], [type=radio]').addClass('form-control');jQuery('input[type=checkbox]').addClass('checkbox-inline');jQuery('input[type=radio]').addClass('radio-inline');jQuery('label').addClass('control-label');jQuery('main form:not(.form-horizontal)').addClass('form-inline');jQuery('#tool__bar').addClass('btn-group btn-group-xs');jQuery('footer a').addClass('navbar-link');if(NS=='user'&&dw_mode('show')&&!jQuery('.notFound').length){jQuery('.mode_show #dokuwiki__content h1').prepend('<i class="fa fa-fw fa-user"/> ');}jQuery('#dw__toc a, #dw__toc_menu a, a.fn_top, a.fn_bot').on('click',function(e){var $link=jQuery(this);if($link.attr('href').match(/^#/)&&$link.attr('href').length>1){e.preventDefault();if(mediaSize('xs')&&$link.hasClass('fn_top')){return false;}if(JSINFO.bootstrap3.config.tocCollapseOnScroll&&JSINFO.bootstrap3.config.tocAffix){jQuery(document).trigger('bootstrap3:toc-close');}var $target=jQuery('body '+$link.attr('href'));if($target.length){var body_offset=(parseInt(jQuery('body').css('marginTop'))||0),target_position=Math.round($target.offset().top-body_offset);jQuery('html, body').animate({scrollTop:target_position},600);document.location.hash=$link.attr('href');}return false;}});},0);});jQuery(document).on('bootstrap3:nav',function(event){setTimeout(function(){jQuery('.nav div.li').contents().unwrap();var $links=jQuery('.nav li i + a');if($links.length){jQuery.each($links,function(){var $link=jQuery(this),$icon=$link.prev();$icon.prependTo($link);$icon.after(' ');});}},0);});jQuery(document).on('bootstrap3:tabs',function(event){setTimeout(function(){jQuery('ul.tabs').addClass('nav nav-tabs');jQuery('.nav-tabs strong').replaceWith(function(){jQuery(this).parent().addClass('active');return jQuery('<a href="#"/>').html(jQuery(this).contents());});},0);});jQuery(document).on('bootstrap3:buttons',function(event){setTimeout(function(){jQuery('.button').removeClass('button');jQuery('.alert button').removeClass('btn btn-default');jQuery('#dw__login, #dw__register, #subscribe__form, #media__manager').find(':submit').addClass('btn-success');jQuery('#dw__profiledelete').find(':submit').addClass('btn-danger');jQuery('#edbtn__save').addClass('btn-success');jQuery('.btn_secedit .btn').input2button();jQuery('.btn_secedit .btn').addClass('btn-xs');},0);});jQuery(document).on('bootstrap3:back-to-top',function(event){setTimeout(function(){jQuery('.back-to-top').click(function(e){e.preventDefault();jQuery('html, body').animate({scrollTop:0},600);});jQuery(window).scroll(function(){if(jQuery(this).scrollTop()){jQuery('.back-to-top').fadeIn();}else{jQuery('.back-to-top').fadeOut();}});},0);});jQuery(document).on('bootstrap3:fluid-container',function(event){jQuery('.btn-fluid-container').on('click',function(){var selectors='body > div, header, header nav > div, article, footer > div';if(!jQuery('.navbar-fixed-top').length){selectors='body > div, header, article, footer > div';}var $button=jQuery(this),$containers=jQuery(selectors);if(jQuery('body > div.container').length){$containers .removeClass('container').addClass('container-fluid');$button.parent().addClass('active');DokuCookie.setValue('fluidContainer',1);}else{$containers .removeClass('container-fluid').addClass('container');$button.parent().removeClass('active');DokuCookie.setValue('fluidContainer',0);}});});jQuery(document).on('bootstrap3:footnotes',function(event){if(!jQuery('.footnotes').length)return false;setTimeout(function(){jQuery(document).bind('DOMNodeInserted',function(){jQuery('#insitu__fn').addClass('panel panel-body panel-default');});},0);});jQuery(document).on('bootstrap3:toc-resize',function(event){var $dw_toc=jQuery('#dw__toc');if(!$dw_toc.length)return false;if(JSINFO.bootstrap3.config.tocAffix){$dw_toc.affix('checkPosition');}jQuery('#dw__toc .toc-body > ul').css({'max-height':(jQuery(window).height()-50-jQuery('main').position().top)+'px','overflow-y':'scroll'});jQuery('.toc-body').width(jQuery('.dw-toc').width());});jQuery(document).on('bootstrap3:toc-close',function(event){var $dw_toc=jQuery('#dw__toc');if(!$dw_toc.length)return false;if(!$dw_toc.hasClass('affix-bottom')){jQuery('.dw-content-page').addClass('dw-toc-closed');$dw_toc.find('.toc-body').collapse('hide');}});jQuery(document).on('bootstrap3:toc-open',function(event){var $dw_toc=jQuery('#dw__toc');if(!$dw_toc.length)return false;jQuery('.dw-content-page').removeClass('dw-toc-closed');$dw_toc.find('.toc-body').collapse('show');});jQuery(document).on('bootstrap3:toc-menu',function(event){if(!jQuery("#dw__toc_menu").length)return false;if(jQuery(JSINFO.bootstrap3.toc.length)){jQuery("#dw__toc_menu").removeClass("hide");}jQuery.each(JSINFO.bootstrap3.toc,function(idx,item){var indent="";if(item.level>1){for(var i=0;i<=item.level;i++){indent+="&nbsp;&nbsp;"}}jQuery("#dw__toc_menu ul").append(['<li><a class="small" href="',item.link,'">',indent,item.title,'</a></li>'].join(''));});});jQuery(document).on('bootstrap3:toc',function(event){setTimeout(function(){var $dw_toc=jQuery('#dw__toc');if(!$dw_toc.length)return false;if(JSINFO.bootstrap3.config.tocAffix){$dw_toc.affix({offset:{top:(jQuery("main").position().top),bottom:(jQuery(document).height()-jQuery("main").height()),}});}var scrollspy_target='#dw__toc';if(JSINFO.bootstrap3.config.tocLayout=='navbar'){scrollspy_target='#dw__navbar_items';}jQuery('body').scrollspy({target:scrollspy_target,offset:((parseInt(jQuery('body').css('marginTop'))||0)+10),});jQuery(document).trigger('bootstrap3:toc-resize');if(mediaSize('xs')){jQuery(document).trigger('bootstrap3:toc-close');}$dw_toc.css('backgroundColor',jQuery('article > .panel').css('backgroundColor'));$dw_toc.find('a').css('color',jQuery('body').css('color'));if(JSINFO.bootstrap3.config.tocCollapseOnScroll&&JSINFO.bootstrap3.config.tocAffix){$dw_toc.on('affix.bs.affix',function(){jQuery(document).trigger('bootstrap3:toc-close');});if(!JSINFO.bootstrap3.config.tocCollapsed){$dw_toc.on('affix-top.bs.affix',function(){jQuery(document).trigger('bootstrap3:toc-open');});}}$dw_toc.find('.toc-title').on('click',function(){jQuery('.dw-content-page').toggleClass('dw-toc-closed');if(jQuery('.dw-toc').hasClass('dw-toc-bootstrap')){if(jQuery('.dw-content-page').hasClass('dw-toc-closed')){jQuery('.dw-toc').removeClass('col-md-3');jQuery('.dw-content-page').removeClass('col-md-9').addClass('col-md-12');}else{jQuery('.dw-toc').addClass('col-md-3');jQuery('.dw-content-page').removeClass('col-md-12').addClass('col-md-9');jQuery(document).trigger('bootstrap3:toc-resize');}}if(!jQuery('.dw-toc-closed').length){jQuery(document).trigger('bootstrap3:toc-resize');}});if((jQuery(window).height()<$dw_toc.height())){jQuery(document).trigger('bootstrap3:toc-resize');}},0);});jQuery(document).on('bootstrap3:alerts',function(event){setTimeout(function(){jQuery('div.info').removeClass('info').addClass('alert alert-info').prepend('<i class="fa fa-fw fa-info-circle"/> ');jQuery('div.error').removeClass('error').addClass('alert alert-danger').prepend('<i class="fa fa-fw fa-times-circle"/> ');jQuery('div.success').removeClass('success').addClass('alert alert-success').prepend('<i class="fa fa-fw fa-check-circle"/> ');jQuery('div.notify').removeClass('notify').addClass('alert alert-warning').prepend('<i class="fa fa-fw fa-warning"/> ');},0);});jQuery(document).on('bootstrap3:media-manager',function(event){setTimeout(function(){var $media_popup=jQuery('#media__content'),$media_manager=jQuery('#mediamanager__page');if($media_popup.length||$media_manager.length){jQuery('.qq-upload-button').addClass('btn btn-default');jQuery('.qq-upload-action').addClass('btn btn-success');}if($media_manager.length){var $sort_buttons=jQuery('.ui-buttonset');$media_manager.find('.file dl').addClass('dl-horizontal');$media_manager.find('.panel').removeClass('panel').addClass('pull-left');$sort_buttons.addClass('btn-group');$sort_buttons.find('label').addClass('btn btn-xs btn-default');$sort_buttons.find('input').hide();function buttonHandler(){var $button=jQuery(this),option_for=$button.attr('for'),option_set=option_for.replace('sortBy__','').replace('listType__','');$sort_buttons.find('.active').removeClass('active');$button.addClass('active');$sort_buttons.find('#'+option_for).prop('checked',true);switch(option_set){case'thumbs':case'rows':dw_mediamanager.set_fileview_list(option_set);$sort_buttons.find('[name=list_dwmedia]').val(option_set);break;case'name':case'date':dw_mediamanager.set_fileview_sort(option_set);$sort_buttons.find('[name=sort_dwmedia]').val(option_set);dw_mediamanager.list.call(jQuery('#dw__mediasearch')[0]||this,event);break;}}$sort_buttons.find('label').on('click',buttonHandler);}},0);});jQuery(document).on('bootstrap3:detail',function(event){setTimeout(function(){var $detail_page=jQuery('#dokuwiki__detail');if(!$detail_page.length)return false;$detail_page.find('img.img_detail').addClass('img-responsive');$detail_page.find('dl').addClass('dl-horizontal');},0);});jQuery(document).on('bootstrap3:mode-index',function(event){if(!dw_mode('index'))return false;setTimeout(function(){var $directories=jQuery('ul.idx a.idx_dir'),$pages=jQuery('ul.idx a.wikilink1');jQuery.each($directories,function(){var $directory=jQuery(this),$closed=$directory.parents('.closed'),$open=$directory.parents('.open');if(!$directory.find('.fa').length){$directory.prepend('<i class="fa text-primary"/> ');}if($open.length){$directory.find('i').removeClass('fa-folder').addClass('fa-folder-open');}if($closed.length){$directory.find('i').removeClass('fa-folder-open').addClass('fa-folder');}});jQuery.each($pages,function(){var $page=jQuery(this);if(!$page.find('i').length){$page.prepend('<i class="fa fa-fw fa-file-text-o text-muted"/> ');}});},0);});jQuery(document).on('bootstrap3:page-tools',function(event){jQuery('#dw__pagetools .tools').affix({offset:{top:(jQuery('main').position().top),bottom:((jQuery(document).height()-jQuery('article').height()-jQuery('#dokuwiki__pageheader').height()-jQuery('#dokuwiki__header').height()))}});var $page_tools=jQuery('#dw__pagetools'),$page_tools_items=$page_tools.find('ul li a'),$animation=$page_tools.find('.tools-animation');if(!($page_tools_items.length&&$animation.length))return false;$page_tools_items.on('mouseenter',function(){var $icon=jQuery(this);$icon.find('i').addClass('fa-2x',250);});$page_tools_items.on('mouseleave',function(){var $icon=jQuery(this);$icon.find('i').removeClass('fa-2x',250);});});jQuery(document).on('bootstrap3:dropdown-page',function(event){jQuery('.dw__dropdown_page .dropdown').hover(function(){if(!jQuery('#screen_mode').find('.visible-xs').is(':visible')){jQuery(this).addClass('open');}},function(){if(!jQuery('#screen_mode').find('.visible-xs').is(':visible')){jQuery(this).removeClass('open');}});});jQuery(document).on('bootstrap3:cookie-law',function(event){jQuery('#cookieDismiss').click(function(){jQuery('#cookieNotice').hide();DokuCookie.setValue('cookieNoticeAccepted',true);});});jQuery(document).on('bootstrap3:anchorjs',function(event){anchors.add('.mode_show article .dw-content h1, .mode_show article '+'.dw-content h2, .mode_show article .dw-content h3, '+'.mode_show article .dw-content h4, .mode_show article '+'.dw-content h5');});jQuery(document).on('bootstrap3:page-icons',function(event){var $dw_page_icons=jQuery('.dw-page-icons');if(!$dw_page_icons.length)return false;var title=encodeURIComponent(document.title),url=encodeURIComponent(location),window_options='width=600,height=460,menubar=no,location=no,status=no';var share_to={'google-plus':(function(){return['https://plus.google.com/share?ur\l=',url].join('');})(),'twitter':(function(){return['https://twitter.com/intent/tweet?text=',title,'&url=',url].join('');})(),'linkedin':(function(){return['https://www.linkedin.com/shareArticle?mini=true&url=',url,'&title=',title].join('');})(),'facebook':(function(){return['https://www.facebook.com/sharer/sharer.php?u=',url,'&t=',title].join('');})(),'pinterest':(function(){return['https://pinterest.com/pin/create/button/?url=',url,'&description=',title].join('');})(),'telegram':(function(){return['https://telegram.me/share/url?url=',url].join('');})(),'whatsapp':(function(){return['whatsapp://send?text=',title,': ',url].join('');})(),'send-mail':(function(){return['mailto:?subject=',document.title,'&body=',document.URL].join('');})(),};$dw_page_icons.find('.share-google-plus').on('click',function(){window.open(share_to['google-plus'],'Share to Google+',window_options);});$dw_page_icons.find('.share-twitter').on('click',function(){window.open(share_to.twitter,'Share to Twitter',window_options);});$dw_page_icons.find('.share-linkedin').on('click',function(){window.open(share_to.linkedin,'Share to Linkedin',window_options);});$dw_page_icons.find('.share-facebook').on('click',function(){window.open(share_to.facebook,'Share to Facebook',window_options);});$dw_page_icons.find('.share-pinterest').on('click',function(){window.open(share_to.pinterest,'Share to Pinterest',window_options);});$dw_page_icons.find('.share-telegram').on('click',function(){window.open(share_to.telegram,'Share to Telegram',window_options);});$dw_page_icons.find('.send-mail').on('click',function(e){e.preventDefault();window.location=share_to['send-mail'];});$dw_page_icons.find('.share-whatsapp').attr('href',share_to.whatsapp);});jQuery(document).on('bootstrap3:collapse-sections',function(event){if(!JSINFO.bootstrap3.config.collapsibleSections)return false;setTimeout(function(){var $sections=jQuery('article div.level2'),$headings=$sections.prev();if(mediaSize('xs')){$sections.addClass('hide');if(!$headings.find('i').length){$headings .css('cursor','pointer').prepend(jQuery('<i class="fa fa-fw fa-chevron-down fa-pull-left" style="font-size:12px; padding:10px 0"/>'));$headings.on('click',function(){var $heading=jQuery(this),$icon=$heading.find('i'),$section=$heading.nextUntil('h2');$section.toggleClass('hide');$heading.css('cursor','pointer');$icon.hasClass('fa-chevron-down')?$icon.removeClass('fa-chevron-down').addClass('fa-chevron-up'):$icon.removeClass('fa-chevron-up').addClass('fa-chevron-down');});if(mediaSize('xs')){$headings.trigger('click');}}}else{if($sections.hasClass('hide')){$sections.removeClass('hide');}}},0);});jQuery(document).on('bootstrap3:mobile-layout',function(event){setTimeout(function(){var $dw_aside=jQuery('.dw__sidebar');if(!$dw_aside.length)return false;if(mediaSize('xs')){if(JSINFO.bootstrap3.config.sidebarOnNavbar){if(!jQuery('header aside').length){jQuery('<aside/>').prependTo('header nav div .navbar-collapse');$dw_aside.find('.dw-sidebar-content').clone().appendTo('header aside');jQuery('header aside .dw-sidebar-title').addClass('navbar-text');}jQuery('header aside').show();$dw_aside.hide();}else{if(!$dw_aside.find('.dw-sidebar-content').hasClass('panel')){$dw_aside.find('.dw-sidebar-content').addClass('panel panel-default');$dw_aside.find('.dw-sidebar-title').addClass('panel-heading');$dw_aside.find('.dw-sidebar-body').addClass('panel-body').removeClass('in');}}}else{jQuery('header aside').hide();$dw_aside.find('.dw-sidebar-content').removeClass('panel panel-default');$dw_aside.find('.dw-sidebar-title').removeClass('panel-heading');$dw_aside.find('.dw-sidebar-body').removeClass('panel-body').addClass('in');$dw_aside.show();}},0);});jQuery(document).on('bootstrap3:components',function(event){setTimeout(function(){var events=['mobile-layout','fluid-container','toc','tabs','toc-menu','nav','back-to-top','page-tools','page-icons','dropdown-page','footnotes','media-manager','collapse-sections',];for(var i in events){jQuery(document).trigger('bootstrap3:'+events[i]);}},0);});jQuery(document).trigger('bootstrap3:init');jQuery(document).trigger('bootstrap3:components');jQuery(document).on('bootstrap3:plugins',function(event){setTimeout(function(){var $csv=jQuery('table tbody tr.row0 th.col0');if($csv.length){$csv.each(function(){var $table=jQuery(this).parents('table');if($table.find('tr.row1 th').length==0){$table.prepend('<thead/>');$header=$table.find('tr.row0');$table.find('thead').append($header);}});}var $dataplugin_entry=jQuery('.dataplugin_entry'),$dataplugin_table=jQuery('.dataplugin_table');if($dataplugin_entry.length){$dataplugin_entry.find('dl').addClass('panel panel-default');}if($dataplugin_table.length){$dataplugin_table.find('input').addClass('input-sm');var $header=$dataplugin_table.find('th[style]'),$inputs=$dataplugin_table.find('th input'),header_width=[],i=0;$header.each(function(){header_width.push(this.style.width);});$inputs.each(function(){this.style.width=header_width[i];i++;});}var $database2=jQuery('table.database2, table.database2-single-editor');if($database2.length){$database2.find('.label').removeClass('label').addClass('database2-label');$database2.find('input[type="submit"]:first').addClass('btn-success');}var $datatables=jQuery('.dt-wrapper');if($datatables.length){$datatables.find('.table-responsive').removeClass('table-responsive');}var $davcal=jQuery('#fullCalendar');if($davcal.length){$davcal.find('.fc-button-group').addClass('btn-group');}var $discussion=jQuery('.comment_wrapper');if($discussion.length){$discussion.find('h2').addClass('page-header');$discussion.find('.comment_buttons').addClass('text-right');$discussion.find('#discussion__section').prepend('<i class="fa fa-fw fa-comments"/> ');$discussion.find('.hentry').addClass('panel panel-default');$discussion.find('.hentry .comment_head').addClass('panel-heading');$discussion.find('.hentry .comment_body').addClass('panel-body');$discussion.find('.toolbar').addClass('btn-group');$discussion.find('.comment_buttons [type=submit]').addClass('btn-xs');$discussion.find('.comment_buttons .discussion__delete .btn').addClass('btn-danger');$discussion.find('.comment_buttons .discussion__reply .btn').addClass('btn-success');$discussion.find('#discussion__btn_submit').addClass('btn-success');jQuery(document).bind('DOMNodeInserted',function(){$discussion.find('.toolbutton').addClass('btn btn-xs');});}var $explain=jQuery('.explain');if($explain.length){$explain.each(function(){var $self=jQuery(this),$tooltip=$self.find('.tooltip');$self.attr({'data-toggle':'tooltip','data-placement':'bottom','title':$tooltip.html(),}).addClass('wikilink1').removeClass('explain');$tooltip.remove();});jQuery('[data-toggle="tooltip"]').tooltip();}if(dw_mode('media')){jQuery(document).ajaxSuccess(function(){jQuery('.mode_media .meta .row').removeClass('row');});}var $include_readmore=jQuery('.include_readmore');if($include_readmore.length){$include_readmore.find('a').addClass('btn btn-default btn-xs');}var $toc=jQuery('#dw__toc, #dokuwiki__toc'),$toc2=jQuery('div.inlinetoc2');if($toc2.length&&$toc.length){$toc.css('display','none');$toc2.addClass('panel panel-default');}var $overlay=jQuery('#overlay');if($overlay.length){$overlay.addClass('panel panel-default small');$overlay.css('border',jQuery('.panel').css('border'));$overlay.css('background',jQuery('.panel').css('background'));var $title=$overlay.find('.close'),$btn=$title.find('a');$btn.wrapAll('<ul class="text-right list-inline dw-action-icon" />');$btn.wrap('<li/>');$btn.addClass('text-muted');$title.nextAll().wrapAll('<div class="panel-body" />');$title.removeClass('close').addClass('panel-heading');}var $publish=jQuery('.approval');if($publish.length){$publish.prependTo('.page');$publish.removeClass('approval').addClass('alert');jQuery('.apr_table').removeClass('table-striped');if($publish.hasClass('approved_no')){$publish.removeClass('approved_no').addClass('alert-warning').prepend('<i class="fa fa-fw fa-info-circle"/> ');}if($publish.hasClass('approved_yes')){$publish.removeClass('approved_yes').addClass('alert-success').prepend('<i class="fa fa-fw fa-check-circle"/> ');}}var $wikilinks=jQuery('article .wikilink1');if(typeof JSINFO.plugin==='undefined'){JSINFO.plugin={};}if(typeof JSINFO.plugin.semantic==='undefined'){JSINFO.plugin.semantic={};}if($wikilinks.length&&JSINFO.plugin.semantic.exposeWebService&&JSINFO.bootstrap3.config.showSemanticPopup){$wikilinks.hover(function(){$wikilinks.popover('destroy');var $wikilink=jQuery(this),page_id=$wikilink.attr('title');if($wikilink.parents('.bs-wrap-nav').length){return false;}if(!page_id)return false;jQuery.post(DOKU_BASE+'lib/exe/ajax.php',{call:'plugin_semantic',id:page_id},function(data){var jsonld=data[0];if(!(jsonld.headline&&jsonld.description))return false;$wikilink.data('original-title',page_id);$wikilink.attr('title','');var title=jsonld.headline;var image=('image'in jsonld)?['<img src="',jsonld.image.url,'" alt="" class="img-responsive" /><br/>'].join(''):'';var description=jQuery.trim(jsonld.description.replace(/\t\*$/,'')).replace(/\*(.*)/g,'<i class="fa fa-circle small"></i> $1').replace(/\n/g,"<br/>\n").replace(/\t/g,'&nbsp;');var content=['<div class="row small"><div class="col-md-12">',image,description,' ... </div></div>'].join('');$wikilink.popover({trigger:'manual',html:true,title:title,content:content,placement:'auto left',}).popover('show');$wikilink.attr('title',page_id);});},function(){var self=this;setTimeout(function(){if(jQuery(self).next('.popover').length&&!jQuery(self).next('.popover:hover').length){jQuery(self).popover('destroy');}},300);});}var $simplenavi=jQuery('.plugin__simplenavi');if($simplenavi.length){$simplenavi.find('li.open strong').contents().unwrap();$simplenavi.find('li.closed a').prepend('<i class="fa fa-fw fa-folder"/> ');$simplenavi.find('li.open > a').prepend('<i class="fa fa-fw fa-folder-open"/> ');$simplenavi.find('li').not('.closed').not('.open').find('a').prepend('<i class="fa fa-fw fa-file-text-o text-muted"/> ');}if(dw_admin('struct_schemas')||dw_admin('struct_assignments')){jQuery('.toc-body .toc').addClass('show');}var $tags=jQuery('.tags'),$page=jQuery('table tbody th.page:even');if($page.length){$page.each(function(){var $table=jQuery(this).parents('table'),$header=$table.find('th');$table.prepend('<thead><tr/></thead>');$table.find('thead tr').append($header);$header.removeClass('page');});}if($tags.length){$tags.each(function(){var $tag=jQuery(this);$tag.html($tag.html().replace(/,/g,''));var $tagLabel=$tag.find('a').addClass('label label-default').prepend('<i class="fa fa-fw fa-tag"/> ');if(JSINFO.bootstrap3.config.tagsOnTop&&$tag.prop('tagName').toLowerCase()=='div'&&!$tag.parents('.plugin_include_content').length){$tag.remove();$tagLabel.prependTo('.pageId');}if($tag.parents('.plugin_include_content').length){$tag.find('span').contents().unwrap();}});}var $tagging_edit=jQuery('.plugin_tagging_edit');if($tagging_edit.length){$tagging_edit.find(':submit').addClass('btn btn-default btn-xs');$tagging_edit.find('[type=text]').addClass('input-sm');$tagging_edit.find('#tagging__edit_save').addClass('btn-success');}var $translation=jQuery('#dw__translation');if($translation.length){var $current=$translation.find('.cur'),$lang=$current.text(),$iso=$lang.match(/\(([a-z]*)\)/),$flag=$current.find('img');$current.parent().addClass('active');$translation.find('.wikilink2').removeClass('wikilink2').css('opacity','0.5');if($flag.length){$translation.find('.dropdown-toggle i').hide();$translation.find('.dropdown-toggle').prepend(jQuery('<img/>').attr({'src':$flag.attr('src'),'title':$flag.attr('title')}));}}var $wrap=jQuery('.plugin_wrap');if($wrap.length){if($wrap.hasClass('tabs')){var $tabs=jQuery('.plugin_wrap.tabs');$tabs.find('div.li').contents().unwrap();$tabs.find('.curid').parent().addClass('active');$tabs.find('ul').addClass('nav nav-tabs');}}},0);});jQuery(document).trigger('bootstrap3:plugins');if(dw_mode('media')||jQuery('#media__manager')){jQuery(document).ajaxSuccess(function(){jQuery(document).trigger('bootstrap3:init');jQuery(document).trigger('bootstrap3:buttons');jQuery(document).trigger('bootstrap3:tabs');jQuery(document).trigger('bootstrap3:media-manager');jQuery(document).trigger('bootstrap3:alerts')});}if(JSINFO.bootstrap3.config.useAnchorJS){jQuery(document).trigger('bootstrap3:anchorjs');}if(JSINFO.bootstrap3.config.fixedTopNavbar){var scrollOnHashChange=function(){scrollBy(0,-(parseInt(jQuery('body').css('marginTop'))||0));};if(location.hash){setTimeout(function(){scrollOnHashChange();},1);}jQuery(window).on('hashchange',function(){scrollOnHashChange();});}if(dw_mode('index')){jQuery(document).trigger('bootstrap3:mode-index');jQuery(document).ajaxSuccess(function(){jQuery(document).trigger('bootstrap3:mode-index');});jQuery('#index__tree').click(function(e){jQuery(document).trigger('bootstrap3:mode-index');});}});var dw_acl={init:function(){var $tree;if(jQuery('#acl_manager').length===0){return;}jQuery('#acl__user select').change(dw_acl.userselhandler);jQuery('#acl__user button').click(dw_acl.loadinfo);$tree=jQuery('#acl__tree');$tree.dw_tree({toggle_selector:'img',load_data:function(show_sublist,$clicky){var $frm=jQuery('#acl__detail form');jQuery.post(DOKU_BASE+'lib/exe/ajax.php',jQuery.extend(dw_acl.parseatt($clicky.parent().find('a')[0].search),{call:'plugin_acl',ajax:'tree',current_ns:$frm.find('input[name=ns]').val(),current_id:$frm.find('input[name=id]').val()}),show_sublist,'html');},toggle_display:function($clicky,opening){$clicky.attr('src',DOKU_BASE+'lib/images/'+(opening?'minus':'plus')+'.gif');}});$tree.delegate('a','click',dw_acl.treehandler);},userselhandler:function(){jQuery('#acl__user input').toggle(this.value==='__g__'||this.value==='__u__');dw_acl.loadinfo();},loadinfo:function(){jQuery('#acl__info').attr('role','alert').html('<img src="'+DOKU_BASE+'lib/images/throbber.gif" alt="..." />').load(DOKU_BASE+'lib/exe/ajax.php',jQuery('#acl__detail form').serialize()+'&call=plugin_acl&ajax=info');return false;},parseatt:function(str){if(str[0]==='?'){str=str.substr(1);}var attributes={};var all=str.split('&');for(var i=0;i<all.length;i++){var att=all[i].split('=');attributes[att[0]]=decodeURIComponent(att[1]);}return attributes;},treehandler:function(){var $link,$frm;$link=jQuery(this);jQuery('#acl__tree a.cur').removeClass('cur');$link.addClass('cur');$frm=jQuery('#acl__detail form');if($link.hasClass('wikilink1')){$frm.find('input[name=ns]').val('');$frm.find('input[name=id]').val(dw_acl.parseatt($link[0].search).id);}else if($link.hasClass('idx_dir')){$frm.find('input[name=ns]').val(dw_acl.parseatt($link[0].search).ns);$frm.find('input[name=id]').val('');}dw_acl.loadinfo();return false;}};jQuery(dw_acl.init);var _OPEN_ITEMS=[];var _COOKIE_NAME="plugin_acmenu_open_items";function get_cookie(){var all_cookies=document.cookie.split(";");for(var i=0;i<all_cookies.length;i++){if(all_cookies[i].indexOf(_COOKIE_NAME+"=")>-1){var cookie=all_cookies[i].trim();var items=cookie.substring((_COOKIE_NAME+"=").length,cookie.length);var items=JSON.parse(items);var items=items.toString().split(",");for(var j=0;j<items.length;j++){_OPEN_ITEMS.push(items[j]);}}}}function set_cookie(){for(var i in JSINFO["plugin_acmenu"]["sub_ns"]){sub_start=[JSINFO["plugin_acmenu"]["sub_ns"][i],JSINFO["plugin_acmenu"]["start"]].filter(Boolean).join(":");if(_OPEN_ITEMS.indexOf(sub_start)==-1){_OPEN_ITEMS.push(sub_start);}}var cookie_value=JSON.stringify(_OPEN_ITEMS);document.cookie=_COOKIE_NAME+"="+cookie_value+";expires='';path=/";}function trim_url(url){if(JSINFO["plugin_acmenu"]["canonical"]){xlink=JSINFO["plugin_acmenu"]["doku_url"];}else{xlink=JSINFO["plugin_acmenu"]["doku_base"];}if(JSINFO["plugin_acmenu"]["userewrite"]==2){xlink+=JSINFO["plugin_acmenu"]["doku_script"]+"/";}else if(JSINFO["plugin_acmenu"]["userewrite"]==1){}else{xlink+=JSINFO["plugin_acmenu"]["doku_script"]+"?id=";}var trimmed_url=url.replace(xlink,"");if(JSINFO["plugin_acmenu"]["useslash"]==1){const slash=/\//g;var trimmed_url=trimmed_url.replace(slash,":");}return trimmed_url;}jQuery(document).ready(function(){const selector="div.acmenu ul.idx > li:not([class^='level']) > div.li";get_cookie();set_cookie();jQuery(selector).click(function(event){var item=trim_url(jQuery(this).find("a").attr("href"));event.preventDefault();if(jQuery(this).next().is(":visible")==false){jQuery(this).next().slideDown("fast").parent().removeClass("closed").addClass("open");_OPEN_ITEMS.push(item);}else{jQuery(this).next().slideUp("fast").parent().removeClass("open").addClass("closed");_OPEN_ITEMS.splice(jQuery.inArray(item,_OPEN_ITEMS),1);}var cookie_value=JSON.stringify(_OPEN_ITEMS);document.cookie=_COOKIE_NAME+"="+cookie_value+";expires='';path=/";});});jQuery(document).ready(function(){setTimeout(function(){jQuery('.bs-wrap .fix-media-list-overlap').removeClass('fix-media-list-overlap');jQuery('.bs-wrap-jumbotron .page-header').removeClass('page-header');jQuery('.bs-wrap-tooltip').tooltip();jQuery('.bs-wrap-popover').popover();jQuery('.bs-wrap-image').each(function(){var $img_wrap=jQuery(this),img_data=$img_wrap.data();$img_wrap.find('img').addClass(['img-',img_data.imgShape].join(''));});jQuery('.bs-wrap-nav').each(function(){var $nav_wrap=jQuery(this),nav_data=$nav_wrap.data(),nav_class=['nav'];for(key in nav_data){var value=nav_data[key];switch(key){case'navType':nav_class.push(['nav-',value].join(''));break;case'navStacked':if(value)nav_class.push('nav-stacked');break;case'navJustified':if(value)nav_class.push('nav-justified');break;}}$nav_wrap.find('ul:first').addClass(nav_class.join(' '));var $nav=$nav_wrap.find('.nav');$nav.find('div.li *').unwrap();$nav.find('li').attr('role','presentation');$nav.find('.curid').parent('li').addClass('active');$nav.find('li ul').addClass('dropdown-menu').parent('li').addClass('dropdown');$nav.find('.dropdown div.li').replaceWith(function(){return jQuery('<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" />').html(jQuery(this).contents())});$nav.find('li.dropdown').contents().filter(function(){return this.nodeType===3&&this.data.trim().length>0}).wrap('<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" />');$nav.find('.dropdown-toggle').append(' <span class="caret"/>');if($nav_wrap.find('.tab-pane').length){if(!$nav_wrap.find('.tab-content').length){$nav_wrap.find('.tab-pane').wrapAll(jQuery('<div class="tab-content"/>'));}$nav.find('a').attr('data-toggle','tab').attr('role','tab');if(nav_data.navFade){$nav_wrap.find('.tab-content .tab-pane').addClass('fade');}$nav.find('a:first').tab('show');}jQuery(window).on('hashchange',function(){jQuery('.bs-wrap-nav .nav a[href="'+location.hash+'"]').tab('show');});});jQuery('.bs-wrap-button').each(function(){var $btn_wrap=jQuery(this),btn_data=$btn_wrap.data(),$btn_link=$btn_wrap.find('a'),btn_class=['btn'];if(!$btn_link.length){btn_label=$btn_wrap.html();$btn_wrap.html('');$btn_link=jQuery('<a href="javascript:void(0)"/>').html(btn_label);jQuery(this).append($btn_link);}for(key in btn_data){var value=btn_data[key];switch(key){case'btnType':case'btnSize':btn_class.push(['btn-',value].join(''));break;case'btnBlock':btn_class.push('btn-block');break;case'btnDisabled':btn_class.push('disabled');break;case'btnCollapse':$btn_link.attr('data-toggle','collapse');$btn_link.attr('data-target','#'+value);$btn_link.on('click',function(e){e.preventDefault();});break;case'btnModal':$btn_link.attr('data-toggle','modal');$btn_link.attr('data-target','#'+value);$btn_link.on('click',function(e){e.preventDefault();});break;case'btnIcon':var icon=['<i class="',value,'"/> '].join('');$btn_link.prepend(icon);break;}}$btn_link.addClass(btn_class.join(' '));$btn_link.attr('role','button');if($btn_link.hasClass('curid')){$btn_link.addClass('active');}if($btn_link.hasClass('urlextern')){$btn_link.removeClass('urlextern').addClass('wikilink1');}});jQuery('.bs-wrap-list-group').each(function(){var $list_wrap=jQuery(this);var $icon_links=$list_wrap.find('li i + a');if($icon_links.length){jQuery.each($icon_links,function(){var $link=jQuery(this),$icon=$link.prev();$icon.prependTo($link);$icon.after(' ');});}$list_wrap.find('div.li').contents().unwrap();$list_wrap.find('ul').addClass('list-group');$list_wrap.find('ul > li').addClass('list-group-item');if($list_wrap.find('a').length){$list_wrap.find('a').parent().each(function(){var $list=jQuery(this);if($list.children().length>1){$list.wrapInner('<p class="list-group-item-text"/>');var $link=$list.find('a');$link.wrapInner('<h4 class="list-group-item-heading"/>');$link.prependTo($list);$list.find('p').appendTo($link);}});$list_wrap.find('a').parent().contents().unwrap();$list_wrap.find('ul a').parent().contents().unwrap();$list_wrap.addClass('list-group');$list_wrap.find('a').addClass('list-group-item');$list_wrap.find('a.curid').removeClass('curid').addClass('active');}$list_wrap.removeClass('hide');});jQuery('.bs-wrap-accordion').each(function(){var $accordion=jQuery(this),accordion_id=Math.random().toString(36).substr(2,9),is_collapsed=$accordion.hasClass('bs-wrap-accordion-collapsed');$accordion.find('.panel').each(function(){var $panel=jQuery(this),panel_id=accordion_id+'_'+Math.random().toString(36).substr(2,9);$panel.find('.panel-heading').wrapInner('<a role="button" data-toggle="collapse" data-parent="#'+accordion_id+'" href="#'+panel_id+'">');$panel.find('.panel-body').wrap('<div id="'+panel_id+'" class="panel-collapse collapse" role="tabpanel">');});$accordion.attr('id',accordion_id);if($accordion.find('.panel-collapse').length>1&&!is_collapsed){$accordion.find('.panel-collapse').first().addClass('in');}});jQuery('.bs-wrap-carousel').each(function(){var $carousel=jQuery(this),carousel_id=Math.random().toString(36).substr(2,9),$images=$carousel.find('img'),$slides=$carousel.find('.bs-wrap-slide'),$caption=$carousel.find('.bs-wrap-caption'),$indicators=$carousel.find('ol');$carousel.attr('id',carousel_id);$images.removeClass('media').removeClass('medialeft').removeClass('mediaright').removeClass('mediacenter');if(!$slides.length){$images.wrap('<div class="item"/>');}if($caption.length){$caption.removeClass('caption').addClass('carousel-caption');}$carousel.find('.carousel-control').attr('href','#'+carousel_id);for(var i=0;i<$images.length;i++){$indicators.append('<li data-target="#'+carousel_id+'" data-slide-to="'+i+'"></li>');}$carousel.find('.item').first().addClass('active');$indicators.find('li').first().addClass('active');});jQuery('.bs-wrap-panel').each(function(){var $panel=jQuery(this),$panel_body=$panel.find('.panel-body'),$panel_heading=$panel.find('.panel-heading'),$first_title=$panel_body.find('> h4:first');if($first_title.length&&!$panel_heading.length){var $panel_heading=jQuery('<div class="panel-heading"></div>');$first_title.addClass('panel-title');$panel_heading.append($first_title);$panel.prepend($panel_heading);}});jQuery('.bs-wrap-modal').each(function(){if(jQuery(this).attr('data-show')==true){jQuery(this).modal('show');}else{jQuery(this).modal('hide');}});},0);});function isBlank(s){if((s===null)||(s.length===0)){return true;}for(var i=0;i<s.length;i++){var c=s.charAt(i);if((c!=' ')&&(c!='\n')&&(c!='\t')){return false;}}return true;}function validate(form){if(!form)return;if(isBlank(form.name.value)){form.name.focus();form.name.style.backgroundColor='#fcc';return false;}else{form.name.style.backgroundColor='#fff';}if(isBlank(form.mail.value)||form.mail.value.indexOf("@")==-1){form.mail.focus();form.mail.style.backgroundColor='#fcc';return false;}else{form.mail.style.backgroundColor='#fff';}if(isBlank(form.text.value)){form.text.focus();form.text.style.borderColor='#fcc';return false;}}function discussion_ajax_preview(){var $textarea=jQuery('#discussion__comment_text');var comment=$textarea.val();var $preview=jQuery('#discussion__comment_preview');if(!comment){$preview.hide();return;}$preview.html('<img src="'+DOKU_BASE+'lib/images/throbber.gif" />');$preview.show();jQuery.post(DOKU_BASE+'lib/exe/ajax.php',{'call':'discussion_preview','comment':comment},function(data){if(data===''){$preview.hide();return;}$preview.html(data);$preview.show();$preview.css('visibility','visible');$preview.css('display','inline');},'html');}jQuery(function(){if(typeof window.initToolbar=='function'){initToolbar("discussion__comment_toolbar","discussion__comment_text",toolbar);}jQuery('#discussion__btn_preview').click(discussion_ajax_preview);jQuery('#discussion__comment_form').submit(function(){return validate(this);});jQuery('#discussion__btn_toggle_visibility').click(function(){jQuery('#comment_wrapper').toggle();});});jQuery(function(){var $extmgr=jQuery('#extension__manager');$extmgr.find('button.uninstall').click(function(e){if(!window.confirm(LANG.plugins.extension.reallydel)){e.preventDefault();return false;}return true;});$extmgr.find('a.extension_screenshot').click(function(e){e.preventDefault();var image_href=jQuery(this).attr("href");var $lightbox=jQuery('#plugin__extensionlightbox');if(!$lightbox.length){$lightbox=jQuery('<div id="plugin__extensionlightbox"><p>Click to close</p><div></div></div>').appendTo(jQuery('body')).hide().click(function(){$lightbox.hide();});}$lightbox .show().find('div').html('<img src="'+image_href+'" />');return false;});$extmgr.find('button.disable, button.enable').click(function(e){e.preventDefault();var $btn=jQuery(this);var extension=$btn.attr('name').split('[')[2];extension=extension.substr(0,extension.length-1);var act=($btn.hasClass('disable'))?'disable':'enable';$btn.attr('disabled','disabled');$btn.css('cursor','wait');jQuery.get(DOKU_BASE+'lib/exe/ajax.php',{call:'plugin_extension',ext:extension,act:act},function(data){$btn.css('cursor','').removeAttr('disabled').removeClass('disable').removeClass('enable').text(data.label).addClass(data.reverse).parents('li').removeClass('disabled').removeClass('enabled').addClass(data.state);});});$extmgr.find('a.info').click(function(e){e.preventDefault();var $link=jQuery(this);var $details=$link.parent().find('dl.details');if($details.length){$link.toggleClass('close');$details.toggle();return;}$link.addClass('close');jQuery.get(DOKU_BASE+'lib/exe/ajax.php',{call:'plugin_extension',ext:$link.data('extid'),act:'info'},function(data){$link.parent().append(data);});});if($extmgr.find('.plugins, .templates').hasClass('active')){var $extlist=jQuery('#extension__list');$extlist.addClass('hasDisplayOptions');var $displayOpts=jQuery('<p>',{id:'extension__viewoptions'}).appendTo($extmgr.find('.panelHeader'));$displayOpts.append(LANG.plugins.extension.display_viewoptions);var displayOptionsHandler=function(){$extlist.toggleClass(this.name);DokuCookie.setValue('ext_'+this.name,$extlist.hasClass(this.name)?'1':'0');};jQuery(['enabled','disabled','updatable']).each(function(index,chkName){var $label=jQuery('<label></label>').appendTo($displayOpts);var $input=jQuery('<input />',{type:'checkbox',name:chkName}).change(displayOptionsHandler).appendTo($label);var previous=DokuCookie.getValue('ext_'+chkName);if(typeof previous==="undefined"||previous=='1'){$input.click();}jQuery('<span/>').append(' '+LANG.plugins.extension['display_'+chkName]).appendTo($label);});}});;(function(window,undefined){var document=window.document;document.createElement("video");document.createElement("audio");var VideoJS=function(id,addOptions,ready){var tag;if(typeof id=="string"){if(id.indexOf("#")===0){id=id.slice(1);}if(_V_.players[id]){return _V_.players[id];}else{tag=_V_.el(id)}}else{tag=id;}if(!tag||!tag.nodeName){throw new TypeError("The element or ID supplied is not valid. (VideoJS)");}return tag.player||new _V_.Player(tag,addOptions,ready);},_V_=VideoJS,CDN_VERSION="3.2";VideoJS.players={};VideoJS.options={techOrder:["html5","flash"],html5:{},flash:{swf:"http://vjs.zencdn.net/c/video-js.swf"},width:"auto",height:"auto",defaultVolume:0.00,components:{"posterImage":{},"textTrackDisplay":{},"loadingSpinner":{},"bigPlayButton":{},"controlBar":{}}};if(CDN_VERSION!="GENERATED_CDN_VSN"){_V_.options.flash.swf="http://vjs.zencdn.net/"+CDN_VERSION+"/video-js.swf"}_V_.merge=function(obj1,obj2,safe){if(!obj2){obj2={};};for(var attrname in obj2){if(obj2.hasOwnProperty(attrname)&&(!safe||!obj1.hasOwnProperty(attrname))){obj1[attrname]=obj2[attrname];}}return obj1;};_V_.extend=function(obj){this.merge(this,obj,true);};_V_.extend({tech:{},controlSets:{},isIE:function(){return!+"\v1";},isFF:function(){return!!_V_.ua.match("Firefox")},isIPad:function(){return navigator.userAgent.match(/iPad/i)!==null;},isIPhone:function(){return navigator.userAgent.match(/iPhone/i)!==null;},isIOS:function(){return VideoJS.isIPhone()||VideoJS.isIPad();},iOSVersion:function(){var match=navigator.userAgent.match(/OS (\d+)_/i);if(match&&match[1]){return match[1];}},isAndroid:function(){return navigator.userAgent.match(/Android.*AppleWebKit/i)!==null;},androidVersion:function(){var match=navigator.userAgent.match(/Android (\d+)\./i);if(match&&match[1]){return match[1];}},testVid:document.createElement("video"),ua:navigator.userAgent,support:{},each:function(arr,fn){if(!arr||arr.length===0){return;}for(var i=0,j=arr.length;i<j;i++){fn.call(this,arr[i],i);}},eachProp:function(obj,fn){if(!obj){return;}for(var name in obj){if(obj.hasOwnProperty(name)){fn.call(this,name,obj[name]);}}},el:function(id){return document.getElementById(id);},createElement:function(tagName,attributes){var el=document.createElement(tagName),attrname;for(attrname in attributes){if(attributes.hasOwnProperty(attrname)){if(attrname.indexOf("-")!==-1){el.setAttribute(attrname,attributes[attrname]);}else{el[attrname]=attributes[attrname];}}}return el;},insertFirst:function(node,parent){if(parent.firstChild){parent.insertBefore(node,parent.firstChild);}else{parent.appendChild(node);}},addClass:function(element,classToAdd){if((" "+element.className+" ").indexOf(" "+classToAdd+" ")==-1){element.className=element.className===""?classToAdd:element.className+" "+classToAdd;}},removeClass:function(element,classToRemove){if(element.className.indexOf(classToRemove)==-1){return;}var classNames=element.className.split(" ");classNames.splice(classNames.indexOf(classToRemove),1);element.className=classNames.join(" ");},remove:function(item,array){if(!array)return;var i=array.indexOf(item);if(i!=-1){return array.splice(i,1)};},blockTextSelection:function(){document.body.focus();document.onselectstart=function(){return false;};},unblockTextSelection:function(){document.onselectstart=function(){return true;};},formatTime:function(seconds,guide){guide=guide||seconds;var s=Math.floor(seconds%60),m=Math.floor(seconds/60%60),h=Math.floor(seconds/3600),gm=Math.floor(guide/60%60),gh=Math.floor(guide/3600);h=(h>0||gh>0)?h+":":"";m=(((h||gm>=10)&&m<10)?"0"+m:m)+":";s=(s<10)?"0"+s:s;return h+m+s;},uc:function(string){return string.charAt(0).toUpperCase()+string.slice(1);},getRelativePosition:function(x,relativeElement){return Math.max(0,Math.min(1,(x-_V_.findPosX(relativeElement))/relativeElement.offsetWidth));},getComputedStyleValue:function(element,style){return window.getComputedStyle(element,null).getPropertyValue(style);},trim:function(string){return string.toString().replace(/^\s+/,"").replace(/\s+$/,"");},round:function(num,dec){if(!dec){dec=0;}return Math.round(num*Math.pow(10,dec))/Math.pow(10,dec);},isEmpty:function(object){for(var prop in object){return false;}return true;},createTimeRange:function(start,end){return{length:1,start:function(){return start;},end:function(){return end;}};},cache:{},guid:1,expando:"vdata"+(new Date).getTime(),getData:function(elem){var id=elem[_V_.expando];if(!id){id=elem[_V_.expando]=_V_.guid++;_V_.cache[id]={};}return _V_.cache[id];},removeData:function(elem){var id=elem[_V_.expando];if(!id){return;}delete _V_.cache[id];try{delete elem[_V_.expando];}catch(e){if(elem.removeAttribute){elem.removeAttribute(_V_.expando);}else{elem[_V_.expando]=null;}}},proxy:function(context,fn,uid){if(!fn.guid){fn.guid=_V_.guid++;}var ret=function(){return fn.apply(context,arguments);};ret.guid=(uid)?uid+"_"+fn.guid:fn.guid;return ret;},get:function(url,onSuccess,onError){var local=(url.indexOf("file:")==0||(window.location.href.indexOf("file:")==0&&url.indexOf("http:")==-1));if(typeof XMLHttpRequest=="undefined"){XMLHttpRequest=function(){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0");}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0");}catch(f){}try{return new ActiveXObject("Msxml2.XMLHTTP");}catch(g){}throw new Error("This browser does not support XMLHttpRequest.");};}var request=new XMLHttpRequest();try{request.open("GET",url);}catch(e){_V_.log("VideoJS XMLHttpRequest (open)",e);return false;}request.onreadystatechange=_V_.proxy(this,function(){if(request.readyState==4){if(request.status==200||local&&request.status==0){onSuccess(request.responseText);}else{if(onError){onError();}}}});try{request.send();}catch(e){_V_.log("VideoJS XMLHttpRequest (send)",e);if(onError){onError(e);}}},setLocalStorage:function(key,value){var localStorage=window.localStorage||false;if(!localStorage){return;}try{localStorage[key]=value;}catch(e){if(e.code==22||e.code==1014){_V_.log("LocalStorage Full (VideoJS)",e);}else{_V_.log("LocalStorage Error (VideoJS)",e);}}},getAbsoluteURL:function(url){if(!url.match(/^https?:\/\//)){url=_V_.createElement('div',{innerHTML:'<a href="'+url+'">x</a>'}).firstChild.href;}return url;}});_V_.log=function(){_V_.log.history=_V_.log.history||[];_V_.log.history.push(arguments);if(window.console){arguments.callee=arguments.callee.caller;var newarr=[].slice.call(arguments);(typeof console.log==='object'?_V_.log.apply.call(console.log,console,newarr):console.log.apply(console,newarr));}};(function(b){function c(){}for(var d="assert,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,timeStamp,profile,profileEnd,time,timeEnd,trace,warn".split(","),a;a=d.pop();){b[a]=b[a]||c}})((function(){try{console.log();return window.console;}catch(err){return window.console={};}})());if("getBoundingClientRect"in document.documentElement){_V_.findPosX=function(el){var box;try{box=el.getBoundingClientRect();}catch(e){}if(!box){return 0;}var docEl=document.documentElement,body=document.body,clientLeft=docEl.clientLeft||body.clientLeft||0,scrollLeft=window.pageXOffset||body.scrollLeft,left=box.left+scrollLeft-clientLeft;return left;};}else{_V_.findPosX=function(el){var curleft=el.offsetLeft;while(el=obj.offsetParent){if(el.className.indexOf("video-js")==-1){}else{}curleft+=el.offsetLeft;}return curleft;};}(function(){var initializing=false,fnTest=/xyz/.test(function(){xyz;})?/\b_super\b/:/.*/;_V_.Class=function(){};_V_.Class.extend=function(prop){var _super=this.prototype;initializing=true;var prototype=new this();initializing=false;for(var name in prop){prototype[name]=typeof prop[name]=="function"&&typeof _super[name]=="function"&&fnTest.test(prop[name])?(function(name,fn){return function(){var tmp=this._super;this._super=_super[name];var ret=fn.apply(this,arguments);this._super=tmp;return ret;};})(name,prop[name]):prop[name];}function Class(){if(!initializing&&this.init){return this.init.apply(this,arguments);}else if(!initializing){return arguments.callee.prototype.init()}}Class.prototype=prototype;Class.constructor=Class;Class.extend=arguments.callee;return Class;};})();_V_.Component=_V_.Class.extend({init:function(player,options){this.player=player;options=this.options=_V_.merge(this.options||{},options);if(options.el){this.el=options.el;}else{this.el=this.createElement();}this.initComponents();},destroy:function(){},createElement:function(type,attrs){return _V_.createElement(type||"div",attrs);},buildCSSClass:function(){return"";},initComponents:function(){var options=this.options;if(options&&options.components){this.eachProp(options.components,function(name,opts){var tempAdd=this.proxy(function(){this[name]=this.addComponent(name,opts);});if(opts.loadEvent){this.one(opts.loadEvent,tempAdd)}else{tempAdd();}});}},addComponent:function(name,options){var component,componentClass;if(typeof name=="string"){options=options||{};componentClass=options.componentClass||_V_.uc(name);component=new _V_[componentClass](this.player||this,options);}else{component=name;}this.el.appendChild(component.el);return component;},removeComponent:function(component){this.el.removeChild(component.el);},show:function(){this.el.style.display="block";},hide:function(){this.el.style.display="none";},fadeIn:function(){this.removeClass("vjs-fade-out");this.addClass("vjs-fade-in");},fadeOut:function(){this.removeClass("vjs-fade-in");this.addClass("vjs-fade-out");},lockShowing:function(){var style=this.el.style;style.display="block";style.opacity=1;style.visiblity="visible";},unlockShowing:function(){var style=this.el.style;style.display="";style.opacity="";style.visiblity="";},addClass:function(classToAdd){_V_.addClass(this.el,classToAdd);},removeClass:function(classToRemove){_V_.removeClass(this.el,classToRemove);},addEvent:function(type,fn,uid){return _V_.addEvent(this.el,type,_V_.proxy(this,fn));},removeEvent:function(type,fn){return _V_.removeEvent(this.el,type,fn);},triggerEvent:function(type,e){return _V_.triggerEvent(this.el,type,e);},one:function(type,fn){_V_.one(this.el,type,_V_.proxy(this,fn));},ready:function(fn){if(!fn)return this;if(this.isReady){fn.call(this);}else{if(this.readyQueue===undefined){this.readyQueue=[];}this.readyQueue.push(fn);}return this;},triggerReady:function(){this.isReady=true;if(this.readyQueue&&this.readyQueue.length>0){this.each(this.readyQueue,function(fn){fn.call(this);});this.readyQueue=[];this.triggerEvent("ready");}},each:function(arr,fn){_V_.each.call(this,arr,fn);},eachProp:function(obj,fn){_V_.eachProp.call(this,obj,fn);},extend:function(obj){_V_.merge(this,obj)},proxy:function(fn,uid){return _V_.proxy(this,fn,uid);}});_V_.Control=_V_.Component.extend({buildCSSClass:function(){return"vjs-control "+this._super();}});_V_.ControlBar=_V_.Component.extend({options:{loadEvent:"play",components:{"playToggle":{},"fullscreenToggle":{},"currentTimeDisplay":{},"timeDivider":{},"durationDisplay":{},"remainingTimeDisplay":{},"progressControl":{},"volumeControl":{},"muteToggle":{}}},init:function(player,options){this._super(player,options);player.addEvent("play",this.proxy(function(){this.fadeIn();this.player.addEvent("mouseover",this.proxy(this.fadeIn));this.player.addEvent("mouseout",this.proxy(this.fadeOut));}));},createElement:function(){return _V_.createElement("div",{className:"vjs-controls"});},fadeIn:function(){this._super();this.player.triggerEvent("controlsvisible");},fadeOut:function(){this._super();this.player.triggerEvent("controlshidden");},lockShowing:function(){this.el.style.opacity="1";}});_V_.Button=_V_.Control.extend({init:function(player,options){this._super(player,options);this.addEvent("click",this.onClick);this.addEvent("focus",this.onFocus);this.addEvent("blur",this.onBlur);},createElement:function(type,attrs){attrs=_V_.merge({className:this.buildCSSClass(),innerHTML:'<div><span class="vjs-control-text">'+(this.buttonText||"Need Text")+'</span></div>',role:"button",tabIndex:0},attrs);return this._super(type,attrs);},onClick:function(){},onFocus:function(){_V_.addEvent(document,"keyup",_V_.proxy(this,this.onKeyPress));},onKeyPress:function(event){if(event.which==32||event.which==13){event.preventDefault();this.onClick();}},onBlur:function(){_V_.removeEvent(document,"keyup",_V_.proxy(this,this.onKeyPress));}});_V_.PlayButton=_V_.Button.extend({buttonText:"Play",buildCSSClass:function(){return"vjs-play-button "+this._super();},onClick:function(){this.player.play();}});_V_.PauseButton=_V_.Button.extend({buttonText:"Pause",buildCSSClass:function(){return"vjs-pause-button "+this._super();},onClick:function(){this.player.pause();}});_V_.PlayToggle=_V_.Button.extend({buttonText:"Play",init:function(player,options){this._super(player,options);player.addEvent("play",_V_.proxy(this,this.onPlay));player.addEvent("pause",_V_.proxy(this,this.onPause));},buildCSSClass:function(){return"vjs-play-control "+this._super();},onClick:function(){if(this.player.paused()){this.player.play();}else{this.player.pause();}},onPlay:function(){_V_.removeClass(this.el,"vjs-paused");_V_.addClass(this.el,"vjs-playing");},onPause:function(){_V_.removeClass(this.el,"vjs-playing");_V_.addClass(this.el,"vjs-paused");}});_V_.FullscreenToggle=_V_.Button.extend({buttonText:"Fullscreen",buildCSSClass:function(){return"vjs-fullscreen-control "+this._super();},onClick:function(){if(!this.player.isFullScreen){this.player.requestFullScreen();}else{this.player.cancelFullScreen();}}});_V_.BigPlayButton=_V_.Button.extend({init:function(player,options){this._super(player,options);player.addEvent("play",_V_.proxy(this,this.hide));player.addEvent("ended",_V_.proxy(this,this.show));},createElement:function(){return this._super("div",{className:"vjs-big-play-button",innerHTML:"<span></span>"});},onClick:function(){if(this.player.currentTime()){this.player.currentTime(0);}this.player.play();}});_V_.LoadingSpinner=_V_.Component.extend({init:function(player,options){this._super(player,options);player.addEvent("canplay",_V_.proxy(this,this.hide));player.addEvent("canplaythrough",_V_.proxy(this,this.hide));player.addEvent("playing",_V_.proxy(this,this.hide));player.addEvent("seeking",_V_.proxy(this,this.show));player.addEvent("error",_V_.proxy(this,this.show));player.addEvent("waiting",_V_.proxy(this,this.show));},createElement:function(){var classNameSpinner,innerHtmlSpinner;if(typeof this.player.el.style.WebkitBorderRadius=="string"||typeof this.player.el.style.MozBorderRadius=="string"||typeof this.player.el.style.KhtmlBorderRadius=="string"||typeof this.player.el.style.borderRadius=="string"){classNameSpinner="vjs-loading-spinner";innerHtmlSpinner="<div class='ball1'></div><div class='ball2'></div><div class='ball3'></div><div class='ball4'></div><div class='ball5'></div><div class='ball6'></div><div class='ball7'></div><div class='ball8'></div>";}else{classNameSpinner="vjs-loading-spinner-fallback";innerHtmlSpinner="";}return this._super("div",{className:classNameSpinner,innerHTML:innerHtmlSpinner});}});_V_.CurrentTimeDisplay=_V_.Component.extend({init:function(player,options){this._super(player,options);player.addEvent("timeupdate",_V_.proxy(this,this.updateContent));},createElement:function(){var el=this._super("div",{className:"vjs-current-time vjs-time-controls vjs-control"});this.content=_V_.createElement("div",{className:"vjs-current-time-display",innerHTML:'0:00'});el.appendChild(_V_.createElement("div").appendChild(this.content));return el;},updateContent:function(){var time=(this.player.scrubbing)?this.player.values.currentTime:this.player.currentTime();this.content.innerHTML=_V_.formatTime(time,this.player.duration());}});_V_.DurationDisplay=_V_.Component.extend({init:function(player,options){this._super(player,options);player.addEvent("timeupdate",_V_.proxy(this,this.updateContent));},createElement:function(){var el=this._super("div",{className:"vjs-duration vjs-time-controls vjs-control"});this.content=_V_.createElement("div",{className:"vjs-duration-display",innerHTML:'0:00'});el.appendChild(_V_.createElement("div").appendChild(this.content));return el;},updateContent:function(){if(this.player.duration()){this.content.innerHTML=_V_.formatTime(this.player.duration());}}});_V_.TimeDivider=_V_.Component.extend({createElement:function(){return this._super("div",{className:"vjs-time-divider",innerHTML:'<div><span>/</span></div>'});}});_V_.RemainingTimeDisplay=_V_.Component.extend({init:function(player,options){this._super(player,options);player.addEvent("timeupdate",_V_.proxy(this,this.updateContent));},createElement:function(){var el=this._super("div",{className:"vjs-remaining-time vjs-time-controls vjs-control"});this.content=_V_.createElement("div",{className:"vjs-remaining-time-display",innerHTML:'-0:00'});el.appendChild(_V_.createElement("div").appendChild(this.content));return el;},updateContent:function(){if(this.player.duration()){this.content.innerHTML="-"+_V_.formatTime(this.player.remainingTime());}}});_V_.Slider=_V_.Component.extend({init:function(player,options){this._super(player,options);player.addEvent(this.playerEvent,_V_.proxy(this,this.update));this.addEvent("mousedown",this.onMouseDown);this.addEvent("focus",this.onFocus);this.addEvent("blur",this.onBlur);this.player.addEvent("controlsvisible",this.proxy(this.update));this.update();},createElement:function(type,attrs){attrs=_V_.merge({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},attrs);return this._super(type,attrs);},onMouseDown:function(event){event.preventDefault();_V_.blockTextSelection();_V_.addEvent(document,"mousemove",_V_.proxy(this,this.onMouseMove));_V_.addEvent(document,"mouseup",_V_.proxy(this,this.onMouseUp));this.onMouseMove(event);},onMouseUp:function(event){_V_.unblockTextSelection();_V_.removeEvent(document,"mousemove",this.onMouseMove,false);_V_.removeEvent(document,"mouseup",this.onMouseUp,false);this.update();},update:function(){var barProgress,progress=this.getPercent();handle=this.handle,bar=this.bar;if(isNaN(progress)){progress=0;}barProgress=progress;if(handle){var box=this.el,boxWidth=box.offsetWidth,handleWidth=handle.el.offsetWidth,handlePercent=(handleWidth)?handleWidth/boxWidth:0,boxAdjustedPercent=1-handlePercent;adjustedProgress=progress*boxAdjustedPercent,barProgress=adjustedProgress+(handlePercent/2);handle.el.style.left=_V_.round(adjustedProgress*100,2)+"%";}bar.el.style.width=_V_.round(barProgress*100,2)+"%";},calculateDistance:function(event){var box=this.el,boxX=_V_.findPosX(box),boxW=box.offsetWidth,handle=this.handle;if(handle){var handleW=handle.el.offsetWidth;boxX=boxX+(handleW/2);boxW=boxW-handleW;}return Math.max(0,Math.min(1,(event.pageX-boxX)/boxW));},onFocus:function(event){_V_.addEvent(document,"keyup",_V_.proxy(this,this.onKeyPress));},onKeyPress:function(event){if(event.which==37){event.preventDefault();this.stepBack();}else if(event.which==39){event.preventDefault();this.stepForward();}},onBlur:function(event){_V_.removeEvent(document,"keyup",_V_.proxy(this,this.onKeyPress));}});_V_.ProgressControl=_V_.Component.extend({options:{components:{"seekBar":{}}},createElement:function(){return this._super("div",{className:"vjs-progress-control vjs-control"});}});_V_.SeekBar=_V_.Slider.extend({options:{components:{"loadProgressBar":{},"bar":{componentClass:"PlayProgressBar"},"handle":{componentClass:"SeekHandle"}}},playerEvent:"timeupdate",init:function(player,options){this._super(player,options);},createElement:function(){return this._super("div",{className:"vjs-progress-holder"});},getPercent:function(){return this.player.currentTime()/this.player.duration();},onMouseDown:function(event){this._super(event);this.player.scrubbing=true;this.videoWasPlaying=!this.player.paused();this.player.pause();},onMouseMove:function(event){var newTime=this.calculateDistance(event)*this.player.duration();if(newTime==this.player.duration()){newTime=newTime-0.1;}this.player.currentTime(newTime);},onMouseUp:function(event){this._super(event);this.player.scrubbing=false;if(this.videoWasPlaying){this.player.play();}},stepForward:function(){this.player.currentTime(this.player.currentTime()+1);},stepBack:function(){this.player.currentTime(this.player.currentTime()-1);}});_V_.LoadProgressBar=_V_.Component.extend({init:function(player,options){this._super(player,options);player.addEvent("progress",_V_.proxy(this,this.update));},createElement:function(){return this._super("div",{className:"vjs-load-progress",innerHTML:'<span class="vjs-control-text">Loaded: 0%</span>'});},update:function(){if(this.el.style){this.el.style.width=_V_.round(this.player.bufferedPercent()*100,2)+"%";}}});_V_.PlayProgressBar=_V_.Component.extend({createElement:function(){return this._super("div",{className:"vjs-play-progress",innerHTML:'<span class="vjs-control-text">Progress: 0%</span>'});}});_V_.SeekHandle=_V_.Component.extend({createElement:function(){return this._super("div",{className:"vjs-seek-handle",innerHTML:'<span class="vjs-control-text">00:00</span>'});}});_V_.VolumeControl=_V_.Component.extend({options:{components:{"volumeBar":{}}},createElement:function(){return this._super("div",{className:"vjs-volume-control vjs-control"});}});_V_.VolumeBar=_V_.Slider.extend({options:{components:{"bar":{componentClass:"VolumeLevel"},"handle":{componentClass:"VolumeHandle"}}},playerEvent:"volumechange",createElement:function(){return this._super("div",{className:"vjs-volume-bar"});},onMouseMove:function(event){this.player.volume(this.calculateDistance(event));},getPercent:function(){return this.player.volume();},stepForward:function(){this.player.volume(this.player.volume()+0.1);},stepBack:function(){this.player.volume(this.player.volume()-0.1);}});_V_.VolumeLevel=_V_.Component.extend({createElement:function(){return this._super("div",{className:"vjs-volume-level",innerHTML:'<span class="vjs-control-text"></span>'});}});_V_.VolumeHandle=_V_.Component.extend({createElement:function(){return this._super("div",{className:"vjs-volume-handle",innerHTML:'<span class="vjs-control-text"></span>'});}});_V_.MuteToggle=_V_.Button.extend({init:function(player,options){this._super(player,options);player.addEvent("volumechange",_V_.proxy(this,this.update));},createElement:function(){return this._super("div",{className:"vjs-mute-control vjs-control",innerHTML:'<div><span class="vjs-control-text">Mute</span></div>'});},onClick:function(event){this.player.muted(this.player.muted()?false:true);},update:function(event){var vol=this.player.volume(),level=3;if(vol==0||this.player.muted()){level=0;}else if(vol<0.33){level=1;}else if(vol<0.67){level=2;}_V_.each.call(this,[0,1,2,3],function(i){_V_.removeClass(this.el,"vjs-vol-"+i);});_V_.addClass(this.el,"vjs-vol-"+level);}});_V_.PosterImage=_V_.Button.extend({init:function(player,options){this._super(player,options);if(!this.player.options.poster){this.hide();}player.addEvent("play",_V_.proxy(this,this.hide));},createElement:function(){return _V_.createElement("img",{className:"vjs-poster",src:this.player.options.poster,tabIndex:-1});},onClick:function(){this.player.play();}});_V_.Menu=_V_.Component.extend({init:function(player,options){this._super(player,options);},addItem:function(component){this.addComponent(component);component.addEvent("click",this.proxy(function(){this.unlockShowing();}));},createElement:function(){return this._super("ul",{className:"vjs-menu"});}});_V_.MenuItem=_V_.Button.extend({init:function(player,options){this._super(player,options);if(options.selected){this.addClass("vjs-selected");}},createElement:function(type,attrs){return this._super("li",_V_.merge({className:"vjs-menu-item",innerHTML:this.options.label},attrs));},onClick:function(){this.selected(true);},selected:function(selected){if(selected){this.addClass("vjs-selected");}else{this.removeClass("vjs-selected")}}});if(!Array.prototype.indexOf){Array.prototype.indexOf=function(searchElement){"use strict";if(this===void 0||this===null){throw new TypeError();}var t=Object(this);var len=t.length>>>0;if(len===0){return-1;}var n=0;if(arguments.length>0){n=Number(arguments[1]);if(n!==n){n=0;}else if(n!==0&&n!==(1/0)&&n!==-(1/0)){n=(n>0||-1)*Math.floor(Math.abs(n));}}if(n>=len){return-1;}var k=n>=0?n:Math.max(len-Math.abs(n),0);for(;k<len;k++){if(k in t&&t[k]===searchElement){return k;}}return-1;}}_V_.extend({addEvent:function(elem,type,fn){var data=_V_.getData(elem),handlers;if(data&&!data.handler){data.handler=function(event){event=_V_.fixEvent(event);var handlers=_V_.getData(elem).events[event.type];if(handlers){var handlersCopy=[];_V_.each(handlers,function(handler,i){handlersCopy[i]=handler;});for(var i=0,l=handlersCopy.length;i<l;i++){handlersCopy[i].call(elem,event);}}};}if(!data.events){data.events={};}handlers=data.events[type];if(!handlers){handlers=data.events[type]=[];if(document.addEventListener){elem.addEventListener(type,data.handler,false);}else if(document.attachEvent){elem.attachEvent("on"+type,data.handler);}}if(!fn.guid){fn.guid=_V_.guid++;}handlers.push(fn);},removeEvent:function(elem,type,fn){var data=_V_.getData(elem),handlers;if(!data.events){return;}if(!type){for(type in data.events){_V_.cleanUpEvents(elem,type);}return;}handlers=data.events[type];if(!handlers){return;}if(fn&&fn.guid){for(var i=0;i<handlers.length;i++){if(handlers[i].guid===fn.guid){handlers.splice(i--,1);}}}_V_.cleanUpEvents(elem,type);},cleanUpEvents:function(elem,type){var data=_V_.getData(elem);if(data.events[type].length===0){delete data.events[type];if(document.removeEventListener){elem.removeEventListener(type,data.handler,false);}else if(document.detachEvent){elem.detachEvent("on"+type,data.handler);}}if(_V_.isEmpty(data.events)){delete data.events;delete data.handler;}if(_V_.isEmpty(data)){_V_.removeData(elem);}},fixEvent:function(event){if(event[_V_.expando]){return event;}var originalEvent=event;event=new _V_.Event(originalEvent);for(var i=_V_.Event.props.length,prop;i;){prop=_V_.Event.props[--i];event[prop]=originalEvent[prop];}if(!event.target){event.target=event.srcElement||document;}if(event.target.nodeType===3){event.target=event.target.parentNode;}if(!event.relatedTarget&&event.fromElement){event.relatedTarget=event.fromElement===event.target?event.toElement:event.fromElement;}if(event.pageX==null&&event.clientX!=null){var eventDocument=event.target.ownerDocument||document,doc=eventDocument.documentElement,body=eventDocument.body;event.pageX=event.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0);event.pageY=event.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0);}if(event.which==null&&(event.charCode!=null||event.keyCode!=null)){event.which=event.charCode!=null?event.charCode:event.keyCode;}if(!event.metaKey&&event.ctrlKey){event.metaKey=event.ctrlKey;}if(!event.which&&event.button!==undefined){event.which=(event.button&1?1:(event.button&2?3:(event.button&4?2:0)));}return event;},triggerEvent:function(elem,event){var data=_V_.getData(elem),parent=elem.parentNode||elem.ownerDocument,type=event.type||event,handler;if(data){handler=data.handler}event=typeof event==="object"?event[_V_.expando]?event:new _V_.Event(type,event):new _V_.Event(type);event.type=type;if(handler){handler.call(elem,event);}event.result=undefined;event.target=elem;},one:function(elem,type,fn){_V_.addEvent(elem,type,function(){_V_.removeEvent(elem,type,arguments.callee);fn.apply(this,arguments);});}});_V_.Event=function(src,props){if(src&&src.type){this.originalEvent=src;this.type=src.type;this.isDefaultPrevented=(src.defaultPrevented||src.returnValue===false||src.getPreventDefault&&src.getPreventDefault())?returnTrue:returnFalse;}else{this.type=src;}if(props){_V_.merge(this,props);}this.timeStamp=(new Date).getTime();this[_V_.expando]=true;};_V_.Event.prototype={preventDefault:function(){this.isDefaultPrevented=returnTrue;var e=this.originalEvent;if(!e){return;}if(e.preventDefault){e.preventDefault();}else{e.returnValue=false;}},stopPropagation:function(){this.isPropagationStopped=returnTrue;var e=this.originalEvent;if(!e){return;}if(e.stopPropagation){e.stopPropagation();}e.cancelBubble=true;},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=returnTrue;this.stopPropagation();},isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse};_V_.Event.props="altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode metaKey newValue offsetX offsetY pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" ");function returnTrue(){return true;}function returnFalse(){return false;}var JSON;if(!JSON){JSON={};}(function(){var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;if(typeof JSON.parse!=='function'){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==='object'){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v;}else{delete value[k];}}}}return reviver.call(holder,key,value);}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return'\\u'+('0000'+a.charCodeAt(0).toString(16)).slice(-4);});}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,'@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']').replace(/(?:^|:|,)(?:\s*\[)+/g,''))){j=eval('('+text+')');return typeof reviver==='function'?walk({'':j},''):j;}throw new SyntaxError('JSON.parse');};}}());_V_.Player=_V_.Component.extend({init:function(tag,addOptions,ready){this.tag=tag;var el=this.el=_V_.createElement("div"),options=this.options={},width=options.width=tag.getAttribute('width'),height=options.height=tag.getAttribute('height'),initWidth=width||300,initHeight=height||150;tag.player=el.player=this;this.ready(ready);tag.parentNode.insertBefore(el,tag);el.appendChild(tag);el.id=this.id=tag.id;el.className=tag.className;tag.id+="_html5_api";tag.className="vjs-tech";_V_.players[el.id]=this;el.setAttribute("width",initWidth);el.setAttribute("height",initHeight);el.style.width=initWidth+"px";el.style.height=initHeight+"px";tag.removeAttribute("width");tag.removeAttribute("height");_V_.merge(options,_V_.options);_V_.merge(options,this.getVideoTagSettings());_V_.merge(options,addOptions);tag.removeAttribute("controls");tag.removeAttribute("poster");if(tag.hasChildNodes()){for(var i=0,j=tag.childNodes;i<j.length;i++){if(j[i].nodeName=="SOURCE"||j[i].nodeName=="TRACK"){tag.removeChild(j[i]);}}}this.values={};this.addClass("vjs-paused");this.addEvent("ended",this.onEnded);this.addEvent("play",this.onPlay);this.addEvent("pause",this.onPause);this.addEvent("progress",this.onProgress);this.addEvent("error",this.onError);if(options.controls){this.ready(function(){this.initComponents();});}this.textTracks=[];if(options.tracks&&options.tracks.length>0){this.addTextTracks(options.tracks);}if(!options.sources||options.sources.length==0){for(var i=0,j=options.techOrder;i<j.length;i++){var techName=j[i],tech=_V_[techName];if(tech.isSupported()){this.loadTech(techName);break;}}}else{this.src(options.sources);}},values:{},destroy:function(){this.stopTrackingProgress();this.stopTrackingCurrentTime();_V_.players[this.id]=null;delete _V_.players[this.id];this.tech.destroy();this.el.parentNode.removeChild(this.el);},createElement:function(type,options){},getVideoTagSettings:function(){var options={sources:[],tracks:[]};options.src=this.tag.getAttribute("src");options.controls=this.tag.getAttribute("controls")!==null;options.poster=this.tag.getAttribute("poster");options.preload=this.tag.getAttribute("preload");options.autoplay=this.tag.getAttribute("autoplay")!==null;options.loop=this.tag.getAttribute("loop")!==null;options.muted=this.tag.getAttribute("muted")!==null;if(this.tag.hasChildNodes()){for(var c,i=0,j=this.tag.childNodes;i<j.length;i++){c=j[i];if(c.nodeName=="SOURCE"){options.sources.push({src:c.getAttribute('src'),type:c.getAttribute('type'),media:c.getAttribute('media'),title:c.getAttribute('title')});}if(c.nodeName=="TRACK"){options.tracks.push({src:c.getAttribute("src"),kind:c.getAttribute("kind"),srclang:c.getAttribute("srclang"),label:c.getAttribute("label"),'default':c.getAttribute("default")!==null,title:c.getAttribute("title")});}}}return options;},loadTech:function(techName,source){if(this.tech){this.unloadTech();}else if(techName!="html5"&&this.tag){this.el.removeChild(this.tag);this.tag=false;}this.techName=techName;this.isReady=false;var techReady=function(){this.player.triggerReady();if(!this.support.progressEvent){this.player.manualProgressOn();}if(!this.support.timeupdateEvent){this.player.manualTimeUpdatesOn();}};var techOptions=_V_.merge({source:source,parentEl:this.el},this.options[techName]);if(source){if(source.src==this.values.src&&this.values.currentTime>0){techOptions.startTime=this.values.currentTime;}this.values.src=source.src;}this.tech=new _V_[techName](this,techOptions);this.tech.ready(techReady);},unloadTech:function(){this.tech.destroy();if(this.manualProgress){this.manualProgressOff();}if(this.manualTimeUpdates){this.manualTimeUpdatesOff();}this.tech=false;},manualProgressOn:function(){this.manualProgress=true;this.trackProgress();this.tech.addEvent("progress",function(){this.removeEvent("progress",arguments.callee);this.support.progressEvent=true;this.player.manualProgressOff();});},manualProgressOff:function(){this.manualProgress=false;this.stopTrackingProgress();},trackProgress:function(){this.progressInterval=setInterval(_V_.proxy(this,function(){if(this.values.bufferEnd<this.buffered().end(0)){this.triggerEvent("progress");}else if(this.bufferedPercent()==1){this.stopTrackingProgress();this.triggerEvent("progress");}}),500);},stopTrackingProgress:function(){clearInterval(this.progressInterval);},manualTimeUpdatesOn:function(){this.manualTimeUpdates=true;this.addEvent("play",this.trackCurrentTime);this.addEvent("pause",this.stopTrackingCurrentTime);this.tech.addEvent("timeupdate",function(){this.removeEvent("timeupdate",arguments.callee);this.support.timeupdateEvent=true;this.player.manualTimeUpdatesOff();});},manualTimeUpdatesOff:function(){this.manualTimeUpdates=false;this.stopTrackingCurrentTime();this.removeEvent("play",this.trackCurrentTime);this.removeEvent("pause",this.stopTrackingCurrentTime);},trackCurrentTime:function(){if(this.currentTimeInterval){this.stopTrackingCurrentTime();}this.currentTimeInterval=setInterval(_V_.proxy(this,function(){this.triggerEvent("timeupdate");}),250);},stopTrackingCurrentTime:function(){clearInterval(this.currentTimeInterval);},onEnded:function(){if(this.options.loop){this.currentTime(0);this.play();}else{this.pause();this.currentTime(0);this.pause();}},onPlay:function(){_V_.removeClass(this.el,"vjs-paused");_V_.addClass(this.el,"vjs-playing");},onPause:function(){_V_.removeClass(this.el,"vjs-playing");_V_.addClass(this.el,"vjs-paused");},onProgress:function(){if(this.bufferedPercent()==1){this.triggerEvent("loadedalldata");}},onError:function(e){_V_.log("Video Error",e);},techCall:function(method,arg){if(!this.tech.isReady){this.tech.ready(function(){this[method](arg);});}else{try{this.tech[method](arg);}catch(e){_V_.log(e);}}},techGet:function(method){if(this.tech.isReady){try{return this.tech[method]();}catch(e){if(this.tech[method]===undefined){_V_.log("Video.js: "+method+" method not defined for "+this.techName+" playback technology.",e);}else{if(e.name=="TypeError"){_V_.log("Video.js: "+method+" unavailable on "+this.techName+" playback technology element.",e);this.tech.isReady=false;}else{_V_.log(e);}}}}return;},play:function(){this.techCall("play");return this;},pause:function(){this.techCall("pause");return this;},paused:function(){return(this.techGet("paused")===false)?false:true;},currentTime:function(seconds){if(seconds!==undefined){this.values.lastSetCurrentTime=seconds;this.techCall("setCurrentTime",seconds);if(this.manualTimeUpdates){this.triggerEvent("timeupdate");}return this;}return this.values.currentTime=(this.techGet("currentTime")||0);},duration:function(){return parseFloat(this.techGet("duration"));},remainingTime:function(){return this.duration()-this.currentTime();},buffered:function(){var buffered=this.techGet("buffered"),start=0,end=this.values.bufferEnd=this.values.bufferEnd||0,timeRange;if(buffered&&buffered.length>0&&buffered.end(0)!==end){end=buffered.end(0);this.values.bufferEnd=end;}return _V_.createTimeRange(start,end);},bufferedPercent:function(){return(this.duration())?this.buffered().end(0)/this.duration():0;},volume:function(percentAsDecimal){var vol;if(percentAsDecimal!==undefined){vol=Math.max(0,Math.min(1,parseFloat(percentAsDecimal)));this.values.volume=vol;this.techCall("setVolume",vol);_V_.setLocalStorage("volume",vol);return this;}vol=parseFloat(this.techGet("volume"));return(isNaN(vol))?1:vol;},muted:function(muted){if(muted!==undefined){this.techCall("setMuted",muted);return this;}return this.techGet("muted")||false;},width:function(width,skipListeners){if(width!==undefined){this.el.width=width;this.el.style.width=width+"px";if(!skipListeners){this.triggerEvent("resize");}return this;}return parseInt(this.el.getAttribute("width"));},height:function(height){if(height!==undefined){this.el.height=height;this.el.style.height=height+"px";this.triggerEvent("resize");return this;}return parseInt(this.el.getAttribute("height"));},size:function(width,height){return this.width(width,true).height(height);},supportsFullScreen:function(){return this.techGet("supportsFullScreen")||false;},requestFullScreen:function(){var requestFullScreen=_V_.support.requestFullScreen;this.isFullScreen=true;if(requestFullScreen){_V_.addEvent(document,requestFullScreen.eventName,this.proxy(function(){this.isFullScreen=document[requestFullScreen.isFullScreen];if(this.isFullScreen==false){_V_.removeEvent(document,requestFullScreen.eventName,arguments.callee);}this.triggerEvent("fullscreenchange");}));if(this.tech.support.fullscreenResize===false&&this.options.flash.iFrameMode!=true){this.pause();this.unloadTech();_V_.addEvent(document,requestFullScreen.eventName,this.proxy(function(){_V_.removeEvent(document,requestFullScreen.eventName,arguments.callee);this.loadTech(this.techName,{src:this.values.src});}));this.el[requestFullScreen.requestFn]();}else{this.el[requestFullScreen.requestFn]();}}else if(this.tech.supportsFullScreen()){this.triggerEvent("fullscreenchange");this.techCall("enterFullScreen");}else{this.triggerEvent("fullscreenchange");this.enterFullWindow();}return this;},cancelFullScreen:function(){var requestFullScreen=_V_.support.requestFullScreen;this.isFullScreen=false;if(requestFullScreen){if(this.tech.support.fullscreenResize===false&&this.options.flash.iFrameMode!=true){this.pause();this.unloadTech();_V_.addEvent(document,requestFullScreen.eventName,this.proxy(function(){_V_.removeEvent(document,requestFullScreen.eventName,arguments.callee);this.loadTech(this.techName,{src:this.values.src})}));document[requestFullScreen.cancelFn]();}else{document[requestFullScreen.cancelFn]();}}else if(this.tech.supportsFullScreen()){this.techCall("exitFullScreen");this.triggerEvent("fullscreenchange");}else{this.exitFullWindow();this.triggerEvent("fullscreenchange");}return this;},enterFullWindow:function(){this.isFullWindow=true;this.docOrigOverflow=document.documentElement.style.overflow;_V_.addEvent(document,"keydown",_V_.proxy(this,this.fullWindowOnEscKey));document.documentElement.style.overflow='hidden';_V_.addClass(document.body,"vjs-full-window");_V_.addClass(this.el,"vjs-fullscreen");this.triggerEvent("enterFullWindow");},fullWindowOnEscKey:function(event){if(event.keyCode==27){if(this.isFullScreen==true){this.cancelFullScreen();}else{this.exitFullWindow();}}},exitFullWindow:function(){this.isFullWindow=false;_V_.removeEvent(document,"keydown",this.fullWindowOnEscKey);document.documentElement.style.overflow=this.docOrigOverflow;_V_.removeClass(document.body,"vjs-full-window");_V_.removeClass(this.el,"vjs-fullscreen");this.triggerEvent("exitFullWindow");},selectSource:function(sources){for(var i=0,j=this.options.techOrder;i<j.length;i++){var techName=j[i],tech=_V_[techName];if(tech.isSupported()){for(var a=0,b=sources;a<b.length;a++){var source=b[a];if(tech.canPlaySource.call(this,source)){return{source:source,tech:techName};}}}}return false;},src:function(source){if(source instanceof Array){var sourceTech=this.selectSource(source),source,techName;if(sourceTech){source=sourceTech.source;techName=sourceTech.tech;if(techName==this.techName){this.src(source);}else{this.loadTech(techName,source);}}else{_V_.log("No compatible source and playback technology were found.")}}else if(source instanceof Object){if(_V_[this.techName].canPlaySource(source)){this.src(source.src);}else{this.src([source]);}}else{this.values.src=source;if(!this.isReady){this.ready(function(){this.src(source);});}else{this.techCall("src",source);if(this.options.preload=="auto"){this.load();}if(this.options.autoplay){this.play();}}}return this;},load:function(){this.techCall("load");return this;},currentSrc:function(){return this.techGet("currentSrc")||this.values.src||"";},preload:function(value){if(value!==undefined){this.techCall("setPreload",value);this.options.preload=value;return this;}return this.techGet("preload");},autoplay:function(value){if(value!==undefined){this.techCall("setAutoplay",value);this.options.autoplay=value;return this;}return this.techGet("autoplay",value);},loop:function(value){if(value!==undefined){this.techCall("setLoop",value);this.options.loop=value;return this;}return this.techGet("loop");},controls:function(){return this.options.controls;},poster:function(){return this.techGet("poster");},error:function(){return this.techGet("error");},ended:function(){return this.techGet("ended");}});(function(){var requestFn,cancelFn,eventName,isFullScreen,playerProto=_V_.Player.prototype;if(document.cancelFullscreen!==undefined){requestFn="requestFullscreen";cancelFn="exitFullscreen";eventName="fullscreenchange";isFullScreen="fullScreen";}else{_V_.each(["moz","webkit"],function(prefix){if((prefix!="moz"||document.mozFullScreenEnabled)&&document[prefix+"CancelFullScreen"]!==undefined){requestFn=prefix+"RequestFullScreen";cancelFn=prefix+"CancelFullScreen";eventName=prefix+"fullscreenchange";if(prefix=="webkit"){isFullScreen=prefix+"IsFullScreen";}else{isFullScreen=prefix+"FullScreen";}}});}if(requestFn){_V_.support.requestFullScreen={requestFn:requestFn,cancelFn:cancelFn,eventName:eventName,isFullScreen:isFullScreen};}})();_V_.PlaybackTech=_V_.Component.extend({init:function(player,options){},onClick:function(){if(this.player.options.controls){_V_.PlayToggle.prototype.onClick.call(this);}}});_V_.apiMethods="play,pause,paused,currentTime,setCurrentTime,duration,buffered,volume,setVolume,muted,setMuted,width,height,supportsFullScreen,enterFullScreen,src,load,currentSrc,preload,setPreload,autoplay,setAutoplay,loop,setLoop,error,networkState,readyState,seeking,initialTime,startOffsetTime,played,seekable,ended,videoTracks,audioTracks,videoWidth,videoHeight,textTracks,defaultPlaybackRate,playbackRate,mediaGroup,controller,controls,defaultMuted".split(",");_V_.each(_V_.apiMethods,function(methodName){_V_.PlaybackTech.prototype[methodName]=function(){throw new Error("The '"+methodName+"' method is not available on the playback technology's API");}});_V_.html5=_V_.PlaybackTech.extend({init:function(player,options,ready){this.player=player;this.el=this.createElement();this.ready(ready);this.addEvent("click",this.proxy(this.onClick));var source=options.source;if(source&&this.el.currentSrc==source.src){player.triggerEvent("loadstart");}else if(source){this.el.src=source.src;}player.ready(function(){if(this.options.autoplay&&this.paused()){this.tag.poster=null;this.play();}});this.setupTriggers();this.triggerReady();},destroy:function(){this.player.tag=false;this.removeTriggers();this.el.parentNode.removeChild(this.el);},createElement:function(){var html5=_V_.html5,player=this.player,el=player.tag,newEl;if(!el||this.support.movingElementInDOM===false){if(el){player.el.removeChild(el);}newEl=_V_.createElement("video",{id:el.id||player.el.id+"_html5_api",className:el.className||"vjs-tech"});el=newEl;_V_.insertFirst(el,player.el);}_V_.each(["autoplay","preload","loop","muted"],function(attr){if(player.options[attr]!==null){el[attr]=player.options[attr];}},this);return el;},setupTriggers:function(){_V_.each.call(this,_V_.html5.events,function(type){_V_.addEvent(this.el,type,_V_.proxy(this.player,this.eventHandler));});},removeTriggers:function(){_V_.each.call(this,_V_.html5.events,function(type){_V_.removeEvent(this.el,type,_V_.proxy(this.player,this.eventHandler));});},eventHandler:function(e){e.stopPropagation();this.triggerEvent(e);},play:function(){this.el.play();},pause:function(){this.el.pause();},paused:function(){return this.el.paused;},currentTime:function(){return this.el.currentTime;},setCurrentTime:function(seconds){try{this.el.currentTime=seconds;}catch(e){_V_.log(e,"Video isn't ready. (VideoJS)");}},duration:function(){return this.el.duration||0;},buffered:function(){return this.el.buffered;},volume:function(){return this.el.volume;},setVolume:function(percentAsDecimal){this.el.volume=percentAsDecimal;},muted:function(){return this.el.muted;},setMuted:function(muted){this.el.muted=muted},width:function(){return this.el.offsetWidth;},height:function(){return this.el.offsetHeight;},supportsFullScreen:function(){if(typeof this.el.webkitEnterFullScreen=='function'){if(!navigator.userAgent.match("Chrome")&&!navigator.userAgent.match("Mac OS X 10.5")){return true;}}return false;},enterFullScreen:function(){try{this.el.webkitEnterFullScreen();}catch(e){if(e.code==11){_V_.log("VideoJS: Video not ready.")}}},src:function(src){this.el.src=src;},load:function(){this.el.load();},currentSrc:function(){return this.el.currentSrc;},preload:function(){return this.el.preload;},setPreload:function(val){this.el.preload=val;},autoplay:function(){return this.el.autoplay;},setAutoplay:function(val){this.el.autoplay=val;},loop:function(){return this.el.loop;},setLoop:function(val){this.el.loop=val;},error:function(){return this.el.error;},seeking:function(){return this.el.seeking;},ended:function(){return this.el.ended;},controls:function(){return this.player.options.controls;},defaultMuted:function(){return this.el.defaultMuted;}});_V_.html5.isSupported=function(){return!!document.createElement("video").canPlayType;};_V_.html5.canPlaySource=function(srcObj){var ret=false;if(navigator.appVersion.indexOf("MSIE 9")!=-1)return false;try{ret=!!document.createElement("video").canPlayType(srcObj.type);}catch(e){return false;}return ret;};_V_.html5.events="loadstart,suspend,abort,error,emptied,stalled,loadedmetadata,loadeddata,canplay,canplaythrough,playing,waiting,seeking,seeked,ended,durationchange,timeupdate,progress,play,pause,ratechange,volumechange".split(",");_V_.html5.prototype.support={fullscreen:(typeof _V_.testVid.webkitEnterFullScreen!==undefined)?(!_V_.ua.match("Chrome")&&!_V_.ua.match("Mac OS X 10.5")?true:false):false,movingElementInDOM:!_V_.isIOS()};if(_V_.isAndroid()){if(_V_.androidVersion()<3){document.createElement("video").constructor.prototype.canPlayType=function(type){return(type&&type.toLowerCase().indexOf("video/mp4")!=-1)?"maybe":"";};}}_V_.flash=_V_.PlaybackTech.extend({init:function(player,options){this.player=player;var source=options.source,parentEl=options.parentEl,placeHolder=this.el=_V_.createElement("div",{id:parentEl.id+"_temp_flash"}),objId=player.el.id+"_flash_api",playerOptions=player.options,flashVars=_V_.merge({readyFunction:"_V_.flash.onReady",eventProxyFunction:"_V_.flash.onEvent",errorEventProxyFunction:"_V_.flash.onError",autoplay:playerOptions.autoplay,preload:playerOptions.preload,loop:playerOptions.loop,muted:playerOptions.muted},options.flashVars),params=_V_.merge({wmode:"opaque",bgcolor:"#000000"},options.params),attributes=_V_.merge({id:objId,name:objId,'class':'vjs-tech'},options.attributes);if(source){flashVars.src=encodeURIComponent(_V_.getAbsoluteURL(source.src));}_V_.insertFirst(placeHolder,parentEl);if(options.startTime){this.ready(function(){this.load();this.play();this.currentTime(options.startTime);});}if(options.iFrameMode==true&&!_V_.isFF){var iFrm=_V_.createElement("iframe",{id:objId+"_iframe",name:objId+"_iframe",className:"vjs-tech",scrolling:"no",marginWidth:0,marginHeight:0,frameBorder:0});flashVars.readyFunction="ready";flashVars.eventProxyFunction="events";flashVars.errorEventProxyFunction="errors";_V_.addEvent(iFrm,"load",_V_.proxy(this,function(){var iDoc,objTag,swfLoc,iWin=iFrm.contentWindow,varString="";iDoc=iFrm.contentDocument?iFrm.contentDocument:iFrm.contentWindow.document;iDoc.write(_V_.flash.getEmbedCode(options.swf,flashVars,params,attributes));iWin.player=this.player;iWin.ready=_V_.proxy(this.player,function(currSwf){var el=iDoc.getElementById(currSwf),player=this,tech=player.tech;tech.el=el;_V_.addEvent(el,"click",tech.proxy(tech.onClick));_V_.flash.checkReady(tech);});iWin.events=_V_.proxy(this.player,function(swfID,eventName,other){var player=this;if(player&&player.techName=="flash"){player.triggerEvent(eventName);}});iWin.errors=_V_.proxy(this.player,function(swfID,eventName){_V_.log("Flash Error",eventName);});}));placeHolder.parentNode.replaceChild(iFrm,placeHolder);}else{_V_.flash.embed(options.swf,placeHolder,flashVars,params,attributes);}},destroy:function(){this.el.parentNode.removeChild(this.el);},play:function(){this.el.vjs_play();},pause:function(){this.el.vjs_pause();},src:function(src){src=_V_.getAbsoluteURL(src);this.el.vjs_src(src);if(this.player.autoplay()){var tech=this;setTimeout(function(){tech.play();},0);}},load:function(){this.el.vjs_load();},poster:function(){this.el.vjs_getProperty("poster");},buffered:function(){return _V_.createTimeRange(0,this.el.vjs_getProperty("buffered"));},supportsFullScreen:function(){return false;},enterFullScreen:function(){return false;}});(function(){var api=_V_.flash.prototype,readWrite="preload,currentTime,defaultPlaybackRate,playbackRate,autoplay,loop,mediaGroup,controller,controls,volume,muted,defaultMuted".split(","),readOnly="error,currentSrc,networkState,readyState,seeking,initialTime,duration,startOffsetTime,paused,played,seekable,ended,videoTracks,audioTracks,videoWidth,videoHeight,textTracks".split(","),callOnly="load,play,pause".split(",");createSetter=function(attr){var attrUpper=attr.charAt(0).toUpperCase()+attr.slice(1);api["set"+attrUpper]=function(val){return this.el.vjs_setProperty(attr,val);};},createGetter=function(attr){api[attr]=function(){return this.el.vjs_getProperty(attr);};};_V_.each(readWrite,function(attr){createGetter(attr);createSetter(attr);});_V_.each(readOnly,function(attr){createGetter(attr);});})();_V_.flash.isSupported=function(){return _V_.flash.version()[0]>=10;};_V_.flash.canPlaySource=function(srcObj){if(srcObj.type in _V_.flash.prototype.support.formats){return"maybe";}};_V_.flash.prototype.support={formats:{"video/flv":"FLV","video/x-flv":"FLV","video/mp4":"MP4","video/m4v":"MP4"},progressEvent:false,timeupdateEvent:false,fullscreenResize:false,parentResize:!(_V_.ua.match("Firefox"))};_V_.flash.onReady=function(currSwf){var el=_V_.el(currSwf);var player=el.player||el.parentNode.player,tech=player.tech;el.player=player;tech.el=el;tech.addEvent("click",tech.onClick);_V_.flash.checkReady(tech);};_V_.flash.checkReady=function(tech){if(tech.el.vjs_getProperty){tech.triggerReady();}else{setTimeout(function(){_V_.flash.checkReady(tech);},50);}};_V_.flash.onEvent=function(swfID,eventName){var player=_V_.el(swfID).player;player.triggerEvent(eventName);};_V_.flash.onError=function(swfID,err){var player=_V_.el(swfID).player;player.triggerEvent("error");_V_.log("Flash Error",err,swfID);};_V_.flash.version=function(){var version='0,0,0';try{version=new ActiveXObject('ShockwaveFlash.ShockwaveFlash').GetVariable('$version').replace(/\D+/g,',').match(/^,?(.+),?$/)[1];}catch(e){try{if(navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin){version=(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1];}}catch(e){}}return version.split(",");};_V_.flash.embed=function(swf,placeHolder,flashVars,params,attributes){var code=_V_.flash.getEmbedCode(swf,flashVars,params,attributes),obj=_V_.createElement("div",{innerHTML:code}).childNodes[0],par=placeHolder.parentNode;placeHolder.parentNode.replaceChild(obj,placeHolder);if(_V_.isIE()){var newObj=par.childNodes[0];setTimeout(function(){newObj.style.display="block";},1000);}return obj;};_V_.flash.getEmbedCode=function(swf,flashVars,params,attributes){var objTag='<object type="application/x-shockwave-flash"',flashVarsString='',paramsString='',attrsString='';if(flashVars){_V_.eachProp(flashVars,function(key,val){flashVarsString+=(key+"="+val+"&amp;");});}params=_V_.merge({movie:swf,flashvars:flashVarsString,allowScriptAccess:"always",allowNetworking:"all"},params);_V_.eachProp(params,function(key,val){paramsString+='<param name="'+key+'" value="'+val+'" />';});attributes=_V_.merge({data:swf,width:"100%",height:"100%"},attributes);_V_.eachProp(attributes,function(key,val){attrsString+=(key+'="'+val+'" ');});return objTag+attrsString+'>'+paramsString+'</object>';};_V_.merge(_V_.Player.prototype,{addTextTracks:function(trackObjects){var tracks=this.textTracks=(this.textTracks)?this.textTracks:[],i=0,j=trackObjects.length,track,Kind;for(;i<j;i++){Kind=_V_.uc(trackObjects[i].kind||"subtitles");track=new _V_[Kind+"Track"](this,trackObjects[i]);tracks.push(track);if(track['default']){this.ready(_V_.proxy(track,track.show));}}return this;},showTextTrack:function(id,disableSameKind){var tracks=this.textTracks,i=0,j=tracks.length,track,showTrack,kind;for(;i<j;i++){track=tracks[i];if(track.id===id){track.show();showTrack=track;}else if(disableSameKind&&track.kind==disableSameKind&&track.mode>0){track.disable();}}kind=(showTrack)?showTrack.kind:((disableSameKind)?disableSameKind:false);if(kind){this.triggerEvent(kind+"trackchange");}return this;}});_V_.Track=_V_.Component.extend({init:function(player,options){this._super(player,options);_V_.merge(this,{id:options.id||("vjs_"+options.kind+"_"+options.language+"_"+_V_.guid++),src:options.src,"default":options["default"],title:options.title,language:options.srclang,label:options.label,cues:[],activeCues:[],readyState:0,mode:0});},createElement:function(){return this._super("div",{className:"vjs-"+this.kind+" vjs-text-track"});},show:function(){this.activate();this.mode=2;this._super();},hide:function(){this.activate();this.mode=1;this._super();},disable:function(){if(this.mode==2){this.hide();}this.deactivate();this.mode=0;},activate:function(){if(this.readyState==0){this.load();}if(this.mode==0){this.player.addEvent("timeupdate",this.proxy(this.update,this.id));this.player.addEvent("ended",this.proxy(this.reset,this.id));if(this.kind=="captions"||this.kind=="subtitles"){this.player.textTrackDisplay.addComponent(this);}}},deactivate:function(){this.player.removeEvent("timeupdate",this.proxy(this.update,this.id));this.player.removeEvent("ended",this.proxy(this.reset,this.id));this.reset();this.player.textTrackDisplay.removeComponent(this);},load:function(){if(this.readyState==0){this.readyState=1;_V_.get(this.src,this.proxy(this.parseCues),this.proxy(this.onError));}},onError:function(err){this.error=err;this.readyState=3;this.triggerEvent("error");},parseCues:function(srcContent){var cue,time,text,lines=srcContent.split("\n"),line="",id;for(var i=1,j=lines.length;i<j;i++){line=_V_.trim(lines[i]);if(line){if(line.indexOf("-->")==-1){id=line;line=_V_.trim(lines[++i]);}else{id=this.cues.length;}cue={id:id,index:this.cues.length};time=line.split(" --> ");cue.startTime=this.parseCueTime(time[0]);cue.endTime=this.parseCueTime(time[1]);text=[];while(lines[++i]&&(line=_V_.trim(lines[i]))){text.push(line);}cue.text=text.join('<br/>');this.cues.push(cue);}}this.readyState=2;this.triggerEvent("loaded");},parseCueTime:function(timeText){var parts=timeText.split(':'),time=0,hours,minutes,other,seconds,ms,flags;if(parts.length==3){hours=parts[0];minutes=parts[1];other=parts[2];}else{hours=0;minutes=parts[0];other=parts[1];}other=other.split(/\s+/);seconds=other.splice(0,1)[0];seconds=seconds.split(/\.|,/);ms=parseFloat(seconds[1]);seconds=seconds[0];time+=parseFloat(hours)*3600;time+=parseFloat(minutes)*60;time+=parseFloat(seconds);if(ms){time+=ms/1000;}return time;},update:function(){if(this.cues.length>0){var time=this.player.currentTime();if(this.prevChange===undefined||time<this.prevChange||this.nextChange<=time){var cues=this.cues,newNextChange=this.player.duration(),newPrevChange=0,reverse=false,newCues=[],firstActiveIndex,lastActiveIndex,html="",cue,i,j;if(time>=this.nextChange||this.nextChange===undefined){i=(this.firstActiveIndex!==undefined)?this.firstActiveIndex:0;}else{reverse=true;i=(this.lastActiveIndex!==undefined)?this.lastActiveIndex:cues.length-1;}while(true){cue=cues[i];if(cue.endTime<=time){newPrevChange=Math.max(newPrevChange,cue.endTime);if(cue.active){cue.active=false;}}else if(time<cue.startTime){newNextChange=Math.min(newNextChange,cue.startTime);if(cue.active){cue.active=false;}if(!reverse){break;}}else{if(reverse){newCues.splice(0,0,cue);if(lastActiveIndex===undefined){lastActiveIndex=i;}firstActiveIndex=i;}else{newCues.push(cue);if(firstActiveIndex===undefined){firstActiveIndex=i;}lastActiveIndex=i;}newNextChange=Math.min(newNextChange,cue.endTime);newPrevChange=Math.max(newPrevChange,cue.startTime);cue.active=true;}if(reverse){if(i===0){break;}else{i--;}}else{if(i===cues.length-1){break;}else{i++;}}}this.activeCues=newCues;this.nextChange=newNextChange;this.prevChange=newPrevChange;this.firstActiveIndex=firstActiveIndex;this.lastActiveIndex=lastActiveIndex;this.updateDisplay();this.triggerEvent("cuechange");}}},updateDisplay:function(){var cues=this.activeCues,html="",i=0,j=cues.length;for(;i<j;i++){html+="<span class='vjs-tt-cue'>"+cues[i].text+"</span>";}this.el.innerHTML=html;},reset:function(){this.nextChange=0;this.prevChange=this.player.duration();this.firstActiveIndex=0;this.lastActiveIndex=0;}});_V_.CaptionsTrack=_V_.Track.extend({kind:"captions"});_V_.SubtitlesTrack=_V_.Track.extend({kind:"subtitles"});_V_.ChaptersTrack=_V_.Track.extend({kind:"chapters"});_V_.TextTrackDisplay=_V_.Component.extend({createElement:function(){return this._super("div",{className:"vjs-text-track-display"});}});_V_.TextTrackMenuItem=_V_.MenuItem.extend({init:function(player,options){var track=this.track=options.track;options.label=track.label;options.selected=track["default"];this._super(player,options);this.player.addEvent(track.kind+"trackchange",_V_.proxy(this,this.update));},onClick:function(){this._super();this.player.showTextTrack(this.track.id,this.track.kind);},update:function(){if(this.track.mode==2){this.selected(true);}else{this.selected(false);}}});_V_.OffTextTrackMenuItem=_V_.TextTrackMenuItem.extend({init:function(player,options){options.track={kind:options.kind,player:player,label:"Off"};this._super(player,options);},onClick:function(){this._super();this.player.showTextTrack(this.track.id,this.track.kind);},update:function(){var tracks=this.player.textTracks,i=0,j=tracks.length,track,off=true;for(;i<j;i++){track=tracks[i];if(track.kind==this.track.kind&&track.mode==2){off=false;}}if(off){this.selected(true);}else{this.selected(false);}}});_V_.TextTrackButton=_V_.Button.extend({init:function(player,options){this._super(player,options);this.menu=this.createMenu();if(this.items.length===0){this.hide();}},createMenu:function(){var menu=new _V_.Menu(this.player);menu.el.appendChild(_V_.createElement("li",{className:"vjs-menu-title",innerHTML:_V_.uc(this.kind)}));menu.addItem(new _V_.OffTextTrackMenuItem(this.player,{kind:this.kind}));this.items=this.createItems();this.each(this.items,function(item){menu.addItem(item);});this.addComponent(menu);return menu;},createItems:function(){var items=[];this.each(this.player.textTracks,function(track){if(track.kind===this.kind){items.push(new _V_.TextTrackMenuItem(this.player,{track:track}));}});return items;},buildCSSClass:function(){return this.className+" vjs-menu-button "+this._super();},onFocus:function(){this.menu.lockShowing();_V_.one(this.menu.el.childNodes[this.menu.el.childNodes.length-1],"blur",this.proxy(function(){this.menu.unlockShowing();}));},onBlur:function(){},onClick:function(){this.one("mouseout",this.proxy(function(){this.menu.unlockShowing();this.el.blur();}));}});_V_.CaptionsButton=_V_.TextTrackButton.extend({kind:"captions",buttonText:"Captions",className:"vjs-captions-button"});_V_.SubtitlesButton=_V_.TextTrackButton.extend({kind:"subtitles",buttonText:"Subtitles",className:"vjs-subtitles-button"});_V_.ChaptersButton=_V_.TextTrackButton.extend({kind:"chapters",buttonText:"Chapters",className:"vjs-chapters-button",createItems:function(chaptersTrack){var items=[];this.each(this.player.textTracks,function(track){if(track.kind===this.kind){items.push(new _V_.TextTrackMenuItem(this.player,{track:track}));}});return items;},createMenu:function(){var tracks=this.player.textTracks,i=0,j=tracks.length,track,chaptersTrack,items=this.items=[];for(;i<j;i++){track=tracks[i];if(track.kind==this.kind&&track["default"]){if(track.readyState<2){this.chaptersTrack=track;track.addEvent("loaded",this.proxy(this.createMenu));return;}else{chaptersTrack=track;break;}}}var menu=this.menu=new _V_.Menu(this.player);menu.el.appendChild(_V_.createElement("li",{className:"vjs-menu-title",innerHTML:_V_.uc(this.kind)}));if(chaptersTrack){var cues=chaptersTrack.cues,i=0,j=cues.length,cue,mi;for(;i<j;i++){cue=cues[i];mi=new _V_.ChaptersTrackMenuItem(this.player,{track:chaptersTrack,cue:cue});items.push(mi);menu.addComponent(mi);}}this.addComponent(menu);if(this.items.length>0){this.show();}return menu;}});_V_.ChaptersTrackMenuItem=_V_.MenuItem.extend({init:function(player,options){var track=this.track=options.track,cue=this.cue=options.cue,currentTime=player.currentTime();options.label=cue.text;options.selected=(cue.startTime<=currentTime&&currentTime<cue.endTime);this._super(player,options);track.addEvent("cuechange",_V_.proxy(this,this.update));},onClick:function(){this._super();this.player.currentTime(this.cue.startTime);this.update(this.cue.startTime);},update:function(time){var cue=this.cue,currentTime=this.player.currentTime();if(cue.startTime<=currentTime&&currentTime<cue.endTime){this.selected(true);}else{this.selected(false);}}});_V_.merge(_V_.ControlBar.prototype.options.components,{"subtitlesButton":{},"captionsButton":{},"chaptersButton":{}});_V_.autoSetup=function(){var options,vid,player,vids=document.getElementsByTagName("video");if(vids&&vids.length>0){for(var i=0,j=vids.length;i<j;i++){vid=vids[i];if(vid&&vid.getAttribute){if(vid.player===undefined){options=vid.getAttribute("data-setup");if(options!==null){options=JSON.parse(options||"{}");player=_V_(vid,options);}}}else{_V_.autoSetupTimeout(1);break;}}}else if(!_V_.windowLoaded){_V_.autoSetupTimeout(1);}};_V_.autoSetupTimeout=function(wait){setTimeout(_V_.autoSetup,wait);};_V_.addEvent(window,"load",function(){_V_.windowLoaded=true;});_V_.autoSetup();window.VideoJS=window._V_=VideoJS;})(window);var indexmenu_contextmenu={'all':[]};jQuery(function(){jQuery('.indexmenu_nojs').each(function(){var $tree=jQuery(this);var jsajax=$tree.data('jsajax');$tree.dw_tree({toggle_selector:'a.indexmenu_idx',load_data:function(show_sublist,$clicky){jQuery.post(DOKU_BASE+'lib/exe/ajax.php','call=indexmenu&req=index&nojs=1&'+$clicky[0].search.substr(1)+'&max=1'+decodeURIComponent(jsajax),show_sublist,'html');}});});});var indexmenu_wiz={$wiz:null,timer:null,textArea:null,defaulttheme:'default',fields:{div1:{elems:{js:{}}},div2:{tlbclass:'js theme',elems:{el1:{headerid:'theme'}}},div3:{elems:{el2:{headerid:'navigation'},navbar:{},context:{},nocookie:{tlbclass:'js'},noscroll:{tlbclass:'js'},notoc:{tlbclass:'js'}}},div4:{elems:{el3:{headerid:'sort'},tsort:{},dsort:{},msort:{},hsort:{},rsort:{},nsort:{}}},div5:{elems:{el4:{headerid:'filter'},nons:{},nopg:{}}},div6:{tlbclass:'js',elems:{el5:{headerid:'performance'},max:{tlbclass:'js',number:['maxn','maxm']},maxjs:{tlbclass:'js',number:['maxjsn']},id:{tlbclass:'js',number:['idn']}}}},init:function($editor){var pos=$editor.position();indexmenu_wiz.$wiz=jQuery(document.createElement('div')).dialog({autoOpen:false,draggable:true,title:LANG.plugins.indexmenu.indexmenuwizard,resizable:false}).html('<fieldset class="index"><legend>'+LANG.plugins.indexmenu.index+'</legend>'+'<div><label>'+LANG.plugins.indexmenu.namespace+'<input id="namespace" type="text"></label></div>'+'<div><label class="number">'+LANG.plugins.indexmenu.nsdepth+' #<input id="nsdepth" type="text" value=1></label></div>'+'</fieldset>'+'<fieldset class="options"><legend>'+LANG.plugins.indexmenu.options+'</legend>'+'</fieldset>'+'<input type="submit" value="'+LANG.plugins.indexmenu.insert+'" class="button" id="indexmenu__insert">'+'<fieldset class="metanumber">'+'<label class="number">'+LANG.plugins.indexmenu.metanum+'<input type="text" id="metanumber"></label>'+'<input type="submit" value="'+LANG.plugins.indexmenu.insertmetanum+'" class="button" id="indexmenu__insertmetanum">'+'</fieldset>').parent().attr('id','indexmenu__wiz').css({'position':'absolute','top':(pos.top+20)+'px','left':(pos.left+80)+'px'}).hide().appendTo('.dokuwiki:first');indexmenu_wiz.textArea=$editor[0];var $opt_fieldset=jQuery('#indexmenu__wiz fieldset.options');jQuery.each(indexmenu_wiz.fields,function(i,section){var div=jQuery('<div>').addClass(section.tlbclass);jQuery.each(section.elems,function(elid,props){if(props.headerid){div.append('<strong>'+LANG.plugins.indexmenu[props.headerid]+'</strong><br />');}else{jQuery("<label>").addClass(props.tlbclass).addClass(props.number?' num':'').html('<input id="'+elid+'" type="checkbox">'+elid).attr({title:LANG.plugins.indexmenu[elid]}).appendTo(div);if(props.number){jQuery.each(props.number,function(j,numid){jQuery("<label>").attr({title:LANG.plugins.indexmenu[elid]}).addClass("number "+props.tlbclass).html('#<input type="text" id="'+numid+'">').appendTo(div);});}}});$opt_fieldset.append(div);});indexmenu_wiz.includeThemes();if(JSINFO&&JSINFO.namespace){jQuery('#namespace').val(':'+JSINFO.namespace);}jQuery('#js').change(function(){jQuery('#indexmenu__wiz .js').toggle(this.checked);}).change().parent().css({display:'inline-block',width:'40px'});jQuery('label.number input').bind('keydown keyup',function(){indexmenu_wiz.filterNumberinput(this);indexmenu_wiz.autoCheckboxForNumbers(this);});jQuery('#indexmenu__insert').click(indexmenu_wiz.insertIndexmenu);jQuery('#indexmenu__insertmetanum').click(indexmenu_wiz.insertMetaNumber);jQuery('#indexmenu__wiz').find('.ui-dialog-titlebar-close').click(indexmenu_wiz.hide);},includeThemes:function(){var addButtons=function(data){var $themebar=jQuery('<div>').attr('id','themebar').addClass('toolbar').appendTo('div.theme');jQuery.each(data.themes,function(i,theme){var themeName=theme.split('.');var $ico=jQuery('<div>').css({background:'url('+DOKU_BASE+data.themebase+'/'+theme+'/base.'+IndexmenuUtils.determineExtension(theme)+') no-repeat center'});var $btn=jQuery('<button>').addClass('themebutton toolbutton').attr('id',theme).attr('title',themeName[0]).append($ico).click(indexmenu_wiz.selectTheme).appendTo('div#themebar');});jQuery('#themebar button#'+indexmenu_wiz.defaulttheme).click();};jQuery.post(DOKU_BASE+'lib/exe/ajax.php',{call:'indexmenu',req:'local'},addButtons,'json');},selectTheme:function(){jQuery('.themebutton').toggleClass('selected',false);jQuery(this).toggleClass('selected',true);},filterNumberinput:function(elem){if(elem.value.match(/\D/)){elem.value=this.value.replace(/\D/g,'');}},autoCheckboxForNumbers:function(elem){var checkboxid=elem.id.substr(0,elem.id.length-1);var value=elem.value;if(elem.id=='maxm'&&!(elem.value>0)){value=parseInt(jQuery('input#maxn').val());}jQuery('input#'+checkboxid).prop('checked',value>0);},insertIndexmenu:function(){var options='';jQuery('fieldset.options input').each(function(i,input){var $label=jQuery(this).parent();if(input.checked&&(!$label.hasClass('js')||jQuery('input#js').is(':checked'))){options+=' '+input.id;if($label.hasClass('num')){jQuery.each(indexmenu_wiz.fields.div6.elems[input.id].number,function(j,numid){var num=parseInt(jQuery('input#'+numid).val());options+=num?'#'+num:'';});}if(input.id=='js'){var themename=jQuery('#themebar button.selected').attr('id');if(indexmenu_wiz.defaulttheme!==themename){options+='#'+jQuery('#themebar button.selected').attr('id');}}}});options=options?'|'+jQuery.trim(options):'';var sel,ns,depth,syntax,eo;if(DWgetSelection){sel=DWgetSelection(indexmenu_wiz.textArea);}else{sel=getSelection(indexmenu_wiz.textArea);}ns=jQuery('#namespace').val();depth=parseInt(jQuery('#nsdepth').val());depth=depth?'#'+depth:'';syntax='{{indexmenu>'+ns+depth+options+'}}';eo=depth.length+options.length+2;pasteText(sel,syntax,{startofs:12,endofs:eo});indexmenu_wiz.hide();},insertMetaNumber:function(){var sel,selnum,syntax,number;if(DWgetSelection){sel=DWgetSelection(indexmenu_wiz.textArea);}else{sel=getSelection(indexmenu_wiz.textArea);}selnum=parseInt(sel.getText());number=parseInt(jQuery('input#metanumber').val());number=number||selnum||1;syntax='{{indexmenu_n>'+number+'}}';pasteText(sel,syntax,{startofs:14,endofs:2});indexmenu_wiz.hide();},show:function(){if(DWgetSelection){indexmenu_wiz.selection=DWgetSelection(indexmenu_wiz.textArea);}else{indexmenu_wiz.selection=getSelection(indexmenu_wiz.textArea);}indexmenu_wiz.$wiz.show();jQuery('#namespace').focus();},hide:function(){indexmenu_wiz.$wiz.hide();indexmenu_wiz.textArea.focus();},toggle:function(){if(indexmenu_wiz.$wiz.css('display')=='none'){indexmenu_wiz.show();}else{indexmenu_wiz.hide();}}};indexmenu_contextmenu['all']['pg']={'view':[['<span class="indexmenu_titlemenu"><b>'+LANG.plugins.indexmenu.page+'</b></span>'],[LANG.plugins.indexmenu.revs,'IndexmenuContextmenu.getid(index.config.urlbase,id)+"do=revisions"'],[LANG.plugins.indexmenu.tocpreview,'"javascript: IndexmenuContextmenu.createTocMenu(\'call=indexmenu&req=toc&id="+id+"\',\'picker_"+index.obj+"\',\'s"+index.obj+node.id+"\');"']],'edit':[['<span class="indexmenu_titlemenu"><b>'+LANG.plugins.indexmenu.editmode+'</b></span>'],[LANG.plugins.indexmenu.insertdwlink,'"javascript: IndexmenuContextmenu.insertTags(\'"+id+"\',\'"+index.config.sepchar+"\');"+index.obj+".divdisplay(\'r\',0);"',LANG.plugins.indexmenu.insertdwlinktooltip]]};indexmenu_contextmenu['all']['ns']={'view':[['<span class="indexmenu_titlemenu"><b>'+LANG.plugins.indexmenu.ns+'</b></span>'],[LANG.plugins.indexmenu.search,'"javascript: IndexmenuContextmenu.srchpage(\'"+index.config.urlbase+"\',\'"+index.config.sepchar+"\',\'"+node.isdir+"\',\'"+node.dokuid+"\');"',LANG.plugins.indexmenu.searchtooltip]]};if(JSINFO&&JSINFO.isadmin){indexmenu_contextmenu['pg']={'view':[[LANG.plugins.indexmenu.edit,'IndexmenuContextmenu.getid(index.config.urlbase,id)+"do=edit"'],['<em>'+LANG.plugins.indexmenu.create+'--></em>',[[LANG.plugins.indexmenu.headpage,'"javascript: IndexmenuContextmenu.reqpage(\'"+index.config.urlbase+"\',\'"+index.config.sepchar+"\',\'"+node.dokuid+"\',\'"+node.name+"\');"',LANG.plugins.indexmenu.headpagetooltip],[LANG.plugins.indexmenu.startpage,'IndexmenuContextmenu.getid(index.config.urlbase,id+index.config.sepchar+"start")+"do=edit"',LANG.plugins.indexmenu.startpagetooltip],[LANG.plugins.indexmenu.custompage,'"javascript: IndexmenuContextmenu.reqpage(\'"+index.config.urlbase+"\',\'"+index.config.sepchar+"\',\'"+node.dokuid+"\');"',LANG.plugins.indexmenu.custompagetooltip]]],['<em>'+LANG.plugins.indexmenu.more+'--></em>',[[LANG.plugins.indexmenu.acls,'IndexmenuContextmenu.getid(index.config.urlbase,id)+"do=admin&page=acl"'],[LANG.plugins.indexmenu.purgecache,'IndexmenuContextmenu.getid(index.config.urlbase,id)+"purge=true"'],[LANG.plugins.indexmenu.exporthtml,'IndexmenuContextmenu.getid(index.config.urlbase,id)+"do=export_xhtml"'],[LANG.plugins.indexmenu.exporttext,'IndexmenuContextmenu.getid(index.config.urlbase,id)+"do=export_raw"']]]]};indexmenu_contextmenu['ns']={'view':[[LANG.plugins.indexmenu.newpage,'"javascript: IndexmenuContextmenu.reqpage(\'"+index.config.urlbase+"\',\'"+index.config.sepchar+"\',\'"+node.dokuid+"\');"',LANG.plugins.indexmenu.newpagetooltip],['<em>'+LANG.plugins.indexmenu.more+'--></em>',[[LANG.plugins.indexmenu.headpagehere,'"javascript: IndexmenuContextmenu.reqpage(\'"+index.config.urlbase+"\',\'"+index.config.sepchar+"\',\'"+node.dokuid+"\',\'"+node.name+"\');"',LANG.plugins.indexmenu.headpageheretooltip],[LANG.plugins.indexmenu.acls,'IndexmenuContextmenu.getid(index.config.urlbase,node.dokuid)+"do=admin&page=acl"']]]]};}else if(JSINFO&&JSINFO.isauth){indexmenu_contextmenu['pg']={'view':[[LANG.plugins.indexmenu.newpagehere,'"javascript: IndexmenuContextmenu.reqpage(\'"+index.config.urlbase+"\',\'"+index.config.sepchar+"\',\'"+node.dokuid+"\');"'],['Edit','IndexmenuContextmenu.getid(index.config.urlbase,id)+"do=edit"',1,0],['<em>'+LANG.plugins.indexmenu.more+'--></em>',[[LANG.plugins.indexmenu.headpagehere,'"javascript: IndexmenuContextmenu.reqpage(\'"+index.config.urlbase+"\',\'"+index.config.sepchar+"\',\'"+node.dokuid+"\',\'"+node.name+"\');"'],[LANG.plugins.indexmenu.purgecache,'IndexmenuContextmenu.getid(index.config.urlbase,id)+"purge=true"'],[LANG.plugins.indexmenu.exporthtml,'IndexmenuContextmenu.getid(index.config.urlbase,id)+"do=export_xhtml"']]]]};}var IndexmenuContextmenu={srchpage:function(u,s,isdir,nid){var r=prompt(LANG.plugins.indexmenu.insertkeywords,"");if(r){var fnid=nid;if(isdir=="0"){fnid=fnid.substring(0,nid.lastIndexOf(s));}var b=u,re=new RegExp(s,'g');fnid=fnid.replace(re,":");b+=(u.indexOf("?id=")<0)?'?id=':'';window.location.href=IndexmenuContextmenu.getid(b,r+" @"+fnid)+"do=search";}},getid:function(u,id){var url=(u||'')+encodeURI(id||'');url+=(u.indexOf("?")<0)?'?':'&';return url;},reqpage:function(b,s,id,n){var r;if(n){r=id+s+n;}else{r=prompt(LANG.plugins.indexmenu.insertpagename,"");if(!r){return;}r=id+s+r;}if(r)window.location.href=IndexmenuContextmenu.getid(b,r)+"do=edit";},insertTags:function(lnk,sep){var r,l=lnk;if(sep){r=new RegExp(sep,"g");l=lnk.replace(r,':');}insertTags('wiki__text','[[',']]',l);},createTocMenu:function(get,picker,btn){var $toc_picker=jQuery('#'+picker);if(!$toc_picker.length){$toc_picker=IndexmenuUtils.createPicker(picker,'indexmenu_toc');$toc_picker .html('<a href="#"><img src="'+DOKU_BASE+'lib/plugins/indexmenu/images/close.gif" class="indexmenu_close" /></a><div />').children().first().click(function(event){event.stopPropagation();return IndexmenuContextmenu.togglePicker($toc_picker,jQuery('#'+btn));});}else{$toc_picker.hide();}IndexmenuContextmenu.ajaxmenu(get,$toc_picker,jQuery('#'+btn),$toc_picker.children().last(),null);},ajaxmenu:function(get,$picker,$btn,$container,oncomplete){var $indx_list;$indx_list=$container||$picker;if(!IndexmenuContextmenu.togglePicker($picker,$btn))return;var onComplete=function(data){$indx_list.html('');if(typeof oncomplete=='function'){oncomplete(data,$indx_list);}else{$indx_list.html(data);}};jQuery.ajax({type:"POST",url:DOKU_BASE+'lib/exe/ajax.php',data:get,beforeSend:function(){$indx_list.html('<div class="tocheader">'+LANG.plugins.indexmenu.loading+'</div>');},success:onComplete,dataType:'html'});},togglePicker:function($picker,$btn){var x=8,y=0;if(!$picker.is(':visible')){var pos=$btn.offset();x+=pos.left+$btn[0].offsetWidth;y+=pos.top;$picker .show().offset({left:x,top:y});return true;}else{$picker.hide();return false;}},arrconcat:function(amenu,index,n){var html,id,item,a,li;if(typeof amenu=='undefined'||typeof amenu['view']=='undefined'){return;}var cmenu=amenu['view'];if(jQuery('#tool__bar')[0]&&amenu['edit']instanceof Array){cmenu=amenu['edit'].concat(cmenu);}var node=index.aNodes[n];id=node.hns||node.dokuid;var createCMenuEntry=function(entry){return'<a title="'+((entry[2])?entry[2]:entry[0])+'" href="'+eval(entry[1])+'">'+entry[0]+'</a>';};jQuery.each(cmenu,function(i,cmenuentry){if(cmenuentry==''){return true;}item=document.createElement('li');var $cmenu=jQuery('#r'+index.obj);if(cmenuentry[1]){if(cmenuentry[1]instanceof Array){html=document.createElement('ul');jQuery.each(cmenuentry[1],function(a,subcmenuentry){li=document.createElement('li');li.innerHTML=createCMenuEntry(subcmenuentry);html.appendChild(li);});item.innerHTML='<span class="indexmenu_submenu">'+cmenuentry[0]+'</span>';html.left=$cmenu[0].width;item.appendChild(html);}else{item.innerHTML=createCMenuEntry(cmenuentry);}}else{item.innerHTML=cmenuentry;}$cmenu.children().last().append(item);});},mouseposition:function(obj,e){var X=0,Y=0;if(!e)e=window.event;if(e.pageX||e.pageY){X=e.pageX;Y=e.pageY;}else if(e.clientX||e.clientY){X=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;Y=e.clientY+document.body.scrollTop+document.documentElement.scrollTop;}obj.style.left=X-5+'px';obj.style.top=Y-5+'px';},checkcontextm:function(n,obj,e){e=e||event;if((e.which==3||e.button==2)||(window.opera&&e.which==1&&e.ctrlKey)){obj.contextmenu(n,e);IndexmenuContextmenu.stopevt(e);}},stopevt:function(e){if(!window.indexmenu_contextmenu){return true;}e=e||event;e.preventDefault?e.preventDefault():e.returnValue=false;return false;}};function dTreeNode(dokuid,id,pid,name,hns,isdir,ajax){this.dokuid=dokuid;this.id=id;this.pid=pid;this.name=name;this.hns=hns;this.isdir=isdir;this.ajax=ajax;this._io=0;this._is=false;this._ls=false;this._hc=ajax;this._ai=0;this._p=false;this._lv=0;this._ok=false;this._cp=false;this.icon='';this.iconOpen='';}function dTree(objName,theme){var objExt=IndexmenuUtils.determineExtension(theme);this.config={urlbase:DOKU_BASE+'doku.php?id=',plugbase:DOKU_BASE+'lib/plugins/indexmenu',useCookies:true,scroll:true,toc:true,maxjs:1,jsajax:'',sepchar:':',theme:theme};var objImg=this.config.plugbase+'/images/'+theme+'/';this.icon={root:objImg+'base.'+objExt,folder:objImg+'folder.'+objExt,folderH:objImg+'folderh.'+objExt,folderOpen:objImg+'folderopen.'+objExt,folderHOpen:objImg+'folderhopen.'+objExt,node:objImg+'page.'+objExt,empty:objImg+'empty.'+objExt,line:objImg+'line.'+objExt,join:objImg+'join.'+objExt,joinBottom:objImg+'joinbottom.'+objExt,plus:objImg+'plus.'+objExt,plusBottom:objImg+'plusbottom.'+objExt,minus:objImg+'minus.'+objExt,minusBottom:objImg+'minusbottom.'+objExt,nlPlus:objImg+'nolines_plus.'+objExt,nlMinus:objImg+'nolines_minus.'+objExt};this.obj=objName;this.aNodes=[];this.aIndent=[];this.root=new dTreeNode(false,-1);this.selectedNode=null;this.selectedFound=false;this.completed=false;this.scrllTmr=0;this.pageid=JSINFO.id||'';this.fajax=false;}dTree.prototype.add=function(dokuid,id,pid,name,hns,isdir,ajax){this.aNodes[this.aNodes.length]=new dTreeNode(dokuid,id,pid,name,hns,isdir,ajax);};dTree.prototype.openAll=function(){if(!this.getCookie('co'+this.obj)){this.oAll(true);}};dTree.prototype.toString=function(){var str='';this.pageid=this.pageid.replace(/:/g,this.config.sepchar);if(this.config.scroll){str+='<div id="cdtree_'+this.obj+'" class="dtree" style="position:relative;overflow:hidden;width:100%;">';}str+='<div id="dtree_'+this.obj+'" class="dtree '+this.config.theme+'" style="overflow:';if(this.config.scroll){str+='visible;position:relative;width:100%"';}else{str+='hidden;"';}str+='>';if(jQuery('#dtree_'+this.obj)[0]){str+='<div class="error">Indexmenu id conflict</div>';}if(this.config.toc){str+='<div id="t'+this.obj+'" class="indexmenu_tocbullet '+this.config.theme+'" style="display:none;" title="Table of contents"></div>';str+='<div id="toc_'+this.obj+'" style="display:none;"></div>';}if(this.config.useCookies){this.selectedNode=this.getSelected();}str+=this.addNode(this.root)+'</div>';if(this.config.scroll){str+='<div id="z'+this.obj+'" class="indexmenu_rarrow"></div>';str+='<div id="left_'+this.obj+'" class="indexmenu_larrow" style="display:none;" title="Click to scroll back" onmousedown="javascript:'+this.obj+'.scroll(\'r\',1);" onmouseup="javascript:'+this.obj+'.stopscroll();"></div>';str+='</div>';}this.completed=true;jQuery('#nojs_'+this.obj).css("display","none");return str;};dTree.prototype.addNode=function(pNode){var str='',cn,n=pNode._ai,l=pNode._lv+1;for(n;n<this.aNodes.length;n++){if(this.aNodes[n].pid==pNode.id){cn=this.aNodes[n];cn._p=pNode;cn._ai=n;cn._lv=l;this.setCS(cn);if(cn._hc&&!cn._io&&this.config.useCookies){cn._io=this.isOpen(cn.id);}if(this.pageid==(!cn.hns&&cn.dokuid||cn.hns)){cn._cp=true;}else if(cn.id==this.selectedNode&&!this.selectedFound){cn._is=true;this.selectedNode=n;this.selectedFound=true;}if(!cn._hc&&cn.isdir&&!cn.ajax&&!cn.hns){if(cn._ls){str+=this.noderr(cn,n);}}else{str+=this.node(cn,n);}if(cn._ls){break;}}}return str;};dTree.prototype.noderr=function(node,nodeId){var str='<div class="dTreeNode">'+this.indent(node,nodeId);str+='<div class="emptynode" title="Empty"></div></div>';return str;};dTree.prototype.node=function(node,nodeId){var h=1,jsfnc,str;jsfnc='onmouseover="'+this.obj+'.show_feat(\''+nodeId+'\');" onmousedown="return IndexmenuContextmenu.checkcontextm(\''+nodeId+'\','+this.obj+',event);" oncontextmenu="return IndexmenuContextmenu.stopevt(event)"';if(node._lv>this.config.maxjs){h=0;}else{node._ok=true;}str='<div class="dTreeNode">'+this.indent(node,nodeId);node.icon=(this.root.id==node.pid)?this.icon.root:((node.hns)?this.icon.folderH:((node._hc)?this.icon.folder:this.icon.node));node.iconOpen=(node._hc)?((node.hns)?this.icon.folderHOpen:this.icon.folderOpen):this.icon.node;if(this.root.id==node.pid){node.icon=this.icon.root;node.iconOpen=this.icon.root;}str+='<img id="i'+this.obj+nodeId+'" src="'+((node._io)?node.iconOpen:node.icon)+'" alt="" />';if(!node._hc||node.hns){str+='<a id="s'+this.obj+nodeId+'" class="'+((node._cp)?'navSel':((node._is)?'nodeSel':(node._hc)?'nodeFdUrl':'nodeUrl'));str+='" href="'+this.config.urlbase;(node.hns)?str+=node.hns:str+=node.dokuid;str+='"'+' title="'+node.name+'"'+jsfnc;str+=' onclick="javascript: '+this.obj+'.s('+nodeId+');"';str+='>'+node.name+'</a>';}else if(node.pid!=this.root.id){str+='<a id="s'+this.obj+nodeId+'" href="javascript: '+this.obj+'.o('+nodeId+'); " class="node"'+jsfnc+'>'+node.name+'</a>';}else{str+=node.name;}str+='</div>';if(node._hc){str+='<div id="d'+this.obj+nodeId+'" class="clip" style="display:'+((this.root.id==node.pid||node._io)?'block':'none')+';">';if(h){str+=this.addNode(node);}str+='</div>';}this.aIndent.pop();return str;};dTree.prototype.indent=function(node,nodeId){var n,str='';if(this.root.id!=node.pid){for(n=0;n<this.aIndent.length;n++){str+='<img src="'+((this.aIndent[n]==1)?this.icon.line:this.icon.empty)+'" alt="" />';}if(node._ls){this.aIndent.push(0);}else{this.aIndent.push(1);}if(node._hc){str+='<a href="javascript: '+this.obj+'.o('+nodeId+');"><img id="j'+this.obj+nodeId+'" src="';str+=((node._io)?((node._ls)?this.icon.minusBottom:this.icon.minus):((node._ls)?this.icon.plusBottom:this.icon.plus));str+='" alt="" /></a>';}else{str+='<img src="'+((node._ls)?this.icon.joinBottom:this.icon.join)+'" alt="" />';}}return str;};dTree.prototype.setCS=function(node){var lastId,n;for(n=0;n<this.aNodes.length;n++){if(this.aNodes[n].pid==node.id){node._hc=true;}if(this.aNodes[n].pid==node.pid){lastId=this.aNodes[n].id;}}if(lastId==node.id){node._ls=true;}};dTree.prototype.getSelected=function(){var sn=this.getCookie('cs'+this.obj);return(sn)?parseInt(sn,10):null;};dTree.prototype.s=function(id){var eOld,eNew,cn=this.aNodes[id];if(this.selectedNode!=id){eNew=jQuery("#s"+this.obj+id)[0];if(!eNew){return;}if(this.selectedNode||this.selectedNode===0){eOld=jQuery("#s"+this.obj+this.selectedNode)[0];eOld.className="node";}eNew.className="nodeSel";this.selectedNode=id;if(this.config.useCookies){this.setCookie('cs'+this.obj,cn.id);}}};dTree.prototype.o=function(id){var cn=this.aNodes[id];this.nodeStatus(!cn._io,id,cn._ls);cn._io=!cn._io;if(this.config.useCookies){this.updateCookie();}this.divdisplay('z',0);this.resizescroll("block");};dTree.prototype.oAll=function(status){for(var n=0;n<this.aNodes.length;n++){if(this.aNodes[n]._hc&&this.aNodes[n].pid!=this.root.id){this.nodeStatus(status,n,this.aNodes[n]._ls);this.aNodes[n]._io=status;}}if(this.config.useCookies){this.updateCookie();}};dTree.prototype.openTo=function(nId,bSelect,bFirst){var n,cn;if(!bFirst){for(n=0;n<this.aNodes.length;n++){if(this.aNodes[n].id==nId){nId=n;break;}}}this.fill(this.aNodes[nId].pid);cn=this.aNodes[nId];if(cn.pid==this.root.id||!cn._p){return;}cn._io=1;if(this.completed&&cn._hc){this.nodeStatus(true,cn._ai,cn._ls);}if(cn._is){(this.completed)?this.s(cn._ai):this._sn=cn._ai;}this.openTo(cn._p._ai,false,true);};dTree.prototype.getOpenTo=function(nodes){if(nodes===''){this.openAll();}else if(!this.config.useCookies||!this.getCookie('co'+this.obj)){for(var n=0;n<nodes.length;n++){this.openTo(nodes[n],false,true);}}};dTree.prototype.nodeStatus=function(status,id,bottom){if(status&&!this.fill(id)){return;}var eJoin,eIcon;eJoin=jQuery('#j'+this.obj+id)[0];eIcon=jQuery('#i'+this.obj+id)[0];eIcon.src=(status)?this.aNodes[id].iconOpen:this.aNodes[id].icon;eJoin.src=((status)?((bottom)?this.icon.minusBottom:this.icon.minus):((bottom)?this.icon.plusBottom:this.icon.plus));jQuery('#d'+this.obj+id)[0].style.display=(status)?'block':'none';};dTree.prototype.clearCookie=function(){var now,yday;now=new Date();yday=new Date(now.getTime()-1000*60*60*24);this.setCookie('co'+this.obj,'cookieValue',yday);this.setCookie('cs'+this.obj,'cookieValue',yday);};dTree.prototype.setCookie=function(cookieName,cookieValue,expires,path,domain,secure){document.cookie=encodeURIComponent(cookieName)+'='+encodeURIComponent(cookieValue)+(expires?'; expires='+expires.toUTCString():'')+';path=/'+(domain?'; domain='+domain:'')+(secure?'; secure':'');};dTree.prototype.getCookie=function(cookieName){var cookieValue='',pN,posValue,endPos;pN=document.cookie.indexOf(encodeURIComponent(cookieName)+'=');if(pN!=-1){posValue=pN+(encodeURIComponent(cookieName)+'=').length;endPos=document.cookie.indexOf(';',posValue);if(endPos!=-1){cookieValue=decodeURIComponent(document.cookie.substring(posValue,endPos));}else{cookieValue=decodeURIComponent(document.cookie.substring(posValue));}}return(cookieValue);};dTree.prototype.updateCookie=function(){var str='',n;for(n=0;n<this.aNodes.length;n++){if(this.aNodes[n]._io&&this.aNodes[n].pid!=this.root.id){if(str){str+='.';}str+=this.aNodes[n].id;}}this.setCookie('co'+this.obj,str);};dTree.prototype.isOpen=function(id){var n,aOpen=this.getCookie('co'+this.obj).split('.');for(n=0;n<aOpen.length;n++){if(aOpen[n]==id){return true;}}return false;};dTree.prototype.openCurNS=function(max){var r,cn,match,t,i,n,cnsa,cna;var cns=this.pageid;r=new RegExp("\\b"+this.config.sepchar+"\\b","g");match=cns.match(r)||-1;if(max>0&&match.length>=max){t=cns.split(this.config.sepchar);n=(this.aNodes[0].dokuid=='')?0:this.aNodes[0].dokuid.split(this.config.sepchar).length;t.splice(max+n,t.length);cnsa=t.join(this.config.sepchar);}for(i=0;i<this.aNodes.length;i++){cn=this.aNodes[i];if(cns==cn.dokuid||cns==cn.hns){this.openTo(cn.id,false,true);this.fajax=false;if(cn.pid>=0){jQuery(this.scroll("l",4,cn.pid,1));}break;}if(cnsa==cn.dokuid||cnsa==cn.hns){cna=cn;this.fajax=true;}}if(cna){this.openTo(cna.id,false,true);}};dTree.prototype.fill=function(id){if(id==-1||this.aNodes[id]._ok){return true;}var n=id,$eLoad,a,rd,ln,eDiv;if(this.aNodes[n].ajax){$eLoad=jQuery('#l'+this.obj);if(!$eLoad.length){$eLoad=IndexmenuUtils.createPicker('l'+this.obj);}jQuery('#s'+this.obj+n).parent().append($eLoad);$eLoad .html('Loading ...').css({width:'auto'}).show();this.getAjax(n);return true;}rd=[];while(!this.aNodes[n]._ok){rd[rd.length]=n;n=this.aNodes[n].pid;}for(ln=rd.length-1;ln>=0;ln--){id=rd[ln];a=this.aNodes[id];eDiv=jQuery('#d'+this.obj+id)[0];if(!eDiv){return false;}this.aIndent=[];n=a;while(n.pid>=0){if(n._ls){this.aIndent.unshift(0);}else{this.aIndent.unshift(1);}n=n._p;}eDiv.innerHTML=this.addNode(a);a._ok=true;}return true;};dTree.prototype.openCookies=function(){var n,cn,aOpen=this.getCookie('co'+this.obj).split('.');for(n=0;n<aOpen.length;n++){if(aOpen[n]===""){break;}cn=this.aNodes[aOpen[n]];if(!cn._ok){this.nodeStatus(true,aOpen[n],cn._ls);cn._io=1;}}};dTree.prototype.scroll=function(where,s,n,i){if(!this.config.scroll){return false;}var w,dtree,dtreel,nodeId;dtree=jQuery('#dtree_'+this.obj)[0];dtreel=parseInt(dtree.offsetLeft,0);if(where=="r"){jQuery('#left_'+this.obj)[0].style.border="thin inset";this.scrollRight(dtreel,s);}else{nodeId=jQuery('#s'+this.obj+n)[0];if(nodeId==null){return false;}w=parseInt(dtree.parentNode.offsetWidth-nodeId.offsetWidth-nodeId.offsetLeft,0);if(this.config.toc){w=w-11;}if(dtreel<=w){return;}this.resizescroll("none");this.stopscroll();this.scrollLeft(dtreel,s,w-3,i);}};dTree.prototype.scrollLeft=function(lft,s,w,i){if(lft<w-i-10){this.divdisplay('z',0);this.scrllTmr=0;return;}var self=this;jQuery('#dtree_'+self.obj)[0].style.left=lft+"px";this.scrllTmr=setTimeout(function(){self.scrollLeft(lft-s,s+i,w,i);},20);};dTree.prototype.scrollRight=function(lft,s){if(lft>=s){this.divdisplay('left_',0);this.stopscroll();return;}var self=this;jQuery('#dtree_'+self.obj)[0].style.left=lft+"px";if(lft>-15){s=1;}this.scrllTmr=setTimeout(function(){self.scrollRight(lft+s,s+1);},20);};dTree.prototype.stopscroll=function(){jQuery('#left_'+this.obj)[0].style.border="none";clearTimeout(this.scrllTmr);this.scrllTmr=0;};dTree.prototype.show_feat=function(n){var w,div,id,dtree,dtreel,self,node=jQuery('#s'+this.obj+n)[0];self=this;if(this.config.toc&&node.className!="node"){div=jQuery('#t'+this.obj)[0];id=(this.aNodes[n].hns)?this.aNodes[n].hns:this.aNodes[n].dokuid;div.onmousedown=function(){IndexmenuContextmenu.createTocMenu('call=indexmenu&req=toc&id='+decodeURIComponent(id),'picker_'+self.obj,'t'+self.obj);};node.parentNode.appendChild(div);if(div.style.display=="none"){div.style.display="inline";}}if(this.config.scroll){div=jQuery('#z'+this.obj)[0];div.onmouseover=function(){div.style.border="none";self.scroll("l",1,n,0);};div.onmousedown=function(){div.style.border="thin inset";self.scroll("l",4,n,1);};div.onmouseout=function(){div.style.border="none";self.stopscroll();};div.onmouseup=div.onmouseover;dtree=jQuery('#dtree_'+this.obj)[0];dtreel=parseInt(dtree.offsetLeft,0);w=parseInt(dtree.parentNode.offsetWidth-node.offsetWidth-node.offsetLeft+1,0);if(dtreel>w){div.style.display="none";div.style.top=node.offsetTop+"px";div.style.left=parseInt(node.offsetLeft+node.offsetWidth+w-12,0)+"px";div.style.display="block";}}};dTree.prototype.resizescroll=function(status){var dtree,w,h,left=jQuery('#left_'+this.obj)[0];if(!left){return;}if(left.style.display==status){dtree=jQuery('#dtree_'+this.obj)[0];w=parseInt(dtree.offsetHeight/3,0);h=parseInt(w/50,0)*50;if(h<50){h=50;}left.style.height=h+"px";left.style.top=w+"px";if(status=="none"){left.style.display="block";}}};dTree.prototype.getAjax=function(n){var node,req,curns,selft=this;node=selft.aNodes[n];req='call=indexmenu&req=index&idx='+node.dokuid+decodeURIComponent(this.config.jsajax);curns=this.pageid.substring(0,this.pageid.lastIndexOf(this.config.sepchar));if(this.fajax){req+='&nss='+curns+'&max=1';}var onCompletion=function(data){var i,ajxnodes,ajxnode,plus;plus=selft.aNodes.length-1;eval(data);if(!ajxnodes instanceof Array||ajxnodes.length<1){ajxnodes=[['',1,0,'',0,1,0]];}node.ajax=false;for(i=0;i<ajxnodes.length;i++){ajxnode=ajxnodes[i];ajxnode[2]=(ajxnode[2]==0)?node.id:ajxnode[2]+plus;ajxnode[1]+=plus;selft.add(ajxnode[0],ajxnode[1],ajxnode[2],ajxnode[3],ajxnode[4],ajxnode[5],ajxnode[6]);}if(selft.fajax){selft.fajax=false;selft.openCurNS(0);}else{selft.openTo(node.id,false,true);}jQuery('#l'+selft.obj).hide();};jQuery.post(DOKU_BASE+'lib/exe/ajax.php','call=indexmenu&'+req,onCompletion,'html');};dTree.prototype.loadCss=function(){var oLink=document.createElement("link");oLink.href=this.config.plugbase+'/images/'+this.config.theme+'/style.css';oLink.rel="stylesheet";oLink.type="text/css";document.getElementsByTagName('head')[0].appendChild(oLink);};dTree.prototype.contextmenu=function(n,e){var type,node,cdtree,rmenu;cdtree=jQuery("#cdtree_"+this.obj)[0];rmenu=jQuery('#r'+this.obj)[0];if(!rmenu){return true;}IndexmenuContextmenu.mouseposition(rmenu,e);var cmenu=window.indexmenu_contextmenu;node=this.aNodes[n];rmenu.innerHTML='<div class="indexmenu_rmenuhead" title="'+node.name+'">'+node.name+"</div>";rmenu.appendChild(document.createElement('ul'));type=(node.isdir||node._hc)?'ns':'pg';IndexmenuContextmenu.arrconcat(cmenu['all'][type],this,n);if(node.hns){IndexmenuContextmenu.arrconcat(cmenu[type],this,n);type='pg';IndexmenuContextmenu.arrconcat(cmenu['all'][type],this,n);}IndexmenuContextmenu.arrconcat(cmenu[type],this,n);rmenu.style.display='inline';return false;};dTree.prototype.divdisplay=function(obj,visible){var o=jQuery('#'+obj+this.obj)[0];if(!o){return;}(visible)?o.style.display='inline':o.style.display='none';};dTree.prototype.init=function(hasstyle,nocookies,opennodes,nav,max,nomenu){if(hasstyle){this.loadCss();}if(!nocookies){this.openCookies();}if(opennodes){this.getOpenTo(opennodes.split(" "));}if(nav){this.openCurNS(max);}if(!nomenu){var self=this;IndexmenuUtils.createPicker('r'+this.obj,'indexmenu_rmenu '+this.config.theme);jQuery('#r'+this.obj)[0].oncontextmenu=IndexmenuContextmenu.stopevt;jQuery(document).click(function(){self.divdisplay('r',0);});}};function addBtnActionIndexmenu($btn,props,edid){indexmenu_wiz.init(jQuery('#'+edid));$btn.click(function(){indexmenu_wiz.toggle();return false;});return true;}if(window.toolbar!=undefined){window.toolbar[window.toolbar.length]={"type":"Indexmenu","title":"Insert the Indexmenu tree","icon":"../../plugins/indexmenu/images/indexmenu_toolbar.png"}}var IndexmenuUtils={determineExtension:function(themedir){var extension="gif";var posext=themedir.lastIndexOf(".");if(posext>-1){posext++;var ext=themedir.substring(posext,themedir.length).toLowerCase();if((ext=="png")||(ext=="jpg")){extension=ext;}}return extension;},createPicker:function(id,cl){return jQuery('<div>').addClass(cl||'picker').attr('id',id).css({position:'absolute'}).hide().appendTo('body');}};function approval_checkbox(text){if(text==""){return true;}var cb=document.getElementById('approved');if(cb==null){return true;}if(!cb.checked){return true;}var sum=document.getElementById('edit__summary');if(sum==null){return true;}if(sum.value!=''){return true;}sum.value=text;var btn=document.getElementById('edbtn__save');if(btn==null){return true;}btn.className='button';btn.disabled=false;return true;}jQuery(document).ready(function(){jQuery('button.publish__approveNS').click(function(evt){var $_this=jQuery(this);var namespace=$_this.attr('ns');jQuery.post(DOKU_BASE+'lib/exe/ajax.php',{call:'plugin_publish_approveNS',namespace:namespace},function(data){$_this.parent().parent().siblings('tr.apr_table').each(function(index){var id=jQuery(this).find('a').first().text();var pageNamespace=id.substr(0,id.lastIndexOf(':'));if(pageNamespace===namespace){jQuery(this).hide('slow');}});$_this.parent().parent().hide('slow');},'json');});});jQuery(function(){jQuery('.searchform__qsearch_in').each(function(i,input){var $input=jQuery(input);var $form=$input.parent().parent();var $output=$form.find('.searchform__qsearch_out');var $ns=$form.find('.searchform__ns');$input.dw_qsearch({output:$output,getSearchterm:function(){var query=$input.val(),reg=new RegExp("(?:^| )(?:@|ns:)[\\w:]+");if(reg.test(query)){return query;}else{var namespace=$ns.val();return query+(namespace?' @'+namespace:'');}}});});});(function($,undef){var _html,nonGradientIE,gradientType,vendorPrefixes,_css,Iris,UA,isIE,IEVersion;_html='<div class="iris-picker"><div class="iris-picker-inner"><div class="iris-square"><a class="iris-square-value" href="#"><span class="iris-square-handle ui-slider-handle"></span></a><div class="iris-square-inner iris-square-horiz"></div><div class="iris-square-inner iris-square-vert"></div></div><div class="iris-slider iris-strip"><div class="iris-slider-offset"></div></div></div></div>';_css='.iris-picker{display:block;position:relative}.iris-picker,.iris-picker *{-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}input+.iris-picker{margin-top:4px}.iris-error{background-color:#ffafaf}.iris-border{border-radius:3px;border:1px solid #aaa;width:200px;background-color:#fff}.iris-picker-inner{position:absolute;top:0;right:0;left:0;bottom:0}.iris-border .iris-picker-inner{top:10px;right:10px;left:10px;bottom:10px}.iris-picker .iris-square-inner{position:absolute;left:0;right:0;top:0;bottom:0}.iris-picker .iris-square,.iris-picker .iris-slider,.iris-picker .iris-square-inner,.iris-picker .iris-palette{border-radius:3px;box-shadow:inset 0 0 5px rgba(0,0,0,.4);height:100%;width:12.5%;float:left;margin-right:5%}.iris-picker .iris-square{width:76%;margin-right:10%;position:relative}.iris-picker .iris-square-inner{width:auto;margin:0}.iris-ie-9 .iris-square,.iris-ie-9 .iris-slider,.iris-ie-9 .iris-square-inner,.iris-ie-9 .iris-palette{box-shadow:none;border-radius:0}.iris-ie-9 .iris-square,.iris-ie-9 .iris-slider,.iris-ie-9 .iris-palette{outline:1px solid rgba(0,0,0,.1)}.iris-ie-lt9 .iris-square,.iris-ie-lt9 .iris-slider,.iris-ie-lt9 .iris-square-inner,.iris-ie-lt9 .iris-palette{outline:1px solid #aaa}.iris-ie-lt9 .iris-square .ui-slider-handle{outline:1px solid #aaa;background-color:#fff;-ms-filter:"alpha(Opacity=30)"}.iris-ie-lt9 .iris-square .iris-square-handle{background:0;border:3px solid #fff;-ms-filter:"alpha(Opacity=50)"}.iris-picker .iris-strip{margin-right:0;position:relative}.iris-picker .iris-strip .ui-slider-handle{position:absolute;background:0;margin:0;right:-3px;left:-3px;border:4px solid #aaa;border-width:4px 3px;width:auto;height:6px;border-radius:4px;box-shadow:0 1px 2px rgba(0,0,0,.2);opacity:.9;z-index:5;cursor:ns-resize}.iris-strip .ui-slider-handle:before{content:" ";position:absolute;left:-2px;right:-2px;top:-3px;bottom:-3px;border:2px solid #fff;border-radius:3px}.iris-picker .iris-slider-offset{position:absolute;top:11px;left:0;right:0;bottom:-3px;width:auto;height:auto;background:transparent;border:0;border-radius:0}.iris-picker .iris-square-handle{background:transparent;border:5px solid #aaa;border-radius:50%;border-color:rgba(128,128,128,.5);box-shadow:none;width:12px;height:12px;position:absolute;left:-10px;top:-10px;cursor:move;opacity:1;z-index:10}.iris-picker .ui-state-focus .iris-square-handle{opacity:.8}.iris-picker .iris-square-handle:hover{border-color:#999}.iris-picker .iris-square-value:focus .iris-square-handle{box-shadow:0 0 2px rgba(0,0,0,.75);opacity:.8}.iris-picker .iris-square-handle:hover::after{border-color:#fff}.iris-picker .iris-square-handle::after{position:absolute;bottom:-4px;right:-4px;left:-4px;top:-4px;border:3px solid #f9f9f9;border-color:rgba(255,255,255,.8);border-radius:50%;content:" "}.iris-picker .iris-square-value{width:8px;height:8px;position:absolute}.iris-ie-lt9 .iris-square-value,.iris-mozilla .iris-square-value{width:1px;height:1px}.iris-palette-container{position:absolute;bottom:0;left:0;margin:0;padding:0}.iris-border .iris-palette-container{left:10px;bottom:10px}.iris-picker .iris-palette{margin:0;cursor:pointer}.iris-square-handle,.ui-slider-handle{border:0;outline:0}';UA=navigator.userAgent.toLowerCase();isIE=navigator.appName==='Microsoft Internet Explorer';IEVersion=isIE?parseFloat(UA.match(/msie ([0-9]{1,}[\.0-9]{0,})/)[1]):0;nonGradientIE=(isIE&&IEVersion<10);gradientType=false;vendorPrefixes=['-moz-','-webkit-','-o-','-ms-'];if(nonGradientIE&&IEVersion<=7){$.fn.iris=$.noop;$.support.iris=false;return;}$.support.iris=true;function testGradientType(){var el,base,bgImageString='backgroundImage';if(nonGradientIE){gradientType='filter';}else{el=$('<div id="iris-gradtest" />');base='linear-gradient(top,#fff,#000)';$.each(vendorPrefixes,function(i,val){el.css(bgImageString,val+base);if(el.css(bgImageString).match('gradient')){gradientType=i;return false;}});if(gradientType===false){el.css('background','-webkit-gradient(linear,0% 0%,0% 100%,from(#fff),to(#000))');if(el.css(bgImageString).match('gradient')){gradientType='webkit';}}el.remove();}}function createGradient(origin,stops){origin=(origin==='top')?'top':'left';stops=$.isArray(stops)?stops:Array.prototype.slice.call(arguments,1);if(gradientType==='webkit'){return legacyWebkitGradient(origin,stops);}else{return vendorPrefixes[gradientType]+'linear-gradient('+origin+', '+stops.join(', ')+')';}}function stupidIEGradient(origin,stops){var type,self,lastIndex,filter,startPosProp,endPosProp,dimensionProp,template,html;origin=(origin==='top')?'top':'left';stops=$.isArray(stops)?stops:Array.prototype.slice.call(arguments,1);type=(origin==='top')?0:1;self=$(this);lastIndex=stops.length-1;filter='filter';startPosProp=(type===1)?'left':'top';endPosProp=(type===1)?'right':'bottom';dimensionProp=(type===1)?'height':'width';template='<div class="iris-ie-gradient-shim" style="position:absolute;'+dimensionProp+':100%;'+startPosProp+':%start%;'+endPosProp+':%end%;'+filter+':%filter%;" data-color:"%color%"></div>';html='';if(self.css('position')==='static'){self.css({position:'relative'});}stops=fillColorStops(stops);$.each(stops,function(i,startColor){var endColor,endStop,filterVal;if(i===lastIndex){return false;}endColor=stops[i+1];if(startColor.stop===endColor.stop){return;}endStop=100-parseFloat(endColor.stop)+'%';startColor.octoHex=new Color(startColor.color).toIEOctoHex();endColor.octoHex=new Color(endColor.color).toIEOctoHex();filterVal='progid:DXImageTransform.Microsoft.Gradient(GradientType='+type+', StartColorStr=\''+startColor.octoHex+'\', EndColorStr=\''+endColor.octoHex+'\')';html+=template.replace('%start%',startColor.stop).replace('%end%',endStop).replace('%filter%',filterVal);});self.find('.iris-ie-gradient-shim').remove();$(html).prependTo(self);}function legacyWebkitGradient(origin,colorList){var stops=[];origin=(origin==='top')?'0% 0%,0% 100%,':'0% 100%,100% 100%,';colorList=fillColorStops(colorList);$.each(colorList,function(i,val){stops.push('color-stop('+(parseFloat(val.stop)/100)+', '+val.color+')');});return'-webkit-gradient(linear,'+origin+stops.join(',')+')';}function fillColorStops(colorList){var colors=[],percs=[],newColorList=[],lastIndex=colorList.length-1;$.each(colorList,function(index,val){var color=val,perc=false,match=val.match(/1?[0-9]{1,2}%$/);if(match){color=val.replace(/\s?1?[0-9]{1,2}%$/,'');perc=match.shift();}colors.push(color);percs.push(perc);});if(percs[0]===false){percs[0]='0%';}if(percs[lastIndex]===false){percs[lastIndex]='100%';}percs=backFillColorStops(percs);$.each(percs,function(i){newColorList[i]={color:colors[i],stop:percs[i]};});return newColorList;}function backFillColorStops(stops){var first=0,last=stops.length-1,i=0,foundFirst=false,incr,steps,step,firstVal;if(stops.length<=2||$.inArray(false,stops)<0){return stops;}while(i<stops.length-1){if(!foundFirst&&stops[i]===false){first=i-1;foundFirst=true;}else if(foundFirst&&stops[i]!==false){last=i;i=stops.length;}i++;}steps=last-first;firstVal=parseInt(stops[first].replace('%'),10);incr=(parseFloat(stops[last].replace('%'))-firstVal)/steps;i=first+1;step=1;while(i<last){stops[i]=(firstVal+(step*incr))+'%';step++;i++;}return backFillColorStops(stops);}$.fn.gradient=function(){var args=arguments;return this.each(function(){if(nonGradientIE){stupidIEGradient.apply(this,args);}else{$(this).css('backgroundImage',createGradient.apply(this,args));}});};$.fn.raninbowGradient=function(origin,args){var opts,template,i,steps;origin=origin||'top';opts=$.extend({},{s:100,l:50},args);template='hsl(%h%,'+opts.s+'%,'+opts.l+'%)';i=0;steps=[];while(i<=360){steps.push(template.replace('%h%',i));i+=30;}return this.each(function(){$(this).gradient(origin,steps);});};Iris={options:{color:false,mode:'hsl',controls:{horiz:'s',vert:'l',strip:'h'},hide:true,border:true,target:false,width:200,palettes:false},_color:'',_palettes:['#000','#fff','#d33','#d93','#ee2','#81d742','#1e73be','#8224e3'],_inited:false,_defaultHSLControls:{horiz:'s',vert:'l',strip:'h'},_defaultHSVControls:{horiz:'h',vert:'v',strip:'s'},_scale:{h:360,s:100,l:100,v:100},_create:function(){var self=this,el=self.element,color=self.options.color||el.val();if(gradientType===false){testGradientType();}if(el.is('input')){if(self.options.target){self.picker=$(_html).appendTo(self.options.target);}else{self.picker=$(_html).insertAfter(el);}self._addInputListeners(el);}else{el.append(_html);self.picker=el.find('.iris-picker');}if(isIE){if(IEVersion===9){self.picker.addClass('iris-ie-9');}else if(IEVersion<=8){self.picker.addClass('iris-ie-lt9');}}else if(UA.indexOf('compatible')<0&&UA.indexOf('khtml')<0&&UA.match(/mozilla/)){self.picker.addClass('iris-mozilla');}if(self.options.palettes){self._addPalettes();}self._color=new Color(color).setHSpace(self.options.mode);self.options.color=self._color.toString();self.controls={square:self.picker.find('.iris-square'),squareDrag:self.picker.find('.iris-square-value'),horiz:self.picker.find('.iris-square-horiz'),vert:self.picker.find('.iris-square-vert'),strip:self.picker.find('.iris-strip'),stripSlider:self.picker.find('.iris-strip .iris-slider-offset')};if(self.options.mode==='hsv'&&self._has('l',self.options.controls)){self.options.controls=self._defaultHSVControls;}else if(self.options.mode==='hsl'&&self._has('v',self.options.controls)){self.options.controls=self._defaultHSLControls;}self.hue=self._color.h();if(self.options.hide){self.picker.hide();}if(self.options.border){self.picker.addClass('iris-border');}self._initControls();self.active='external';self._dimensions();self._change();},_has:function(needle,haystack){var ret=false;$.each(haystack,function(i,v){if(needle===v){ret=true;return false;}});return ret;},_addPalettes:function(){var container=$('<div class="iris-palette-container" />'),palette=$('<a class="iris-palette" tabindex="0" />'),colors=$.isArray(this.options.palettes)?this.options.palettes:this._palettes;if(this.picker.find('.iris-palette-container').length){container=this.picker.find('.iris-palette-container').detach().html('');}$.each(colors,function(index,val){palette.clone().data('color',val).css('backgroundColor',val).appendTo(container).height(10).width(10);});this.picker.append(container);},_paint:function(){var self=this;self._paintDimension('top','strip');self._paintDimension('top','vert');self._paintDimension('left','horiz');},_paintDimension:function(origin,control){var self=this,c=self._color,mode=self.options.mode,color=self._getHSpaceColor(),target=self.controls[control],controlOpts=self.options.controls,stops;if(control===self.active||(self.active==='square'&&control!=='strip')){return;}switch(controlOpts[control]){case'h':if(mode==='hsv'){color=c.clone();switch(control){case'horiz':color[controlOpts.vert](100);break;case'vert':color[controlOpts.horiz](100);break;case'strip':color.setHSpace('hsl');break;}stops=color.toHsl();}else{if(control==='strip'){stops={s:color.s,l:color.l};}else{stops={s:100,l:color.l};}}target.raninbowGradient(origin,stops);break;case's':if(mode==='hsv'){if(control==='vert'){stops=[c.clone().a(0).s(0).toCSS('rgba'),c.clone().a(1).s(0).toCSS('rgba')];}else if(control==='strip'){stops=[c.clone().s(100).toCSS('hsl'),c.clone().s(0).toCSS('hsl')];}else if(control==='horiz'){stops=['#fff','hsl('+color.h+',100%,50%)'];}}else{if(control==='vert'&&self.options.controls.horiz==='h'){stops=['hsla(0, 0%, '+color.l+'%, 0)','hsla(0, 0%, '+color.l+'%, 1)'];}else{stops=['hsl('+color.h+',0%,50%)','hsl('+color.h+',100%,50%)'];}}target.gradient(origin,stops);break;case'l':if(control==='strip'){stops=['hsl('+color.h+',100%,100%)','hsl('+color.h+', '+color.s+'%,50%)','hsl('+color.h+',100%,0%)'];}else{stops=['#fff','rgba(255,255,255,0) 50%','rgba(0,0,0,0) 50%','rgba(0,0,0,1)'];}target.gradient(origin,stops);break;case'v':if(control==='strip'){stops=[c.clone().v(100).toCSS(),c.clone().v(0).toCSS()];}else{stops=['rgba(0,0,0,0)','#000'];}target.gradient(origin,stops);break;default:break;}},_getHSpaceColor:function(){return(this.options.mode==='hsv')?this._color.toHsv():this._color.toHsl();},_dimensions:function(reset){var self=this,opts=self.options,controls=self.controls,square=controls.square,strip=self.picker.find('.iris-strip'),squareWidth='77.5%',stripWidth='12%',totalPadding=20,innerWidth=opts.border?opts.width-totalPadding:opts.width,controlsHeight,paletteCount=$.isArray(opts.palettes)?opts.palettes.length:self._palettes.length,paletteMargin,paletteWidth,paletteContainerWidth;if(reset){square.css('width','');strip.css('width','');self.picker.css({width:'',height:''});}squareWidth=innerWidth*(parseFloat(squareWidth)/100);stripWidth=innerWidth*(parseFloat(stripWidth)/100);controlsHeight=opts.border?squareWidth+totalPadding:squareWidth;square.width(squareWidth).height(squareWidth);strip.height(squareWidth).width(stripWidth);self.picker.css({width:opts.width,height:controlsHeight});if(!opts.palettes){return self.picker.css('paddingBottom','');}paletteMargin=squareWidth*2/100;paletteContainerWidth=squareWidth-((paletteCount-1)*paletteMargin);paletteWidth=paletteContainerWidth/paletteCount;self.picker.find('.iris-palette').each(function(i){var margin=i===0?0:paletteMargin;$(this).css({width:paletteWidth,height:paletteWidth,marginLeft:margin});});self.picker.css('paddingBottom',paletteWidth+paletteMargin);strip.height(paletteWidth+paletteMargin+squareWidth);},_addInputListeners:function(input){var self=this,debounceTimeout=100,callback=function(event){var color=new Color(input.val()),val=input.val().replace(/^#/,'');input.removeClass('iris-error');if(color.error){if(val!==''){input.addClass('iris-error');}}else{if(color.toString()!==self._color.toString()){if(!(event.type==='keyup'&&val.match(/^[0-9a-fA-F]{3}$/))){self._setOption('color',color.toString());}}}};input.on('change',callback).on('keyup',self._debounce(callback,debounceTimeout));if(self.options.hide){input.one('focus',function(){self.show();});}},_initControls:function(){var self=this,controls=self.controls,square=controls.square,controlOpts=self.options.controls,stripScale=self._scale[controlOpts.strip];controls.stripSlider.slider({orientation:'vertical',max:stripScale,slide:function(event,ui){self.active='strip';if(controlOpts.strip==='h'){ui.value=stripScale-ui.value;}self._color[controlOpts.strip](ui.value);self._change.apply(self,arguments);}});controls.squareDrag.draggable({containment:controls.square.find('.iris-square-inner'),zIndex:1000,cursor:'move',drag:function(event,ui){self._squareDrag(event,ui);},start:function(){square.addClass('iris-dragging');$(this).addClass('ui-state-focus');},stop:function(){square.removeClass('iris-dragging');$(this).removeClass('ui-state-focus');}}).on('mousedown mouseup',function(event){var focusClass='ui-state-focus';event.preventDefault();if(event.type==='mousedown'){self.picker.find('.'+focusClass).removeClass(focusClass).blur();$(this).addClass(focusClass).focus();}else{$(this).removeClass(focusClass);}}).on('keydown',function(event){var container=controls.square,draggable=controls.squareDrag,position=draggable.position(),distance=self.options.width/100;if(event.altKey){distance*=10;}switch(event.keyCode){case 37:position.left-=distance;break;case 38:position.top-=distance;break;case 39:position.left+=distance;break;case 40:position.top+=distance;break;default:return true;}position.left=Math.max(0,Math.min(position.left,container.width()));position.top=Math.max(0,Math.min(position.top,container.height()));draggable.css(position);self._squareDrag(event,{position:position});event.preventDefault();});square.mousedown(function(event){var squareOffset,pos;if(event.which!==1){return;}if(!$(event.target).is('div')){return;}squareOffset=self.controls.square.offset();pos={top:event.pageY-squareOffset.top,left:event.pageX-squareOffset.left};event.preventDefault();self._squareDrag(event,{position:pos});event.target=self.controls.squareDrag.get(0);self.controls.squareDrag.css(pos).trigger(event);});if(self.options.palettes){self._paletteListeners();}},_paletteListeners:function(){var self=this;self.picker.find('.iris-palette-container').on('click.palette','.iris-palette',function(){self._color.fromCSS($(this).data('color'));self.active='external';self._change();}).on('keydown.palette','.iris-palette',function(event){if(!(event.keyCode===13||event.keyCode===32)){return true;}event.stopPropagation();$(this).click();});},_squareDrag:function(event,ui){var self=this,controlOpts=self.options.controls,dimensions=self._squareDimensions(),vertVal=Math.round((dimensions.h-ui.position.top)/dimensions.h*self._scale[controlOpts.vert]),horizVal=self._scale[controlOpts.horiz]-Math.round((dimensions.w-ui.position.left)/dimensions.w*self._scale[controlOpts.horiz]);self._color[controlOpts.horiz](horizVal)[controlOpts.vert](vertVal);self.active='square';self._change.apply(self,arguments);},_setOption:function(key,value){var self=this,oldValue=self.options[key],doDimensions=false,hexLessColor,newColor,method;self.options[key]=value;switch(key){case'color':value=''+value;hexLessColor=value.replace(/^#/,'');newColor=new Color(value).setHSpace(self.options.mode);if(newColor.error){self.options[key]=oldValue;}else{self._color=newColor;self.options.color=self.options[key]=self._color.toString();self.active='external';self._change();}break;case'palettes':doDimensions=true;if(value){self._addPalettes();}else{self.picker.find('.iris-palette-container').remove();}if(!oldValue){self._paletteListeners();}break;case'width':doDimensions=true;break;case'border':doDimensions=true;method=value?'addClass':'removeClass';self.picker[method]('iris-border');break;case'mode':case'controls':if(oldValue===value){return;}method=self.element;oldValue=self.options;oldValue.hide=!self.picker.is(':visible');self.destroy();self.picker.remove();return $(self.element).iris(oldValue);}if(doDimensions){self._dimensions(true);}},_squareDimensions:function(forceRefresh){var square=this.controls.square,dimensions,control;if(forceRefresh!==undef&&square.data('dimensions')){return square.data('dimensions');}control=this.controls.squareDrag;dimensions={w:square.width(),h:square.height()};square.data('dimensions',dimensions);return dimensions;},_isNonHueControl:function(active,type){if(active==='square'&&this.options.controls.strip==='h'){return true;}else if(type==='external'||(type==='h'&&active==='strip')){return false;}return true;},_change:function(){var self=this,controls=self.controls,color=self._getHSpaceColor(),actions=['square','strip'],controlOpts=self.options.controls,type=controlOpts[self.active]||'external',oldHue=self.hue;if(self.active==='strip'){actions=[];}else if(self.active!=='external'){actions.pop();}$.each(actions,function(index,item){var value,dimensions,cssObj;if(item!==self.active){switch(item){case'strip':value=(controlOpts.strip==='h')?self._scale[controlOpts.strip]-color[controlOpts.strip]:color[controlOpts.strip];controls.stripSlider.slider('value',value);break;case'square':dimensions=self._squareDimensions();cssObj={left:color[controlOpts.horiz]/self._scale[controlOpts.horiz]*dimensions.w,top:dimensions.h-(color[controlOpts.vert]/self._scale[controlOpts.vert]*dimensions.h)};self.controls.squareDrag.css(cssObj);break;}}});if(color.h!==oldHue&&self._isNonHueControl(self.active,type)){self._color.h(oldHue);}self.hue=self._color.h();self.options.color=self._color.toString();if(self._inited){self._trigger('change',{type:self.active},{color:self._color});}if(self.element.is(':input')&&!self._color.error){self.element.removeClass('iris-error');if(self.element.val()!==self._color.toString()){self.element.val(self._color.toString());}}self._paint();self._inited=true;self.active=false;},_debounce:function(func,wait,immediate){var timeout,result;return function(){var context=this,args=arguments,later,callNow;later=function(){timeout=null;if(!immediate){result=func.apply(context,args);}};callNow=immediate&&!timeout;clearTimeout(timeout);timeout=setTimeout(later,wait);if(callNow){result=func.apply(context,args);}return result;};},show:function(){this.picker.show();},hide:function(){this.picker.hide();},toggle:function(){this.picker.toggle();},color:function(newColor){if(newColor===true){return this._color.clone();}else if(newColor===undef){return this._color.toString();}this.option('color',newColor);}};$.widget('a8c.iris',Iris);$('<style id="iris-css">'+_css+'</style>').appendTo('head');}(jQuery));(function(global,undef){var Color=function(color,type){if(!(this instanceof Color))return new Color(color,type);return this._init(color,type);};Color.fn=Color.prototype={_color:0,_alpha:1,error:false,_hsl:{h:0,s:0,l:0},_hsv:{h:0,s:0,v:0},_hSpace:'hsl',_init:function(color){var func='noop';switch(typeof color){case'object':if(color.a!==undef)this.a(color.a);func=(color.r!==undef)?'fromRgb':(color.l!==undef)?'fromHsl':(color.v!==undef)?'fromHsv':func;return this[func](color);case'string':return this.fromCSS(color);case'number':return this.fromInt(parseInt(color,10));}return this;},_error:function(){this.error=true;return this;},clone:function(){var newColor=new Color(this.toInt()),copy=['_alpha','_hSpace','_hsl','_hsv','error'];for(var i=copy.length-1;i>=0;i--){newColor[copy[i]]=this[copy[i]];}return newColor;},setHSpace:function(space){this._hSpace=(space==='hsv')?space:'hsl';return this;},noop:function(){return this;},fromCSS:function(color){var list,leadingRE=/^(rgb|hs(l|v))a?\(/;this.error=false;color=color.replace(/^\s+/,'').replace(/\s+$/,'').replace(/;$/,'');if(color.match(leadingRE)&&color.match(/\)$/)){list=color.replace(/(\s|%)/g,'').replace(leadingRE,'').replace(/,?\);?$/,'').split(',');if(list.length<3)return this._error();if(list.length===4){this.a(parseFloat(list.pop()));if(this.error)return this;}for(var i=list.length-1;i>=0;i--){list[i]=parseInt(list[i],10);if(isNaN(list[i]))return this._error();}if(color.match(/^rgb/)){return this.fromRgb({r:list[0],g:list[1],b:list[2]});}else if(color.match(/^hsv/)){return this.fromHsv({h:list[0],s:list[1],v:list[2]});}else{return this.fromHsl({h:list[0],s:list[1],l:list[2]});}}else{return this.fromHex(color);}},fromRgb:function(rgb,preserve){if(typeof rgb!=='object'||rgb.r===undef||rgb.g===undef||rgb.b===undef)return this._error();this.error=false;return this.fromInt(parseInt((rgb.r<<16)+(rgb.g<<8)+rgb.b,10),preserve);},fromHex:function(color){color=color.replace(/^#/,'').replace(/^0x/,'');if(color.length===3){color=color[0]+color[0]+color[1]+color[1]+color[2]+color[2];}this.error=!/^[0-9A-F]{6}$/i.test(color);return this.fromInt(parseInt(color,16));},fromHsl:function(hsl){var r,g,b,q,p,h,s,l;if(typeof hsl!=='object'||hsl.h===undef||hsl.s===undef||hsl.l===undef)return this._error();this._hsl=hsl;this._hSpace='hsl';h=hsl.h/360;s=hsl.s/100;l=hsl.l/100;if(s===0){r=g=b=l;}else{q=l<0.5?l*(1+s):l+s-l*s;p=2*l-q;r=this.hue2rgb(p,q,h+1/3);g=this.hue2rgb(p,q,h);b=this.hue2rgb(p,q,h-1/3);}return this.fromRgb({r:r*255,g:g*255,b:b*255},true);},fromHsv:function(hsv){var h,s,v,r,g,b,i,f,p,q,t;if(typeof hsv!=='object'||hsv.h===undef||hsv.s===undef||hsv.v===undef)return this._error();this._hsv=hsv;this._hSpace='hsv';h=hsv.h/360;s=hsv.s/100;v=hsv.v/100;i=Math.floor(h*6);f=h*6-i;p=v*(1-s);q=v*(1-f*s);t=v*(1-(1-f)*s);switch(i%6){case 0:r=v;g=t;b=p;break;case 1:r=q;g=v;b=p;break;case 2:r=p;g=v;b=t;break;case 3:r=p;g=q;b=v;break;case 4:r=t;g=p;b=v;break;case 5:r=v;g=p;b=q;break;}return this.fromRgb({r:r*255,g:g*255,b:b*255},true);},fromInt:function(color,preserve){this._color=parseInt(color,10);if(isNaN(this._color))this._color=0;if(this._color>16777215)this._color=16777215;else if(this._color<0)this._color=0;if(preserve===undef){this._hsv.h=this._hsv.s=this._hsl.h=this._hsl.s=0;}return this;},hue2rgb:function(p,q,t){if(t<0){t+=1;}if(t>1){t-=1;}if(t<1/6){return p+(q-p)*6*t;}if(t<1/2){return q;}if(t<2/3){return p+(q-p)*(2/3-t)*6;}return p;},toString:function(){var hex=parseInt(this._color,10).toString(16);if(this.error)return'';if(hex.length<6){for(var i=6-hex.length-1;i>=0;i--){hex='0'+hex;}}return'#'+hex;},toCSS:function(type,alpha){type=type||'hex';alpha=parseFloat(alpha||this._alpha);switch(type){case'rgb':case'rgba':var rgb=this.toRgb();if(alpha<1){return"rgba( "+rgb.r+", "+rgb.g+", "+rgb.b+", "+alpha+" )";}else{return"rgb( "+rgb.r+", "+rgb.g+", "+rgb.b+" )";}break;case'hsl':case'hsla':var hsl=this.toHsl();if(alpha<1){return"hsla( "+hsl.h+", "+hsl.s+"%, "+hsl.l+"%, "+alpha+" )";}else{return"hsl( "+hsl.h+", "+hsl.s+"%, "+hsl.l+"% )";}break;default:return this.toString();}},toRgb:function(){return{r:255&(this._color>>16),g:255&(this._color>>8),b:255&(this._color)};},toHsl:function(){var rgb=this.toRgb();var r=rgb.r/255,g=rgb.g/255,b=rgb.b/255;var max=Math.max(r,g,b),min=Math.min(r,g,b);var h,s,l=(max+min)/2;if(max===min){h=s=0;}else{var d=max-min;s=l>0.5?d/(2-max-min):d/(max+min);switch(max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4;break;}h/=6;}h=Math.round(h*360);if(h===0&&this._hsl.h!==h){h=this._hsl.h;}s=Math.round(s*100);if(s===0&&this._hsl.s){s=this._hsl.s;}return{h:h,s:s,l:Math.round(l*100)};},toHsv:function(){var rgb=this.toRgb();var r=rgb.r/255,g=rgb.g/255,b=rgb.b/255;var max=Math.max(r,g,b),min=Math.min(r,g,b);var h,s,v=max;var d=max-min;s=max===0?0:d/max;if(max===min){h=s=0;}else{switch(max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4;break;}h/=6;}h=Math.round(h*360);if(h===0&&this._hsv.h!==h){h=this._hsv.h;}s=Math.round(s*100);if(s===0&&this._hsv.s){s=this._hsv.s;}return{h:h,s:s,v:Math.round(v*100)};},toInt:function(){return this._color;},toIEOctoHex:function(){var hex=this.toString();var AA=parseInt(255*this._alpha,10).toString(16);if(AA.length===1){AA='0'+AA;}return'#'+AA+hex.replace(/^#/,'');},toLuminosity:function(){var rgb=this.toRgb();return 0.2126*Math.pow(rgb.r/255,2.2)+0.7152*Math.pow(rgb.g/255,2.2)+0.0722*Math.pow(rgb.b/255,2.2);},getDistanceLuminosityFrom:function(color){if(!(color instanceof Color)){throw'getDistanceLuminosityFrom requires a Color object';}var lum1=this.toLuminosity();var lum2=color.toLuminosity();if(lum1>lum2){return(lum1+0.05)/(lum2+0.05);}else{return(lum2+0.05)/(lum1+0.05);}},getMaxContrastColor:function(){var lum=this.toLuminosity();var hex=(lum>=0.5)?'000000':'ffffff';return new Color(hex);},getReadableContrastingColor:function(bgColor,minContrast){if(!bgColor instanceof Color){return this;}var targetContrast=(minContrast===undef)?5:minContrast;var contrast=bgColor.getDistanceLuminosityFrom(this);var maxContrastColor=bgColor.getMaxContrastColor();var maxContrast=maxContrastColor.getDistanceLuminosityFrom(bgColor);if(maxContrast<=targetContrast){return maxContrastColor;}else if(contrast>=targetContrast){return this;}var incr=(0===maxContrastColor.toInt())?-1:1;while(contrast<targetContrast){this.l(incr,true);contrast=this.getDistanceLuminosityFrom(bgColor);if(this._color===0||this._color===16777215){break;}}return this;},a:function(val){if(val===undef)return this._alpha;var a=parseFloat(val);if(isNaN(a))return this._error();this._alpha=a;return this;},darken:function(amount){amount=amount||5;return this.l(-amount,true);},lighten:function(amount){amount=amount||5;return this.l(amount,true);},saturate:function(amount){amount=amount||15;return this.s(amount,true);},desaturate:function(amount){amount=amount||15;return this.s(-amount,true);},toGrayscale:function(){return this.setHSpace('hsl').s(0);},getComplement:function(){return this.h(180,true);},getSplitComplement:function(step){step=step||1;var incr=180+(step*30);return this.h(incr,true);},getAnalog:function(step){step=step||1;var incr=step*30;return this.h(incr,true);},getTetrad:function(step){step=step||1;var incr=step*60;return this.h(incr,true);},getTriad:function(step){step=step||1;var incr=step*120;return this.h(incr,true);},_partial:function(key){var prop=shortProps[key];return function(val,incr){var color=this._spaceFunc('to',prop.space);if(val===undef)return color[key];if(incr===true)val=color[key]+val;if(prop.mod)val=val%prop.mod;if(prop.range)val=(val<prop.range[0])?prop.range[0]:(val>prop.range[1])?prop.range[1]:val;color[key]=val;return this._spaceFunc('from',prop.space,color);};},_spaceFunc:function(dir,s,val){var space=s||this._hSpace,funcName=dir+space.charAt(0).toUpperCase()+space.substr(1);return this[funcName](val);}};var shortProps={h:{mod:360},s:{range:[0,100]},l:{space:'hsl',range:[0,100]},v:{space:'hsv',range:[0,100]},r:{space:'rgb',range:[0,255]},g:{space:'rgb',range:[0,255]},b:{space:'rgb',range:[0,255]}};for(var key in shortProps){if(shortProps.hasOwnProperty(key))Color.fn[key]=Color.fn._partial(key);}if(typeof exports==='object')module.exports=Color;else global.Color=Color;}(this));jQuery(function(){function applyPreview(target){var $style=target.jQuery('link[rel=stylesheet][href*="lib/exe/css.php"]');$style.attr('href','');var $loader=target.jQuery('#plugin__styling_loader');if(!$loader.length){$loader=target.jQuery('<div id="plugin__styling_loader">'+LANG.plugins.styling.loader+'</div>');$loader.css({'position':'absolute','width':'100%','height':'100%','top':0,'left':0,'z-index':5000,'background-color':'#fff','opacity':'0.7','color':'#000','font-size':'2.5em','text-align':'center','line-height':1.5,'padding-top':'2em'});target.jQuery('body').append($loader);}setTimeout(function(){var now=new Date().getTime();$style.attr('href',DOKU_BASE+'lib/exe/css.php?preview=1&tseed='+now);},500);}var doreload=1;var $styling_plugin=jQuery('#plugin__styling');if(!$styling_plugin.length){if(DokuCookie.getValue('styling_plugin')==1){applyPreview(window);}return;}$styling_plugin.find('.color').iris({});if(!$styling_plugin.hasClass('ispopup')){var $form=$styling_plugin.find('form.styling').first();var $btn=jQuery('<button>'+LANG.plugins.styling.popup+'</button>');$form.prepend($btn);$btn.click(function(e){var windowFeatures="menubar=no,location=no,resizable=yes,scrollbars=yes,status=false,width=500,height=500";window.open(DOKU_BASE+'lib/plugins/styling/popup.php','styling_popup',windowFeatures);e.preventDefault();e.stopPropagation();}).wrap('<p></p>');return;}window.onunload=function(e){if(doreload){window.opener.DokuCookie.setValue('styling_plugin',0);window.opener.document.location.reload();}return null;};jQuery(':button').click(function(e){doreload=false;});applyPreview(window.opener);window.opener.DokuCookie.setValue('styling_plugin',1);});(function($){"use strict";var TextInput=function(div,options){this.$div=$(div);this.options=options;this.init();};TextInput.prototype={init:function(){this.$input=$('<input type="text">').val(this.options.defaultValue).appendTo(this.$div);this.renderClear();},activate:function(){if(this.$input.is(':visible')){this.$input.focus();var pos=this.$input.val().length;this.$input.get(0).setSelectionRange(pos,pos);this.toggleClear();}},renderClear:function(){this.$clear=$('<span class="editable-clear-x"></span>');this.$input.after(this.$clear).css('padding-right',24).keyup($.proxy(function(e){if(~$.inArray(e.keyCode,[40,38,9,13,27])){return;}clearTimeout(this.t);var that=this;this.t=setTimeout(function(){that.toggleClear(e);},100);},this)).parent().css('position','relative');this.$clear.click($.proxy(this.clear,this));},toggleClear:function(){var len=this.$input.val().length,visible=this.$clear.is(':visible');if(len&&!visible){this.$clear.show();}if(!len&&visible){this.$clear.hide();}},clear:function(){this.$clear.hide();this.$input.val('').focus();}};var EditableForm=function(div,options){this.$div=$(div);this.options=options;this.init();};EditableForm.prototype={template:'<form class="form-inline editableform">'+'<div class="control-group">'+'<div><div class="editable-input"></div><div class="editable-buttons"></div></div>'+'<div class="editable-error-block"></div>'+'</div>'+'</form>',loading:'<div class="editableform-loading"></div>',buttons:'<button type="submit" class="editable-submit">ok</button>'+'<button type="button" class="editable-cancel">cancel</button>',init:function(){this.$loading=$(this.loading);this.$div.empty().append(this.$loading);this.$form=$(this.template);var $btn=this.$form.find('.editable-buttons');$btn.append(this.buttons);this.$form.find('.editable-submit').button({icons:{primary:"ui-icon-check"},text:false});this.$form.find('.editable-cancel').button({icons:{primary:"ui-icon-closethick"},text:false});this.input=new TextInput(this.$form.find('div.editable-input'),{defaultValue:this.options.value});this.isSaving=false;this.$div.append(this.$form);this.$form.find('.editable-cancel').click($.proxy(this.cancel,this));this.$form.submit($.proxy(this.submit,this));this.showForm();},cancel:function(){this.$div.triggerHandler('cancel');},showLoading:function(){var w,h;w=this.$form.outerWidth();h=this.$form.outerHeight();if(w){this.$loading.width(w);}if(h){this.$loading.height(h);}this.$form.hide();this.$loading.show();},showForm:function(){this.$loading.hide();this.$form.show();this.input.activate();this.$div.triggerHandler('show');},error:function(msg){if(msg===false){this.$form.find('.editable-error-block').removeClass('ui-state-error').empty().hide();}else{this.$form.find('.editable-error-block').addClass('ui-state-error').html(msg).show();}},submit:function(e){e.stopPropagation();e.preventDefault();var newValue=this.input.$input.val();if(newValue===this.options.value){this.$div.triggerHandler('nochange');return;}this.showLoading();this.isSaving=true;var params=$.extend({},this.options.params,{oldValue:this.options.value,newValue:newValue});return $.ajax({url:this.options.url,data:params,type:'POST'}).done($.proxy(function(response){this.isSaving=false;if(response.status==='error'){this.showForm();return;}this.error(false);this.options.value=newValue;if(typeof this.options.success==='function'){this.options.success.call(this.options.scope,response,newValue);}this.$div.triggerHandler('save',{newValue:newValue,response:response});},this)).fail($.proxy(function(xhr){this.isSaving=false;var msg=typeof xhr==='string'?xhr:xhr.responseText||xhr.statusText||'Unknown error';this.error(msg);this.showForm();},this));}};var Editable=function(element,options){this.$element=jQuery(element);this.options=jQuery.extend({},jQuery.fn.editable.defaults,options);this.init();};Editable.prototype={isVisible:function(){return this.$element.hasClass('editable-open');},init:function(){this.value=this.$element.text();this.$element.addClass('editable');if(!this.options.disabled){this.$element.addClass('editable-click');}this.$popup=null;this.$element.on('click.editable',$.proxy(function(e){if(!this.options.disabled){e.preventDefault();}this.toggle();},this));if(!$(document).data('editable-handlers-attached')){$(document).on('keyup.editable',$.proxy(function(e){if(e.keyCode===jQuery.ui.keyCode.ESCAPE){this.closeOthers(null);}},this));$(document).on('click.editable',function(e){var $target=$(e.target);if($target.is('.editable-popup')||$target.parents('.editable-popup').length){return;}Editable.prototype.closeOthers(e.target);});$(document).data('editable-handlers-attached',true);}},closeOthers:function(element){$('.editable-open').each(function(i,el){if(el===element||$(el).find(element).length){return;}$(el).data('editable').hide();});},enable:function(){this.options.disabled=false;this.$element.addClass('editable-click');},disable:function(){this.options.disabled=true;this.hide();this.$element.removeClass('editable-click');},toggleDisabled:function(){if(this.options.disabled){this.enable();}else{this.disable();}},show:function(){if(this.options.disabled){return;}this.$element.addClass('editable-open');this.$popup=$('<div>').addClass('ui-tooltip ui-corner-all ui-widget-shadow ui-widget ui-widget-content editable-popup').css('max-width','none').prependTo('body').hide().fadeIn();this.$popup.append($('<label>').text(this.options.label));this.$form_container=$('<div>');this.$popup.append(this.$form_container);this.$form_container.on({save:$.proxy(function(){this.hide();},this),nochange:$.proxy(function(){this.hide();},this),cancel:$.proxy(function(){this.hide();},this),show:$.proxy(function(){this.$popup.position({of:this.$element,my:'center bottom-5',at:'center top',collision:'flipfit'});},this)});this.form=new EditableForm(this.$form_container,{value:this.value,url:this.options.url,success:this.options.success,scope:this.options.scope,params:this.options.params});},hide:function(){if(!this.isVisible()){return;}if(this.form.isSaving){return;}this.$popup.fadeOut({complete:$.proxy(function(){this.$popup.remove();this.$popup=null;this.$element.removeClass('editable-open');},this)});},toggle:function(){if(this.isVisible()){this.hide();}else{this.show();}}};$.fn.editable=function(option){var datakey='editable';return this.each(function(){var $this=$(this),data=$this.data(datakey),options=typeof option==='object'&&option;if(!data){$this.data(datakey,(data=new Editable(this,options)));}if(typeof option==='string'){data[option].apply(data,Array.prototype.slice.call(arguments,1));}});};$.fn.editable.defaults={disabled:false,label:'Enter value',success:null,scope:null,params:{}};}(window.jQuery));jQuery(function(){jQuery('#tagging__del').click(function(){return confirm(LANG.del_confirm);});var $form=jQuery('#tagging__edit');if(!$form.length)return;var $btn=jQuery('form.btn_tagging_edit');var $btns=jQuery('#tagging__edit_buttons_group');$btn.submit(function(e){$btns.hide();$form.show();var $input=$form.find('textarea');var len=$input.val().length;$input.focus();try{$input[0].setSelectionRange(len,len);}catch(ex){}e.preventDefault();e.stopPropagation();return false;});var $admin_toggle_btn=jQuery('#tagging__edit_toggle_admin').checkboxradio().click(function(){jQuery('div.plugin_tagging_edit ul.tagging_cloud a').editable('toggleDisabled');}),add_editable=function(){if($admin_toggle_btn.length===0)return;jQuery('div.plugin_tagging_edit ul.tagging_cloud a').editable({disabled:!$admin_toggle_btn[0].checked,label:LANG.plugins.tagging.admin_change_tag,url:DOKU_BASE+'lib/exe/ajax.php?call=plugin_tagging_admin_change',params:{'call':'plugin_tagging_admin_change','id':JSINFO.id,'sectok':JSINFO.sectok},success:function(response){jQuery('div.plugin_tagging_edit ul.tagging_cloud').html(response.html_cloud);$form.find('textarea').val(response.tags_edit_value);add_editable();}});};add_editable();jQuery('#tagging__edit_save').click(function(e){jQuery('div.plugin_tagging_edit ul.tagging_cloud').load(DOKU_BASE+'lib/exe/ajax.php',$form.serialize(),add_editable);$btns.show();$form.hide();e.preventDefault();e.stopPropagation();return false;});jQuery('#tagging__edit_cancel').click(function(e){$btns.show();$form.hide();e.preventDefault();e.stopPropagation();return false;});jQuery('.btn_tagging_edit button, #tagging__edit_save, #tagging__edit_cancel').button();function split(val){return val.split(/,\s*/);}function extractLast(term){return split(term).pop();}$form.find('textarea').bind('keydown',function(event){if(event.keyCode===jQuery.ui.keyCode.TAB&&jQuery(this).data('ui-autocomplete').menu.active){event.preventDefault();}}).autocomplete({source:function(request,response){jQuery.getJSON(DOKU_BASE+'lib/exe/ajax.php?call=plugin_tagging_autocomplete',{term:extractLast(request.term)},response);},search:function(){var term=extractLast(this.value);if(term.length<2){return false;}return true;},focus:function(){return false;},select:function(event,ui){var terms=split(this.value);terms.pop();terms.push(ui.item.value);terms.push('');this.value=terms.join(', ');return false;}});});jQuery(function(){var $frm=jQuery('#translation__dropdown');if(!$frm.length)return;$frm.find('input[name=go]').hide();$frm.find('select[name=id]').change(function(){var id=jQuery(this).val();var action=$frm.attr('action');if(action.substr(action.length-1)=='/'){var link=action+id;}else{var link=action+'?id='+id;}window.location.href=link;});});jQuery(function(){jQuery('#usrmgr__del').click(function(){return confirm(LANG.del_confirm);});});if(window.toolbar!=undefined){toolbar[toolbar.length]={"type":"pluginvshare","title":LANG['plugins']['vshare']['button'],"icon":"../../plugins/vshare/button.png","key":""};}function tb_pluginvshare(btn,props,edid){PluginVShare.edid=edid;PluginVShare.buildSyntax();}var PluginVShare={edid:null,buildSyntax:function(){var text=prompt(LANG['plugins']['vshare']['prompt']);if(!text)return;var sites={'youtube':'youtube\\.com/.*[&?]v=([a-z0-9_\\-]+)','vimeo':'vimeo\\.com\\/(\\d+)','ustream':'ustream\\.tv\\/recorded\\/(\\d+)\\/','5min':'5min\\.com\\/Video/.*-([0-9]+)([&?]|$)','clipfish':'clipfishi\\.de\\/.*\\/video\\/([0-9])+\\/','dailymotion':'dailymotion\\.com\\/video\\/([a-z0-9]+)_','gtrailers':'gametrailers\\.com\\/.*\\/(\\d+)','metacafe':'metacafe\\.com\\/watch\\/(\\d+)\\/','myspacetv':'vids\\.myspace\\.com\\/.*videoid=(\\d+)','rcmovie':'rcmovie\\.de\\/video\\/([a-f0-9]+)\\/','scivee':'scivee\\.tv\\/node\\/(\\d+)','twitchtv':'twitch\\.tv\\/([a-z0-9_\\-]+)(?:\\/c\\/(\\d+))?','veoh':'veoh\\.com\\/.*watch[^v]*(v[a-z0-9]+)','bambuser':'bambuser\\.com\\/v\\/(\\d+)','bliptv':'(?:blip\\.tv\\/play\\/([a-zA-Z0-9]+\\.(?:html|x))\\?p=1|(http?\\:\\/\\/blip\\.tv\\/(?!play)(?:[a-zA-Z0-9_\\-]+)\\/(?:[a-zA-Z0-9_\\-]+)))','break':'break\\.com\\/video\\/(?:(?:[a-z]+)\\/)?(?:[a-z\\-]+)-([0-9]+)','viddler':'viddler\\.com\\/(?:embed|v)\\/([a-z0-9]{8})','msoffice':'(?:office\\.com.*[&?]videoid=([a-z0-9\\-]+))','slideshare':'(?:(?:slideshare\\.net\\/slideshow\\/embed_code\\/|id=)([0-9]+)|(https?\\:\\/\\/www\\.slideshare\\.net\\/(?:[a-zA-Z0-9_\\-]+)\\/(?:[a-zA-Z0-9_\\-]+)))','archiveorg':'archive\\.org\\/embed\\/([a-zA-Z0-9_\\-]+)','niconico':'nicovideo\\.jp/watch/(sm[0-9]+)','youku':'v\\.youku\\.com/v_show/id_([[0-9A-Za-z]]+)\\.html','tudou':'tudou\\.com/programs/view/([0-9A-Za-z]+)','bilibili':'bilibili\\.com/video/av([0-9])+/'};for(var key in sites){if(sites.hasOwnProperty(key)){var RE=new RegExp(sites[key],'i');var match=text.match(RE);if(match){var urlparam='';var videoid=match[1];switch(key){case'slideshare':if(match[2]){jQuery.ajax({url:'//www.slideshare.net/api/oembed/2',dataType:'jsonp',data:{url:match[2],format:'jsonp'}}).done(function(response,status,error){var videoid=response.slideshow_id;PluginVShare.insert(key,videoid,urlparam);}).fail(function(data,status,error){alert(LANG['plugins']['vshare']['notfound']);});return;}break;case'bliptv':if(match[2]){jQuery.ajax({url:'//blip.tv/oembed/',dataType:'jsonp',data:{url:match[2],format:'json'},timeout:2000}).done(function(response,status,error){var videoidmatch=response.html.match(RE);PluginVShare.insert(key,videoidmatch[1],urlparam);}).fail(function(data,status,error){alert(LANG['plugins']['vshare']['notfound']);});return;}break;case'twitchtv':if(match[2]){urlparam='&chapter_id='+match[2];}break;}PluginVShare.insert(key,videoid,urlparam);return;}}}alert(LANG['plugins']['vshare']['notfound']);},insert:function(key,videoid,urlparam,edid){var code='{{'+key+'>'+videoid+'?medium'+urlparam+'}}';insertAtCarret(PluginVShare.edid,code);}};jQuery(function(){dw_locktimer.init(840,1);});
